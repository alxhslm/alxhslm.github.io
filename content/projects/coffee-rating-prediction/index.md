+++
title = 'Coffee Rating Prediction'
date = 2023-11-21T20:12:00Z
showTableOfContents = true
+++

This was my first personal ML project. The goal was to familiarise myself with [XGBoost](https://xgboost.readthedocs.io/en/stable/) and [AWS Lambda](https://aws.amazon.com/lambda/). I enjoy drinking nice coffee, so I chose a topic which I hoped would help me buy better coffee in the future. The source code is available on GitHub.

{{< github repo="alxhslm/coffee-rating-prediction" >}}

## Objective
The objective of this project is to be able to predict how highly rated a coffee would be on [CoffeeReview.com](http://CoffeeReview.com) based purely on information about the coffee such as:
- Origin
- Roaster and roasting style
- Price
- Flavour profile


## Exploratory data analysis
We begin by loading in the data from the dataset from [Kaggle](https://www.kaggle.com/datasets/schmoyote/coffee-reviews-dataset/data). I also renamed the columns to more clearly distinguish between the country of origin and roaster country.

```python
import pandas as pd

df = pd.read_csv("./data/simplified_coffee.csv")
for col in ["name", "roaster", "roast", "loc_country", "origin", "review"]:
    df[col] = df[col].astype("string")

df["review_date"] = pd.to_datetime(df["review_date"])
df = df.rename(columns={"loc_country": "roaster_country", "100g_USD": "price_per_100g", "origin": "country_of_origin"})
df.head()
```

Let us first check for NaNs.


```python
df.isna().sum()
```

|   name              |    0 |
|---------------------|------|
|   roaster           |    0 |
|   roast             |   12 |
|   roaster_country   |    0 |
|   country_of_origin |    0 |
|   price_per_100g    |    0 |
|   rating            |    0 |
|   review_date       |    0 |
|   review            |    0 |



The only column with NaNs is the roast. Since there are only 12 missing values, we could just remove these rows. However, since most coffees have the same roast type (as will see later), let us fill with the modal value.


```python
df["roast"] = df["roast"].fillna(df["roast"].mode().iloc[0])
```

Let's fix a typo in the roaster country for one coffee.


```python
df["roaster_country"] = df["roaster_country"].str.replace("New Taiwan", "Taiwan")
```

Some roasters were being duplicated due to the presence of the characters below, so let us replace them with the English equivalent for consistency:

```python
replace = {"’s": "'s", "é": "e", "’": "'"}
for k, v in replace.items():
    df["roaster"] = df["roaster"].str.replace(k, v)
```


### Ratings
We can see that the ratings are approximately normally distribution. However, the median rating is surprisingly high at ~94%.


```python
df["rating"].hist(labels={"value":"rating [%]"})
```

<div>                        <script type="text/javascript">window.PlotlyConfig = {MathJaxConfig: 'local'};</script>
        <script charset="utf-8" src="https://cdn.plot.ly/plotly-2.24.1.min.js"></script>                <div id="e4223b1e-6590-4f33-b308-6218636b6bed" class="plotly-graph-div" style="height:100%; width:100%;"></div>            <script type="text/javascript">                                    window.PLOTLYENV=window.PLOTLYENV || {};                                    if (document.getElementById("e4223b1e-6590-4f33-b308-6218636b6bed")) {                    Plotly.newPlot(                        "e4223b1e-6590-4f33-b308-6218636b6bed",                        [{"alignmentgroup":"True","bingroup":"x","histnorm":"percent","hovertemplate":"variable=rating\u003cbr\u003evalue=%{x}\u003cbr\u003epercent=%{y}\u003cextra\u003e\u003c\u002fextra\u003e","legendgroup":"rating","marker":{"color":"#636efa","pattern":{"shape":""}},"name":"rating","offsetgroup":"rating","orientation":"v","showlegend":true,"x":[92,92,94,93,93,93,93,94,90,92,91,93,97,95,92,95,94,93,93,92,93,92,89,93,95,94,94,96,94,95,95,93,93,93,95,93,92,93,94,92,91,90,95,93,93,90,94,92,95,92,95,92,95,92,92,93,94,93,94,93,93,96,90,91,92,94,93,93,92,95,94,93,93,93,93,95,94,95,94,93,94,92,94,91,92,94,95,95,93,94,94,93,93,93,94,92,92,95,92,92,91,91,91,90,93,93,92,93,92,90,93,92,92,93,94,93,94,94,95,95,95,93,93,92,90,93,91,92,94,92,95,93,94,93,94,92,91,93,92,95,92,94,94,94,93,93,94,93,92,93,93,94,94,95,93,91,94,94,94,96,94,93,93,93,92,92,92,95,94,96,93,90,94,92,91,95,95,96,91,92,92,93,93,90,95,94,95,94,93,93,93,93,95,94,94,94,93,93,93,91,91,90,93,96,93,94,94,93,94,93,92,94,95,94,93,93,92,92,92,92,95,94,94,93,93,95,93,94,93,97,94,94,94,94,94,92,91,92,93,93,93,94,93,93,93,93,92,91,94,94,94,97,93,92,95,94,93,92,90,92,95,93,92,95,95,90,93,93,91,94,94,93,93,93,92,92,91,94,94,93,92,95,94,94,94,93,92,94,96,92,91,97,93,92,93,93,93,93,96,94,94,90,93,93,93,93,93,94,97,95,94,94,92,91,91,93,94,94,93,92,92,94,96,95,94,94,94,94,93,94,93,93,94,93,93,95,94,93,92,92,92,94,94,96,93,93,92,92,93,93,91,96,92,92,95,95,93,93,93,94,93,93,95,93,93,93,92,91,90,93,94,94,94,94,95,93,93,93,93,92,95,94,93,96,95,93,94,92,92,91,90,92,90,90,88,87,95,94,91,93,94,93,92,92,94,92,92,91,90,94,95,93,92,91,90,92,91,95,94,91,90,95,92,96,94,93,93,92,92,94,94,92,94,93,92,94,94,93,91,93,94,93,93,94,93,92,91,96,95,94,94,94,93,94,93,93,93,92,94,93,93,94,93,92,95,92,93,93,92,93,94,94,93,94,94,94,92,92,96,93,94,93,94,94,94,94,95,96,95,93,95,94,93,95,93,92,94,94,90,94,94,93,94,93,95,93,90,93,93,95,94,94,94,93,92,94,93,94,93,94,91,90,95,93,91,96,94,94,93,92,93,93,93,92,93,93,94,94,94,95,93,96,94,94,94,92,93,94,93,92,93,94,94,94,93,95,84,93,94,94,94,94,92,94,94,95,94,94,92,92,91,90,95,95,95,95,94,94,94,94,94,94,94,94,93,92,90,89,86,86,97,94,94,93,92,94,92,95,94,94,93,93,93,94,92,96,94,94,94,95,95,93,94,93,94,93,95,93,93,92,95,92,94,95,91,94,93,97,96,94,93,93,95,94,95,95,93,93,92,92,95,94,93,93,96,95,93,93,92,93,94,93,94,95,94,92,91,93,94,93,93,93,95,94,92,96,95,94,93,93,94,93,93,91,94,90,93,94,93,93,94,93,94,94,94,95,95,95,94,95,93,93,94,94,93,95,95,92,95,95,94,93,93,93,93,94,95,93,95,96,94,94,90,94,92,96,93,93,94,92,92,92,94,94,92,91,94,93,91,92,91,94,94,93,96,94,94,92,92,93,93,92,91,96,95,94,94,94,94,93,91,95,95,94,94,94,95,95,94,95,93,91,92,93,93,92,93,92,92,91,90,90,94,93,93,93,94,95,95,94,94,93,93,93,93,94,95,94,94,91,95,94,94,90,94,93,94,95,94,94,93,93,92,96,95,95,95,94,93,93,93,95,94,93,95,95,94,94,94,94,93,93,94,95,95,94,94,94,93,93,94,93,94,92,90,95,92,92,94,93,94,91,95,97,94,93,94,93,93,93,93,93,92,94,93,91,94,94,94,95,93,93,92,93,92,92,93,93,91,90,90,93,95,94,94,95,95,94,92,93,95,92,93,92,95,94,96,93,93,92,94,93,93,93,92,90,94,94,94,93,96,94,94,94,91,94,94,93,94,93,92,95,95,94,94,93,94,95,94,94,96,95,95,93,94,95,94,94,96,95,95,94,94,90,95,95,93,93,92,91,93,96,96,97,96,94,94,94,93,92,94,92,91,92,90,90,93,92,87,87,88,90,92,88,89,96,93,93,94,93,94,96,94,93,92,94,93,92,95,95,93,94,93,94,92,93,93,95,94,94,92,92,93,91,94,92,94,96,93,95,95,93,92,95,94,94,93,94,93,91,94,92,93,92,94,94,93,93,93,91,95,93,94,94,93,93,96,97,94,94,95,93,92,91,92,92,96,95,94,94,94,94,94,93,95,95,95,95,95,94,94,93,93,92,90,94,94,95,94,94,92,93,92,94,92,96,94,95,93,93,95,94,94,94,93,94,94,93,93,94,93,93,92,94,93,93,94,94,94,93,92,90,92,90,93,93,94,94,96,95,94,95,95,93,93,93,94,94,94,95,95,95,95,95,95,94,93,94,92,95,94,93,93,92,91,93,93,93,93,95,95,94,94,93,94,93,92,94,92,94,92,90,94,94,93,93,93,95,94,93,94,94,92,95,95,94,92,95,92,93,96,93,95,93,95,93,93,95,93,93,93,91,94,95,93,95,93,94,95,94,93,92,94,94,96,95,95,95,94,94,93,93,94,93,93,95,94,94,94,96,94,94,94,95,92,92,93,92,93,93,93,93,93,93,92,95,95,95,92,92,90,93,95,92,93,95,92,91,91,95,93,94,95,94,93,92,92,92,91,94,92,92,93,93,93,94],"xaxis":"x","yaxis":"y","type":"histogram"}],                        {"template":{"data":{"histogram2dcontour":[{"type":"histogram2dcontour","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"choropleth":[{"type":"choropleth","colorbar":{"outlinewidth":0,"ticks":""}}],"histogram2d":[{"type":"histogram2d","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"heatmap":[{"type":"heatmap","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"heatmapgl":[{"type":"heatmapgl","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"contourcarpet":[{"type":"contourcarpet","colorbar":{"outlinewidth":0,"ticks":""}}],"contour":[{"type":"contour","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"surface":[{"type":"surface","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"mesh3d":[{"type":"mesh3d","colorbar":{"outlinewidth":0,"ticks":""}}],"scatter":[{"fillpattern":{"fillmode":"overlay","size":10,"solidity":0.2},"type":"scatter"}],"parcoords":[{"type":"parcoords","line":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scatterpolargl":[{"type":"scatterpolargl","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"bar":[{"error_x":{"color":"#2a3f5f"},"error_y":{"color":"#2a3f5f"},"marker":{"line":{"color":"#E5ECF6","width":0.5},"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"bar"}],"scattergeo":[{"type":"scattergeo","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scatterpolar":[{"type":"scatterpolar","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"histogram":[{"marker":{"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"histogram"}],"scattergl":[{"type":"scattergl","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scatter3d":[{"type":"scatter3d","line":{"colorbar":{"outlinewidth":0,"ticks":""}},"marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scattermapbox":[{"type":"scattermapbox","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scatterternary":[{"type":"scatterternary","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scattercarpet":[{"type":"scattercarpet","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"carpet":[{"aaxis":{"endlinecolor":"#2a3f5f","gridcolor":"white","linecolor":"white","minorgridcolor":"white","startlinecolor":"#2a3f5f"},"baxis":{"endlinecolor":"#2a3f5f","gridcolor":"white","linecolor":"white","minorgridcolor":"white","startlinecolor":"#2a3f5f"},"type":"carpet"}],"table":[{"cells":{"fill":{"color":"#EBF0F8"},"line":{"color":"white"}},"header":{"fill":{"color":"#C8D4E3"},"line":{"color":"white"}},"type":"table"}],"barpolar":[{"marker":{"line":{"color":"#E5ECF6","width":0.5},"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"barpolar"}],"pie":[{"automargin":true,"type":"pie"}]},"layout":{"autotypenumbers":"strict","colorway":["#636efa","#EF553B","#00cc96","#ab63fa","#FFA15A","#19d3f3","#FF6692","#B6E880","#FF97FF","#FECB52"],"font":{"color":"#2a3f5f"},"hovermode":"closest","hoverlabel":{"align":"left"},"paper_bgcolor":"white","plot_bgcolor":"#E5ECF6","polar":{"bgcolor":"#E5ECF6","angularaxis":{"gridcolor":"white","linecolor":"white","ticks":""},"radialaxis":{"gridcolor":"white","linecolor":"white","ticks":""}},"ternary":{"bgcolor":"#E5ECF6","aaxis":{"gridcolor":"white","linecolor":"white","ticks":""},"baxis":{"gridcolor":"white","linecolor":"white","ticks":""},"caxis":{"gridcolor":"white","linecolor":"white","ticks":""}},"coloraxis":{"colorbar":{"outlinewidth":0,"ticks":""}},"colorscale":{"sequential":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"sequentialminus":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"diverging":[[0,"#8e0152"],[0.1,"#c51b7d"],[0.2,"#de77ae"],[0.3,"#f1b6da"],[0.4,"#fde0ef"],[0.5,"#f7f7f7"],[0.6,"#e6f5d0"],[0.7,"#b8e186"],[0.8,"#7fbc41"],[0.9,"#4d9221"],[1,"#276419"]]},"xaxis":{"gridcolor":"white","linecolor":"white","ticks":"","title":{"standoff":15},"zerolinecolor":"white","automargin":true,"zerolinewidth":2},"yaxis":{"gridcolor":"white","linecolor":"white","ticks":"","title":{"standoff":15},"zerolinecolor":"white","automargin":true,"zerolinewidth":2},"scene":{"xaxis":{"backgroundcolor":"#E5ECF6","gridcolor":"white","linecolor":"white","showbackground":true,"ticks":"","zerolinecolor":"white","gridwidth":2},"yaxis":{"backgroundcolor":"#E5ECF6","gridcolor":"white","linecolor":"white","showbackground":true,"ticks":"","zerolinecolor":"white","gridwidth":2},"zaxis":{"backgroundcolor":"#E5ECF6","gridcolor":"white","linecolor":"white","showbackground":true,"ticks":"","zerolinecolor":"white","gridwidth":2}},"shapedefaults":{"line":{"color":"#2a3f5f"}},"annotationdefaults":{"arrowcolor":"#2a3f5f","arrowhead":0,"arrowwidth":1},"geo":{"bgcolor":"white","landcolor":"#E5ECF6","subunitcolor":"white","showland":true,"showlakes":true,"lakecolor":"white"},"title":{"x":0.05},"mapbox":{"style":"light"}}},"xaxis":{"anchor":"y","domain":[0.0,1.0],"title":{"text":"rating [%]"}},"yaxis":{"anchor":"x","domain":[0.0,1.0],"title":{"text":"percent"}},"legend":{"title":{"text":"variable"},"tracegroupgap":0},"margin":{"t":60},"barmode":"relative"},                        {"responsive": true}                    )                };                            </script>        </div>        <script charset="utf-8" src="https://cdn.plot.ly/plotly-2.24.1.min.js"></script>                

### Coffee pricing
The distribution for the price of the coffee has a very long tail, due to a few very expensive coffees. This suggests that there may be benefit in applying the log transformation.


```python
df["price_per_100g"].hist((histnorm='percent', labels={"value":"price per 100g [USD]"})
```

<div>                        <script type="text/javascript">window.PlotlyConfig = {MathJaxConfig: 'local'};</script>
        <script charset="utf-8" src="https://cdn.plot.ly/plotly-2.24.1.min.js"></script>                <div id="4bcf214d-6ae4-4414-bf5e-a2790931616b" class="plotly-graph-div" style="height:100%; width:100%;"></div>            <script type="text/javascript">                                    window.PLOTLYENV=window.PLOTLYENV || {};                                    if (document.getElementById("4bcf214d-6ae4-4414-bf5e-a2790931616b")) {                    Plotly.newPlot(                        "4bcf214d-6ae4-4414-bf5e-a2790931616b",                        [{"alignmentgroup":"True","bingroup":"x","histnorm":"percent","hovertemplate":"variable=price_per_100g\u003cbr\u003evalue=%{x}\u003cbr\u003epercent=%{y}\u003cextra\u003e\u003c\u002fextra\u003e","legendgroup":"price_per_100g","marker":{"color":"#636efa","pattern":{"shape":""}},"name":"price_per_100g","offsetgroup":"price_per_100g","orientation":"v","showlegend":true,"x":[4.7,4.19,4.85,5.14,3.97,5.14,5.29,3.76,5.73,6.87,6.87,5.28,33.05,4.6,5.29,3.89,4.65,5.58,5.86,4.41,5.58,4.98,4.98,7.35,6.47,4.41,8.44,16.17,32.63,19.82,5.86,4.98,13.0,17.7,26.46,17.64,13.23,5.0,5.28,7.35,7.05,4.11,5.51,90.83,90.83,13.0,4.99,5.0,22.49,8.02,23.81,5.58,9.2,7.05,4.56,4.25,4.6,4.85,4.63,4.63,4.98,8.77,8.77,7.35,3.31,4.41,4.12,3.92,4.26,19.82,5.28,4.85,6.15,5.0,5.88,22.49,6.51,16.53,5.51,4.63,12.74,4.93,13.45,5.88,6.61,4.96,33.07,63.93,5.73,5.28,20.26,5.29,12.35,5.0,5.29,6.83,8.88,15.43,4.85,5.66,4.56,5.64,5.29,5.92,5.29,3.19,4.56,8.5,9.16,4.56,4.52,9.24,5.31,4.41,5.58,5.66,3.68,5.29,21.24,6.02,4.98,5.29,5.29,4.1,4.1,6.17,6.03,5.64,3.89,5.36,8.21,5.57,111.11,3.51,5.73,5.88,5.88,6.91,5.29,11.76,11.76,5.29,5.29,3.89,5.29,4.7,5.29,4.7,4.41,5.29,5.0,5.14,6.03,5.51,5.51,4.63,5.73,5.73,5.73,33.07,4.92,3.97,3.51,5.88,6.17,4.7,3.53,9.91,10.62,5.31,4.98,4.76,5.86,3.6,5.29,5.73,33.07,19.84,4.54,5.44,5.14,9.6,8.0,5.0,30.86,19.84,20.53,6.17,5.29,5.57,7.08,11.02,7.94,14.11,19.84,15.87,11.75,11.75,4.98,5.58,4.41,4.98,6.76,19.82,4.7,7.05,5.29,5.14,5.29,5.88,4.7,4.25,4.11,4.25,16.17,5.73,7.35,6.76,6.17,5.66,19.82,6.61,5.44,6.4,5.0,5.58,5.88,4.97,5.28,26.46,6.61,7.61,7.05,5.29,6.47,5.58,4.11,5.29,11.76,5.58,5.29,4.41,7.61,6.91,4.7,13.23,13.23,4.41,5.58,5.29,3.56,5.29,6.8,4.98,4.6,15.58,16.29,5.0,10.58,5.44,5.58,4.76,4.76,4.96,16.53,4.69,8.38,5.86,4.67,17.59,37.04,10.93,28.2,21.6,10.58,14.11,4.7,17.07,8.53,12.35,5.29,9.39,7.33,5.88,5.1,17.64,2.55,43.65,26.46,5.58,4.67,6.23,8.82,4.41,6.17,4.67,3.68,2.83,5.29,6.76,5.58,21.16,2.56,13.23,90.83,4.82,3.19,11.76,6.23,4.96,3.68,3.89,16.7,7.35,9.92,6.34,6.17,4.25,5.58,6.76,5.58,22.71,21.24,26.46,38.4,22.05,5.58,5.03,5.03,3.53,5.5,5.5,4.96,5.88,5.29,17.61,4.6,3.54,3.54,2.83,8.8,8.5,5.73,26.46,5.29,5.29,25.6,19.2,5.88,6.47,5.29,69.0,5.29,4.7,6.45,3.2,5.28,6.16,6.4,5.64,15.58,5.88,9.12,5.86,6.17,8.0,6.17,6.4,4.98,4.8,41.12,4.25,4.25,4.25,6.17,17.59,4.69,5.86,5.29,4.03,8.8,16.0,8.0,17.59,5.81,6.61,32.0,32.0,32.0,8.53,32.0,4.11,4.11,3.32,1.49,3.08,27.76,45.31,6.23,5.58,5.26,5.14,5.29,5.73,5.81,3.53,5.41,13.23,4.76,9.6,4.6,4.41,5.29,5.26,5.26,10.58,3.97,5.88,25.2,17.61,17.61,6.17,5.86,9.7,6.61,5.29,5.0,5.29,5.88,6.76,6.91,8.48,4.85,22.0,6.17,8.52,8.52,5.0,5.88,5.88,4.25,4.25,11.73,7.33,17.59,7.05,10.58,6.17,5.58,0.17,20.55,17.64,5.29,13.23,5.88,5.86,5.58,8.46,12.35,10.58,17.64,6.75,5.58,13.23,9.28,6.37,5.51,14.55,14.55,5.88,6.17,6.17,5.0,16.71,5.88,3.19,5.29,11.33,5.51,5.0,111.11,1.32,1.34,4.27,17.64,7.35,16.75,6.17,6.17,5.29,6.17,9.96,8.23,3.89,5.36,5.28,5.58,4.12,4.12,11.73,17.62,5.77,5.66,5.82,8.5,5.29,5.88,5.29,5.29,5.29,4.12,4.7,5.29,5.29,13.52,6.17,4.41,5.58,4.41,5.44,4.28,4.28,4.7,4.7,4.7,5.66,4.11,5.88,5.82,7.05,7.33,2.83,7.08,4.98,9.74,5.29,6.47,7.05,8.81,6.17,5.64,26.41,22.0,5.86,5.51,5.73,3.54,8.0,5.29,5.36,6.17,5.88,5.88,5.73,5.88,27.76,11.02,22.0,6.03,4.7,7.65,80.0,7.61,13.23,3.89,5.26,5.51,12.35,6.47,5.88,6.76,14.11,6.47,5.0,10.57,7.82,6.34,4.6,6.45,7.33,8.0,6.76,5.29,3.82,4.85,4.85,4.85,2.94,1.47,1.47,5.66,10.58,7.35,5.29,6.91,4.98,6.75,17.59,17.59,5.88,4.64,6.47,5.29,5.58,5.88,12.74,100.0,4.98,57.28,49.97,28.66,6.47,12.79,13.67,7.35,7.35,16.99,16.12,25.2,16.12,4.6,5.57,1.98,49.97,5.29,5.58,5.88,15.43,33.05,17.61,9.6,5.29,6.34,6.4,26.41,6.17,22.0,7.33,3.82,17.59,16.53,14.55,14.33,16.53,33.98,5.86,5.29,6.47,4.7,5.29,90.83,90.83,6.47,15.58,15.58,4.41,6.17,8.8,17.56,8.71,6.63,4.69,6.37,4.25,17.64,24.69,6.76,7.33,6.47,17.59,5.31,6.47,9.52,4.98,4.96,4.98,4.25,9.6,8.32,28.8,5.57,5.88,36.81,8.82,14.7,8.44,6.32,4.81,11.64,4.39,8.23,5.58,22.0,26.41,22.0,5.38,6.46,5.88,9.96,4.39,8.78,4.18,8.35,8.67,4.41,5.0,5.24,5.57,3.55,7.2,5.58,5.58,4.17,5.58,4.98,11.38,6.17,5.58,9.24,6.03,5.58,5.58,26.41,8.79,17.59,4.63,5.88,6.17,5.64,4.58,3.67,5.82,22.0,5.57,7.08,5.29,8.81,3.96,3.96,6.76,4.08,8.82,4.7,38.58,26.46,12.35,8.52,14.55,25.2,13.82,5.88,2.97,5.31,5.12,2.97,4.98,8.52,6.47,25.17,7.72,5.58,4.17,6.34,8.8,4.08,3.52,4.41,13.23,9.22,9.22,9.22,9.22,26.41,5.88,5.66,8.53,7.35,7.89,7.33,7.35,7.27,9.2,3.25,7.11,8.82,4.6,8.0,8.8,5.28,4.12,6.47,7.35,7.35,7.28,7.94,6.4,26.41,7.05,5.88,5.88,6.61,7.56,5.64,4.11,19.82,4.6,5.29,8.23,7.35,10.67,13.87,22.05,13.23,8.52,6.03,6.17,5.26,15.43,9.6,21.46,15.43,15.43,4.0,5.31,5.81,8.96,111.11,7.05,6.34,7.05,9.59,6.68,4.93,6.32,3.82,66.09,17.64,5.28,21.38,6.47,4.53,3.67,13.23,16.15,5.58,5.73,5.29,6.61,6.03,6.03,6.47,5.58,9.16,17.64,39.0,17.94,7.05,8.79,22.0,7.05,5.28,4.7,4.69,6.91,5.0,4.7,4.16,4.16,3.69,3.69,20.22,4.27,22.0,7.33,22.0,9.48,6.17,5.86,4.08,5.86,7.64,3.63,3.17,7.05,23.52,6.91,39.68,17.64,20.83,21.52,5.57,4.98,3.17,5.66,10.29,10.29,3.89,5.31,8.5,4.6,6.61,5.73,12.04,12.35,3.52,6.61,5.64,5.88,8.82,12.52,4.1,5.58,6.17,5.57,10.57,44.09,7.04,10.67,3.19,3.96,27.76,23.37,27.76,6.76,5.86,6.47,4.7,6.47,10.62,26.46,70.55,35.27,16.0,5.44,39.66,22.02,4.7,6.91,5.88,3.82,8.23,16.28,22.02,132.28,127.87,29.39,16.75,5.31,11.76,7.35,27.76,5.0,4.08,5.88,22.53,3.82,7.08,2.94,3.82,4.85,1.47,4.85,4.85,3.82,1.47,80.0,5.64,5.29,5.29,5.29,7.79,12.04,22.05,6.47,5.58,26.46,6.03,5.88,44.09,7.35,8.82,10.58,7.64,4.98,8.52,7.05,10.4,11.02,5.58,11.02,5.58,7.35,8.8,7.72,15.41,11.0,5.58,11.33,5.29,5.88,2.97,5.58,11.32,13.45,7.35,5.64,4.93,7.05,6.76,5.88,6.47,9.92,5.58,7.35,5.58,6.68,6.37,6.37,5.26,4.25,22.02,4.67,11.02,6.47,5.22,6.47,40.56,35.27,36.11,35.27,22.05,10.58,37.04,11.46,17.64,2.26,14.11,4.96,5.88,7.64,5.58,5.88,5.1,8.21,10.57,26.46,25.6,29.08,115.2,8.82,10.05,4.26,6.98,3.96,3.82,11.33,5.29,7.64,5.58,7.64,5.29,5.86,4.98,6.91,6.47,123.46,7.05,8.8,5.58,5.88,5.73,26.46,14.11,4.93,4.93,5.64,4.93,4.93,5.29,6.76,4.85,5.44,6.76,5.66,8.23,4.81,7.75,8.82,11.17,5.88,6.34,6.34,5.73,5.29,5.29,5.88,19.84,6.55,5.66,6.76,5.58,4.6,4.6,5.22,5.29,11.02,8.82,7.35,16.0,5.42,5.1,27.76,7.94,28.66,26.46,5.58,5.58,6.76,5.73,15.71,4.94,15.58,11.17,4.94,4.12,6.76,6.47,4.69,5.86,13.23,3.39,111.11,9.6,9.6,6.17,7.64,5.88,14.08,10.08,15.58,5.28,5.28,5.58,11.17,6.34,6.34,5.14,5.48,6.47,8.0,6.17,4.74,4.08,5.58,44.09,44.09,8.46,2.36,7.05,5.0,22.02,5.14,6.47,6.47,8.38,5.65,6.07,7.05,3.53,2.83,5.58,4.91,11.61,35.27,10.14,9.17,4.4,5.88,8.46,10.43,6.37,7.08,25.57,17.28,5.52,7.5,8.5,9.91,3.4,4.96,6.47,6.47,7.64,5.58,7.33,8.8,8.8,6.45,5.66,21.14,6.8,6.88,6.8,4.6,7.2,8.0,7.2,7.35,7.33,7.41,5.31,6.91,9.46,5.29,5.88,6.51,7.05,6.47,3.89,11.95,9.6,16.0,8.32,9.04,9.91,1.36,4.85,1.47,1.47,8.82,4.41,14.16,13.52,5.57,8.82,9.17,8.8,6.08,5.88,8.11,7.04,4.7,2.94,2.94,4.7,5.88],"xaxis":"x","yaxis":"y","type":"histogram"}],                        {"template":{"data":{"histogram2dcontour":[{"type":"histogram2dcontour","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"choropleth":[{"type":"choropleth","colorbar":{"outlinewidth":0,"ticks":""}}],"histogram2d":[{"type":"histogram2d","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"heatmap":[{"type":"heatmap","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"heatmapgl":[{"type":"heatmapgl","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"contourcarpet":[{"type":"contourcarpet","colorbar":{"outlinewidth":0,"ticks":""}}],"contour":[{"type":"contour","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"surface":[{"type":"surface","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"mesh3d":[{"type":"mesh3d","colorbar":{"outlinewidth":0,"ticks":""}}],"scatter":[{"fillpattern":{"fillmode":"overlay","size":10,"solidity":0.2},"type":"scatter"}],"parcoords":[{"type":"parcoords","line":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scatterpolargl":[{"type":"scatterpolargl","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"bar":[{"error_x":{"color":"#2a3f5f"},"error_y":{"color":"#2a3f5f"},"marker":{"line":{"color":"#E5ECF6","width":0.5},"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"bar"}],"scattergeo":[{"type":"scattergeo","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scatterpolar":[{"type":"scatterpolar","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"histogram":[{"marker":{"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"histogram"}],"scattergl":[{"type":"scattergl","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scatter3d":[{"type":"scatter3d","line":{"colorbar":{"outlinewidth":0,"ticks":""}},"marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scattermapbox":[{"type":"scattermapbox","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scatterternary":[{"type":"scatterternary","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scattercarpet":[{"type":"scattercarpet","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"carpet":[{"aaxis":{"endlinecolor":"#2a3f5f","gridcolor":"white","linecolor":"white","minorgridcolor":"white","startlinecolor":"#2a3f5f"},"baxis":{"endlinecolor":"#2a3f5f","gridcolor":"white","linecolor":"white","minorgridcolor":"white","startlinecolor":"#2a3f5f"},"type":"carpet"}],"table":[{"cells":{"fill":{"color":"#EBF0F8"},"line":{"color":"white"}},"header":{"fill":{"color":"#C8D4E3"},"line":{"color":"white"}},"type":"table"}],"barpolar":[{"marker":{"line":{"color":"#E5ECF6","width":0.5},"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"barpolar"}],"pie":[{"automargin":true,"type":"pie"}]},"layout":{"autotypenumbers":"strict","colorway":["#636efa","#EF553B","#00cc96","#ab63fa","#FFA15A","#19d3f3","#FF6692","#B6E880","#FF97FF","#FECB52"],"font":{"color":"#2a3f5f"},"hovermode":"closest","hoverlabel":{"align":"left"},"paper_bgcolor":"white","plot_bgcolor":"#E5ECF6","polar":{"bgcolor":"#E5ECF6","angularaxis":{"gridcolor":"white","linecolor":"white","ticks":""},"radialaxis":{"gridcolor":"white","linecolor":"white","ticks":""}},"ternary":{"bgcolor":"#E5ECF6","aaxis":{"gridcolor":"white","linecolor":"white","ticks":""},"baxis":{"gridcolor":"white","linecolor":"white","ticks":""},"caxis":{"gridcolor":"white","linecolor":"white","ticks":""}},"coloraxis":{"colorbar":{"outlinewidth":0,"ticks":""}},"colorscale":{"sequential":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"sequentialminus":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"diverging":[[0,"#8e0152"],[0.1,"#c51b7d"],[0.2,"#de77ae"],[0.3,"#f1b6da"],[0.4,"#fde0ef"],[0.5,"#f7f7f7"],[0.6,"#e6f5d0"],[0.7,"#b8e186"],[0.8,"#7fbc41"],[0.9,"#4d9221"],[1,"#276419"]]},"xaxis":{"gridcolor":"white","linecolor":"white","ticks":"","title":{"standoff":15},"zerolinecolor":"white","automargin":true,"zerolinewidth":2},"yaxis":{"gridcolor":"white","linecolor":"white","ticks":"","title":{"standoff":15},"zerolinecolor":"white","automargin":true,"zerolinewidth":2},"scene":{"xaxis":{"backgroundcolor":"#E5ECF6","gridcolor":"white","linecolor":"white","showbackground":true,"ticks":"","zerolinecolor":"white","gridwidth":2},"yaxis":{"backgroundcolor":"#E5ECF6","gridcolor":"white","linecolor":"white","showbackground":true,"ticks":"","zerolinecolor":"white","gridwidth":2},"zaxis":{"backgroundcolor":"#E5ECF6","gridcolor":"white","linecolor":"white","showbackground":true,"ticks":"","zerolinecolor":"white","gridwidth":2}},"shapedefaults":{"line":{"color":"#2a3f5f"}},"annotationdefaults":{"arrowcolor":"#2a3f5f","arrowhead":0,"arrowwidth":1},"geo":{"bgcolor":"white","landcolor":"#E5ECF6","subunitcolor":"white","showland":true,"showlakes":true,"lakecolor":"white"},"title":{"x":0.05},"mapbox":{"style":"light"}}},"xaxis":{"anchor":"y","domain":[0.0,1.0],"title":{"text":"price_per_100g (USD)"}},"yaxis":{"anchor":"x","domain":[0.0,1.0],"title":{"text":"percent"}},"legend":{"title":{"text":"variable"},"tracegroupgap":0},"margin":{"t":60},"barmode":"relative"},                        {"responsive": true}                    )                };                            </script>        </div>

Now that we have applied the log transformation, the distribution is closer to a normal distribution.


```python
df["price_per_100g"].apply(np.log1p).(histnorm='percent', labels={"value":"price per 100g [log USD]"})
```
<div>                        <script type="text/javascript">window.PlotlyConfig = {MathJaxConfig: 'local'};</script>
        <script charset="utf-8" src="https://cdn.plot.ly/plotly-2.24.1.min.js"></script>                <div id="21e92513-9497-4f87-ac76-445bde2023b4" class="plotly-graph-div" style="height:100%; width:100%;"></div>            <script type="text/javascript">                                    window.PLOTLYENV=window.PLOTLYENV || {};                                    if (document.getElementById("21e92513-9497-4f87-ac76-445bde2023b4")) {                    Plotly.newPlot(                        "21e92513-9497-4f87-ac76-445bde2023b4",                        [{"alignmentgroup":"True","bingroup":"x","histnorm":"percent","hovertemplate":"variable=price_per_100g\u003cbr\u003eprice per 100g [log USD]=%{x}\u003cbr\u003epercent=%{y}\u003cextra\u003e\u003c\u002fextra\u003e","legendgroup":"price_per_100g","marker":{"color":"#636efa","pattern":{"shape":""}},"name":"price_per_100g","offsetgroup":"price_per_100g","orientation":"v","showlegend":true,"x":[1.7404661748405044,1.6467336971777973,1.766441661243765,1.814824742159051,1.6034198401085373,1.814824742159051,1.8389610707123492,1.5602476682433286,1.9065751436566365,2.063058062429312,2.063058062429312,1.8373699804801074,3.527830032595521,1.7227665977411035,1.8389610707123492,1.5871923034867808,1.7316555451583495,1.884034745337226,1.925707441737794,1.6882490928583902,1.884034745337226,1.7884205679625405,1.7884205679625405,2.122261538862764,2.010894999144726,1.6882490928583902,2.2449559801574095,2.843163674909384,3.515418525752178,3.035914063186823,1.925707441737794,1.7884205679625405,2.639057329615259,2.928523523860541,3.312730400339825,2.925309809257445,2.655352412101761,1.791759469228055,1.8373699804801074,2.122261538862764,2.085672091430472,1.631199404215613,1.873339456220478,4.519939041625431,4.519939041625431,2.639057329615259,1.790091412127358,1.791759469228055,3.1565747986708215,2.199444334074532,3.2112467977037094,1.884034745337226,2.322387720290225,2.085672091430472,1.715598108262491,1.6582280766035324,1.7227665977411035,1.766441661243765,1.728109442151599,1.728109442151599,1.7884205679625405,2.2793164660546914,2.2793164660546914,2.122261538862764,1.4609379041156565,1.6882490928583902,1.6331544390514163,1.5933085305042167,1.6601310267496183,3.035914063186823,1.8373699804801074,1.766441661243765,1.9671123567059163,1.791759469228055,1.9286186519452522,3.1565747986708215,2.0162354657760435,2.863913698933143,1.873339456220478,1.728109442151599,2.620311286794203,1.780024213009634,2.670694414558441,1.9286186519452522,2.0294631718735947,1.7850704810772584,3.5284172316728752,4.173309766520395,1.9065751436566365,1.8373699804801074,3.056827372913802,1.8389610707123492,2.5915163848462583,1.791759469228055,1.8389610707123492,2.057962510002712,2.2905125117597764,2.799108932049177,1.766441661243765,1.8961194845522977,1.715598108262491,1.8931119634883424,1.8389610707123492,1.9344157696295783,1.8389610707123492,1.4327007339340463,1.715598108262491,2.2512917986064953,2.318458442150336,1.715598108262491,1.7083778602890038,2.3263016196113617,1.8421356765531218,1.6882490928583902,1.884034745337226,1.8961194845522977,1.5432981099295553,1.8389610707123492,3.1018924693823817,1.9487632180377197,1.7884205679625405,1.8389610707123492,1.8389610707123492,1.62924053973028,1.62924053973028,1.969905654611529,1.9501867058225737,1.8931119634883424,1.5871923034867808,1.8500283773520307,2.2202898502672155,1.8825138324965192,4.719480532165502,1.5062971535145868,1.9065751436566365,1.9286186519452522,1.9286186519452522,2.0681277817795625,1.8389610707123492,2.546315277916644,2.546315277916644,1.8389610707123492,1.8389610707123492,1.5871923034867808,1.8389610707123492,1.7404661748405044,1.8389610707123492,1.7404661748405044,1.6882490928583902,1.8389610707123492,1.791759469228055,1.814824742159051,1.9501867058225737,1.873339456220478,1.873339456220478,1.728109442151599,1.9065751436566365,1.9065751436566365,1.9065751436566365,3.5284172316728752,1.7783364488959144,1.6034198401085373,1.5062971535145868,1.9286186519452522,1.969905654611529,1.7404661748405044,1.5107219394949427,2.3896797998449797,2.4527277514237653,1.8421356765531218,1.7884205679625405,1.7509374747077997,1.925707441737794,1.5260563034950494,1.8389610707123492,1.9065751436566365,3.5284172316728752,3.0368742168851663,1.7119945007591926,1.8625285401162623,1.814824742159051,2.3608540011180215,2.1972245773362196,1.791759469228055,3.4613513044819024,3.0368742168851663,3.0694473113762717,1.969905654611529,1.8389610707123492,1.8825138324965192,2.089391872533004,2.4865719291070616,2.190535589185423,2.715356776284648,3.0368742168851663,2.825536896557877,2.5455312716044354,2.5455312716044354,1.7884205679625405,1.884034745337226,1.6882490928583902,1.7884205679625405,2.048982334195127,3.035914063186823,1.7404661748405044,2.085672091430472,1.8389610707123492,1.814824742159051,1.8389610707123492,1.9286186519452522,1.7404661748405044,1.6582280766035324,1.631199404215613,1.6582280766035324,2.843163674909384,1.9065751436566365,2.122261538862764,2.048982334195127,1.969905654611529,1.8961194845522977,3.035914063186823,2.0294631718735947,1.8625285401162623,2.0014800002101243,1.791759469228055,1.884034745337226,1.9286186519452522,1.7867469274045107,1.8373699804801074,3.312730400339825,2.0294631718735947,2.1529243184396396,2.085672091430472,1.8389610707123492,2.010894999144726,1.884034745337226,1.631199404215613,1.8389610707123492,2.546315277916644,1.884034745337226,1.8389610707123492,1.6882490928583902,2.1529243184396396,2.0681277817795625,1.7404661748405044,2.655352412101761,2.655352412101761,1.6882490928583902,1.884034745337226,1.8389610707123492,1.5173226235262947,1.8389610707123492,2.0541237336955462,1.7884205679625405,1.7227665977411035,2.8081971497071487,2.850128299695199,1.791759469228055,2.449279472144849,1.8625285401162623,1.884034745337226,1.7509374747077997,1.7509374747077997,1.7850704810772584,2.863913698933143,1.7387102481382395,2.238579763018133,1.925707441737794,1.7351891177396608,2.922623801733353,3.6386382376771893,2.479056236109825,3.374168709274236,3.1179499062782403,2.449279472144849,2.715356776284648,1.7404661748405044,2.8942531046041373,2.254444717666111,2.5915163848462583,1.8389610707123492,2.340843805111136,2.1198634561787513,1.9286186519452522,1.8082887711792655,2.925309809257445,1.2669476034873244,3.798854307322508,3.312730400339825,1.884034745337226,1.7351891177396608,1.9782390361706734,2.2844211223663744,1.6882490928583902,1.969905654611529,1.7351891177396608,1.5432981099295553,1.3428648031925547,1.8389610707123492,2.048982334195127,1.884034745337226,3.098288861879083,1.269760544863939,2.655352412101761,4.519939041625431,1.7613002617433464,1.4327007339340463,2.546315277916644,1.9782390361706734,1.7850704810772584,1.5432981099295553,1.5871923034867808,2.8735646395797834,2.122261538862764,2.3905959703167587,1.9933388426264242,1.969905654611529,1.6582280766035324,1.884034745337226,2.048982334195127,1.884034745337226,3.165896900077314,3.1018924693823817,3.312730400339825,3.673765816303888,3.1376657694426577,1.884034745337226,1.7967470107390942,1.7967470107390942,1.5107219394949427,1.8718021769015913,1.8718021769015913,1.7850704810772584,1.9286186519452522,1.8389610707123492,2.9236990706541595,1.7227665977411035,1.5129270120532565,1.5129270120532565,1.3428648031925547,2.2823823856765264,2.2512917986064953,1.9065751436566365,3.312730400339825,1.8389610707123492,1.8389610707123492,3.280911215787653,3.005682604407159,1.9286186519452522,2.010894999144726,1.8389610707123492,4.248495242049359,1.8389610707123492,1.7404661748405044,2.0082140323914683,1.4350845252893227,1.8373699804801074,1.9685099809725544,2.0014800002101243,1.8931119634883424,2.8081971497071487,1.9286186519452522,2.3145136638593193,1.925707441737794,1.969905654611529,2.1972245773362196,1.969905654611529,2.0014800002101243,1.7884205679625405,1.7578579175523736,3.740522687265775,1.6582280766035324,1.6582280766035324,1.6582280766035324,1.969905654611529,2.922623801733353,1.7387102481382395,1.925707441737794,1.8389610707123492,1.6154199841116479,2.2823823856765264,2.833213344056216,2.1972245773362196,2.922623801733353,1.918392120161421,2.0294631718735947,3.4965075614664802,3.4965075614664802,3.4965075614664802,2.254444717666111,3.4965075614664802,1.631199404215613,1.631199404215613,1.463255402256019,0.9122827104766162,1.4060969884160703,3.358985532852846,3.835357920492661,1.9782390361706734,1.884034745337226,1.8341801851120072,1.814824742159051,1.8389610707123492,1.9065751436566365,1.918392120161421,1.5107219394949427,1.8578592709325787,2.655352412101761,1.7509374747077997,2.3608540011180215,1.7227665977411035,1.6882490928583902,1.8389610707123492,1.8341801851120072,1.8341801851120072,2.449279472144849,1.6034198401085373,1.9286186519452522,3.265759410767051,2.9236990706541595,2.9236990706541595,1.969905654611529,1.925707441737794,2.3702437414678603,2.0294631718735947,1.8389610707123492,1.791759469228055,1.8389610707123492,1.9286186519452522,2.048982334195127,2.0681277817795625,2.2491843162669305,1.766441661243765,3.1354942159291497,1.969905654611529,2.253394848803274,2.253394848803274,1.791759469228055,1.9286186519452522,1.9286186519452522,1.6582280766035324,1.6582280766035324,2.543961412569315,2.1198634561787513,2.922623801733353,2.085672091430472,2.449279472144849,1.969905654611529,1.884034745337226,0.15700374880966475,3.070375816549757,2.925309809257445,1.8389610707123492,2.655352412101761,1.9286186519452522,1.925707441737794,1.884034745337226,2.247072383063787,2.5915163848462583,2.449279472144849,2.925309809257445,2.0476928433652555,1.884034745337226,2.655352412101761,2.330200260027019,1.9974177062012453,1.873339456220478,2.744060638625243,2.744060638625243,1.9286186519452522,1.969905654611529,1.969905654611529,1.791759469228055,2.874129451794742,1.9286186519452522,1.4327007339340463,1.8389610707123492,2.512035317176253,1.873339456220478,1.791759469228055,4.719480532165502,0.8415671856782186,0.8501509293696101,1.6620303625532709,2.925309809257445,2.122261538862764,2.8763855159214247,1.969905654611529,1.969905654611529,1.8389610707123492,1.969905654611529,2.3942522815198695,2.222459048514761,1.5871923034867808,1.8500283773520307,1.8373699804801074,1.884034745337226,1.6331544390514163,1.6331544390514163,2.543961412569315,2.924236271848921,1.9125010869241836,1.8961194845522977,1.9198594718553708,2.2512917986064953,1.8389610707123492,1.9286186519452522,1.8389610707123492,1.8389610707123492,1.8389610707123492,1.6331544390514163,1.7404661748405044,1.8389610707123492,1.8389610707123492,2.67552700939665,1.969905654611529,1.6882490928583902,1.884034745337226,1.6882490928583902,1.8625285401162623,1.66392609771817,1.66392609771817,1.7404661748405044,1.7404661748405044,1.7404661748405044,1.8961194845522977,1.631199404215613,1.9286186519452522,1.9198594718553708,2.085672091430472,2.1198634561787513,1.3428648031925547,2.089391872533004,1.7884205679625405,2.3739750890807185,1.8389610707123492,2.010894999144726,2.085672091430472,2.2834022735772717,1.969905654611529,1.8931119634883424,3.3109079103146946,3.1354942159291497,1.925707441737794,1.873339456220478,1.9065751436566365,1.5129270120532565,2.1972245773362196,1.8389610707123492,1.8500283773520307,1.969905654611529,1.9286186519452522,1.9286186519452522,1.9065751436566365,1.9286186519452522,3.358985532852846,2.4865719291070616,3.1354942159291497,1.9501867058225737,1.7404661748405044,2.157559320943788,4.394449154672439,2.1529243184396396,2.655352412101761,1.5871923034867808,1.8341801851120072,1.873339456220478,2.5915163848462583,2.010894999144726,1.9286186519452522,2.048982334195127,2.715356776284648,2.010894999144726,1.791759469228055,2.448415541205585,2.1770218700187,1.9933388426264242,1.7227665977411035,2.0082140323914683,2.1198634561787513,2.1972245773362196,2.048982334195127,1.8389610707123492,1.5727739280625088,1.766441661243765,1.766441661243765,1.766441661243765,1.3711807233098425,0.9042181506398859,0.9042181506398859,1.8961194845522977,2.449279472144849,2.122261538862764,1.8389610707123492,2.0681277817795625,1.7884205679625405,2.0476928433652555,2.922623801733353,2.922623801733353,1.9286186519452522,1.7298840655099674,2.010894999144726,1.8389610707123492,1.884034745337226,1.9286186519452522,2.620311286794203,4.61512051684126,1.7884205679625405,4.065258981327004,3.93123722435195,3.389799336709786,2.010894999144726,2.6239436918052106,2.6858045921548905,2.122261538862764,2.122261538862764,2.8898160479624417,2.840247370713596,3.265759410767051,2.840247370713596,1.7227665977411035,1.8825138324965192,1.091923300517313,3.93123722435195,1.8389610707123492,1.884034745337226,1.9286186519452522,2.799108932049177,3.527830032595521,2.9236990706541595,2.3608540011180215,1.8389610707123492,1.9933388426264242,2.0014800002101243,3.3109079103146946,1.969905654611529,3.1354942159291497,2.1198634561787513,1.5727739280625088,2.922623801733353,2.863913698933143,2.744060638625243,2.7298116928837226,2.863913698933143,3.554776469590456,1.925707441737794,1.8389610707123492,2.010894999144726,1.7404661748405044,1.8389610707123492,4.519939041625431,4.519939041625431,2.010894999144726,2.8081971497071487,2.8081971497071487,1.6882490928583902,1.969905654611529,2.2823823856765264,2.9210087273580543,2.2731562823032334,2.0320878452963655,1.7387102481382395,1.9974177062012453,1.6582280766035324,2.925309809257445,3.2461018111217923,2.048982334195127,2.1198634561787513,2.010894999144726,2.922623801733353,1.8421356765531218,2.010894999144726,2.3532782073095637,1.7884205679625405,1.7850704810772584,1.7884205679625405,1.6582280766035324,2.3608540011180215,2.2321626286975,3.3945083935113587,1.8825138324965192,1.9286186519452522,3.6325736179028416,2.2844211223663744,2.7536607123542622,2.2449559801574095,1.9906103279732201,1.75958057086382,2.5368663887187113,1.6845453849209058,2.222459048514761,1.884034745337226,3.1354942159291497,3.3109079103146946,3.1354942159291497,1.8531680973566984,2.0095554142156695,1.9286186519452522,2.3942522815198695,1.6845453849209058,2.280339484046726,1.6448050562713916,2.2353763433005955,2.269028309465203,1.6882490928583902,1.791759469228055,1.8309801823813363,1.8825138324965192,1.515127232962859,2.1041341542702074,1.884034745337226,1.884034745337226,1.6428726885203377,1.884034745337226,1.7884205679625405,2.5160822672564502,1.969905654611529,1.884034745337226,2.3263016196113617,1.9501867058225737,1.884034745337226,1.884034745337226,3.3109079103146946,2.281361456542419,2.922623801733353,1.728109442151599,1.9286186519452522,1.969905654611529,1.8931119634883424,1.7191887763932197,1.541159071680806,1.9198594718553708,3.1354942159291497,1.8825138324965192,2.089391872533004,1.8389610707123492,2.2834022735772717,1.601405740736836,1.601405740736836,2.048982334195127,1.6253112615903906,2.2844211223663744,1.7404661748405044,3.6783239401744194,3.312730400339825,2.5915163848462583,2.253394848803274,2.744060638625243,3.265759410767051,2.695977619867941,1.9286186519452522,1.3787660946990992,1.8421356765531218,1.8115620965242347,1.3787660946990992,1.7884205679625405,2.253394848803274,2.010894999144726,3.264613716542055,2.1656192379208883,1.884034745337226,1.6428726885203377,1.9933388426264242,2.2823823856765264,1.6253112615903906,1.5085119938441398,1.6882490928583902,2.655352412101761,2.3243465847755584,2.3243465847755584,2.3243465847755584,2.3243465847755584,3.3109079103146946,1.9286186519452522,1.8961194845522977,2.254444717666111,2.122261538862764,2.1849270495258133,2.1198634561787513,2.122261538862764,2.1126345090356,2.322387720290225,1.4469189829363254,2.093097868127322,2.2844211223663744,1.7227665977411035,2.1972245773362196,2.2823823856765264,1.8373699804801074,1.6331544390514163,2.010894999144726,2.122261538862764,2.122261538862764,2.1138429683971682,2.190535589185423,2.0014800002101243,3.3109079103146946,2.085672091430472,1.9286186519452522,1.9286186519452522,2.0294631718735947,2.1471001901536506,1.8931119634883424,1.631199404215613,3.035914063186823,1.7227665977411035,1.8389610707123492,2.222459048514761,2.122261538862764,2.4570214462984645,2.6993457604720636,3.1376657694426577,2.655352412101761,2.253394848803274,1.9501867058225737,1.969905654611529,1.8341801851120072,2.799108932049177,2.3608540011180215,3.1117359493102974,2.799108932049177,2.799108932049177,1.6094379124341003,1.8421356765531218,1.918392120161421,2.298577071596507,4.719480532165502,2.085672091430472,1.9933388426264242,2.085672091430472,2.359910159613315,2.038619547159581,1.780024213009634,1.9906103279732201,1.5727739280625088,4.206035001574797,2.925309809257445,1.8373699804801074,3.108167702883779,2.010894999144726,1.7101878155342436,1.541159071680806,2.655352412101761,2.841998173611949,1.884034745337226,1.9065751436566365,1.8389610707123492,2.0294631718735947,1.9501867058225737,1.9501867058225737,2.010894999144726,1.884034745337226,2.318458442150336,2.925309809257445,3.6888794541139363,2.9412760877579323,2.085672091430472,2.281361456542419,3.1354942159291497,2.085672091430472,1.8373699804801074,1.7404661748405044,1.7387102481382395,2.0681277817795625,1.791759469228055,1.7404661748405044,1.6409365794934714,1.6409365794934714,1.545432582458188,1.545432582458188,3.054944133185837,1.6620303625532709,3.1354942159291497,2.1198634561787513,3.1354942159291497,2.349468678892896,1.969905654611529,1.925707441737794,1.6253112615903906,1.925707441737794,2.1564025828159643,1.5325568680981427,1.4279160358107101,2.085672091430472,3.1994891110680106,2.0681277817795625,3.7057365711803594,2.925309809257445,3.0832851705618527,3.1144038032714896,1.8825138324965192,1.7884205679625405,1.4279160358107101,1.8961194845522977,2.423917378161571,2.423917378161571,1.5871923034867808,1.8421356765531218,2.2512917986064953,1.7227665977411035,2.0294631718735947,1.9065751436566365,2.5680215564985067,2.5915163848462583,1.5085119938441398,2.0294631718735947,1.8931119634883424,1.9286186519452522,2.2844211223663744,2.604170070614818,1.62924053973028,1.884034745337226,1.969905654611529,1.8825138324965192,2.448415541205585,3.8086604924329928,2.084429083190875,2.4570214462984645,1.4327007339340463,1.601405740736836,3.358985532852846,3.193352867637115,3.358985532852846,2.048982334195127,1.925707441737794,2.010894999144726,1.7404661748405044,2.010894999144726,2.4527277514237653,3.312730400339825,4.27039650600246,3.590990953294811,2.833213344056216,1.8625285401162623,3.7052448082002005,3.1363634032937364,1.7404661748405044,2.0681277817795625,1.9286186519452522,1.5727739280625088,2.222459048514761,2.8495497633759097,3.1363634032937364,4.892452178418533,4.8588041443003,3.414113606928702,2.8763855159214247,1.8421356765531218,2.546315277916644,2.122261538862764,3.358985532852846,1.791759469228055,1.6253112615903906,1.9286186519452522,3.158276202739271,1.5727739280625088,2.089391872533004,1.3711807233098425,1.5727739280625088,1.766441661243765,0.9042181506398859,1.766441661243765,1.766441661243765,1.5727739280625088,0.9042181506398859,4.394449154672439,1.8931119634883424,1.8389610707123492,1.8389610707123492,1.8389610707123492,2.1736147116970854,2.5680215564985067,3.1376657694426577,2.010894999144726,1.884034745337226,3.312730400339825,1.9501867058225737,1.9286186519452522,3.8086604924329928,2.122261538862764,2.2844211223663744,2.449279472144849,2.1564025828159643,1.7884205679625405,2.253394848803274,2.085672091430472,2.4336133554004498,2.4865719291070616,1.884034745337226,2.4865719291070616,1.884034745337226,2.122261538862764,2.2823823856765264,2.1656192379208883,2.7978909051019993,2.4849066497880004,1.884034745337226,2.512035317176253,1.8389610707123492,1.9286186519452522,1.3787660946990992,1.884034745337226,2.511223958105374,2.670694414558441,2.122261538862764,1.8931119634883424,1.780024213009634,2.085672091430472,2.048982334195127,1.9286186519452522,2.010894999144726,2.3905959703167587,1.884034745337226,2.122261538862764,1.884034745337226,2.038619547159581,1.9974177062012453,1.9974177062012453,1.8341801851120072,1.6582280766035324,3.1363634032937364,1.7351891177396608,2.4865719291070616,2.010894999144726,1.827769906751088,2.010894999144726,3.727138166231027,3.590990953294811,3.613886475072506,3.590990953294811,3.1376657694426577,2.449279472144849,3.6386382376771893,2.522523513359307,2.925309809257445,1.1817271953786161,2.715356776284648,1.7850704810772584,1.9286186519452522,2.1564025828159643,1.884034745337226,1.9286186519452522,1.8082887711792655,2.2202898502672155,2.448415541205585,3.312730400339825,3.280911215787653,3.403860499081639,4.755312844417811,2.2844211223663744,2.402430427963762,1.6601310267496183,2.0769384114617173,1.601405740736836,1.5727739280625088,2.512035317176253,1.8389610707123492,2.1564025828159643,1.884034745337226,2.1564025828159643,1.8389610707123492,1.925707441737794,1.7884205679625405,2.0681277817795625,2.010894999144726,4.823984379141072,2.085672091430472,2.2823823856765264,1.884034745337226,1.9286186519452522,1.9065751436566365,3.312730400339825,2.715356776284648,1.780024213009634,1.780024213009634,1.8931119634883424,1.780024213009634,1.780024213009634,1.8389610707123492,2.048982334195127,1.766441661243765,1.8625285401162623,2.048982334195127,1.8961194845522977,2.222459048514761,1.75958057086382,2.169053700369523,2.2844211223663744,2.498973906999436,1.9286186519452522,1.9933388426264242,1.9933388426264242,1.9065751436566365,1.8389610707123492,1.8389610707123492,1.9286186519452522,3.0368742168851663,2.0215475632609334,1.8961194845522977,2.048982334195127,1.884034745337226,1.7227665977411035,1.7227665977411035,1.827769906751088,1.8389610707123492,2.4865719291070616,2.2844211223663744,2.122261538862764,2.833213344056216,1.8594181177018698,1.8082887711792655,3.358985532852846,2.190535589185423,3.389799336709786,3.312730400339825,1.884034745337226,1.884034745337226,2.048982334195127,1.9065751436566365,2.8160073426073025,1.7817091333745536,2.8081971497071487,2.498973906999436,1.7817091333745536,1.6331544390514163,2.048982334195127,2.010894999144726,1.7387102481382395,1.925707441737794,2.655352412101761,1.47932922708708,4.719480532165502,2.3608540011180215,2.3608540011180215,1.969905654611529,2.1564025828159643,1.9286186519452522,2.71336936257981,2.4051416813191375,2.8081971497071487,1.8373699804801074,1.8373699804801074,1.884034745337226,2.498973906999436,1.9933388426264242,1.9933388426264242,1.814824742159051,1.8687205103641835,2.010894999144726,2.1972245773362196,1.969905654611529,1.747459210331475,1.6253112615903906,1.884034745337226,3.8086604924329928,3.8086604924329928,2.247072383063787,1.2119409739751128,2.085672091430472,1.791759469228055,3.1363634032937364,1.814824742159051,2.010894999144726,2.010894999144726,2.238579763018133,1.8946168546677629,1.9558604799084813,2.085672091430472,1.5107219394949427,1.3428648031925547,1.884034745337226,1.776645831418007,2.534490149976828,3.590990953294811,2.410542234499138,2.3194422100604686,1.6863989535702286,1.9286186519452522,2.247072383063787,2.4362414778067194,1.9974177062012453,2.089391872533004,3.279782759771722,2.905807566026004,1.8748743759385615,2.1400661634962708,2.2512917986064953,2.3896797998449797,1.4816045409242156,1.7850704810772584,2.010894999144726,2.010894999144726,2.1564025828159643,1.884034745337226,2.1198634561787513,2.2823823856765264,2.2823823856765264,2.0082140323914683,1.8961194845522977,3.0973859272804907,2.0541237336955462,2.064327903869788,2.0541237336955462,1.7227665977411035,2.1041341542702074,2.1972245773362196,2.1041341542702074,2.122261538862764,2.1198634561787513,2.1294214739848565,1.8421356765531218,2.0681277817795625,2.347558458636777,1.8389610707123492,1.9286186519452522,2.0162354657760435,2.085672091430472,2.010894999144726,1.5871923034867808,2.5610957881455465,2.3608540011180215,2.833213344056216,2.2321626286975,2.306577114263583,2.3896797998449797,0.8586616190375187,1.766441661243765,0.9042181506398859,0.9042181506398859,2.2844211223663744,1.6882490928583902,2.7186603802142257,2.67552700939665,1.8825138324965192,2.2844211223663744,2.3194422100604686,2.2823823856765264,1.9572739077056285,1.9286186519452522,2.209372711271867,2.084429083190875,1.7404661748405044,1.3711807233098425,1.3711807233098425,1.7404661748405044,1.9286186519452522],"xaxis":"x","yaxis":"y","type":"histogram"}],                        {"template":{"data":{"histogram2dcontour":[{"type":"histogram2dcontour","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"choropleth":[{"type":"choropleth","colorbar":{"outlinewidth":0,"ticks":""}}],"histogram2d":[{"type":"histogram2d","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"heatmap":[{"type":"heatmap","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"heatmapgl":[{"type":"heatmapgl","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"contourcarpet":[{"type":"contourcarpet","colorbar":{"outlinewidth":0,"ticks":""}}],"contour":[{"type":"contour","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"surface":[{"type":"surface","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"mesh3d":[{"type":"mesh3d","colorbar":{"outlinewidth":0,"ticks":""}}],"scatter":[{"fillpattern":{"fillmode":"overlay","size":10,"solidity":0.2},"type":"scatter"}],"parcoords":[{"type":"parcoords","line":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scatterpolargl":[{"type":"scatterpolargl","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"bar":[{"error_x":{"color":"#2a3f5f"},"error_y":{"color":"#2a3f5f"},"marker":{"line":{"color":"#E5ECF6","width":0.5},"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"bar"}],"scattergeo":[{"type":"scattergeo","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scatterpolar":[{"type":"scatterpolar","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"histogram":[{"marker":{"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"histogram"}],"scattergl":[{"type":"scattergl","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scatter3d":[{"type":"scatter3d","line":{"colorbar":{"outlinewidth":0,"ticks":""}},"marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scattermapbox":[{"type":"scattermapbox","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scatterternary":[{"type":"scatterternary","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scattercarpet":[{"type":"scattercarpet","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"carpet":[{"aaxis":{"endlinecolor":"#2a3f5f","gridcolor":"white","linecolor":"white","minorgridcolor":"white","startlinecolor":"#2a3f5f"},"baxis":{"endlinecolor":"#2a3f5f","gridcolor":"white","linecolor":"white","minorgridcolor":"white","startlinecolor":"#2a3f5f"},"type":"carpet"}],"table":[{"cells":{"fill":{"color":"#EBF0F8"},"line":{"color":"white"}},"header":{"fill":{"color":"#C8D4E3"},"line":{"color":"white"}},"type":"table"}],"barpolar":[{"marker":{"line":{"color":"#E5ECF6","width":0.5},"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"barpolar"}],"pie":[{"automargin":true,"type":"pie"}]},"layout":{"autotypenumbers":"strict","colorway":["#636efa","#EF553B","#00cc96","#ab63fa","#FFA15A","#19d3f3","#FF6692","#B6E880","#FF97FF","#FECB52"],"font":{"color":"#2a3f5f"},"hovermode":"closest","hoverlabel":{"align":"left"},"paper_bgcolor":"white","plot_bgcolor":"#E5ECF6","polar":{"bgcolor":"#E5ECF6","angularaxis":{"gridcolor":"white","linecolor":"white","ticks":""},"radialaxis":{"gridcolor":"white","linecolor":"white","ticks":""}},"ternary":{"bgcolor":"#E5ECF6","aaxis":{"gridcolor":"white","linecolor":"white","ticks":""},"baxis":{"gridcolor":"white","linecolor":"white","ticks":""},"caxis":{"gridcolor":"white","linecolor":"white","ticks":""}},"coloraxis":{"colorbar":{"outlinewidth":0,"ticks":""}},"colorscale":{"sequential":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"sequentialminus":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"diverging":[[0,"#8e0152"],[0.1,"#c51b7d"],[0.2,"#de77ae"],[0.3,"#f1b6da"],[0.4,"#fde0ef"],[0.5,"#f7f7f7"],[0.6,"#e6f5d0"],[0.7,"#b8e186"],[0.8,"#7fbc41"],[0.9,"#4d9221"],[1,"#276419"]]},"xaxis":{"gridcolor":"white","linecolor":"white","ticks":"","title":{"standoff":15},"zerolinecolor":"white","automargin":true,"zerolinewidth":2},"yaxis":{"gridcolor":"white","linecolor":"white","ticks":"","title":{"standoff":15},"zerolinecolor":"white","automargin":true,"zerolinewidth":2},"scene":{"xaxis":{"backgroundcolor":"#E5ECF6","gridcolor":"white","linecolor":"white","showbackground":true,"ticks":"","zerolinecolor":"white","gridwidth":2},"yaxis":{"backgroundcolor":"#E5ECF6","gridcolor":"white","linecolor":"white","showbackground":true,"ticks":"","zerolinecolor":"white","gridwidth":2},"zaxis":{"backgroundcolor":"#E5ECF6","gridcolor":"white","linecolor":"white","showbackground":true,"ticks":"","zerolinecolor":"white","gridwidth":2}},"shapedefaults":{"line":{"color":"#2a3f5f"}},"annotationdefaults":{"arrowcolor":"#2a3f5f","arrowhead":0,"arrowwidth":1},"geo":{"bgcolor":"white","landcolor":"#E5ECF6","subunitcolor":"white","showland":true,"showlakes":true,"lakecolor":"white"},"title":{"x":0.05},"mapbox":{"style":"light"}}},"xaxis":{"anchor":"y","domain":[0.0,1.0],"title":{"text":"price per 100g [log USD]"}},"yaxis":{"anchor":"x","domain":[0.0,1.0],"title":{"text":"percent"}},"legend":{"title":{"text":"variable"},"tracegroupgap":0},"margin":{"t":60},"barmode":"relative"},                        {"responsive": true}                    )                };                            </script>        </div>

### Roasting style
The vast majority of the coffee have the medium-light roast type. This large bias in the dataset may make it challenging for a model to detect any impact of roast style on coffee rating.


```python
px.histogram(df, x="roast", histnorm="percent", category_orders={"roast": ["Light", "Medium-Light", "Medium", "Medium-Dark", "Dark"]})
```

<div>                        <script type="text/javascript">window.PlotlyConfig = {MathJaxConfig: 'local'};</script>
        <script charset="utf-8" src="https://cdn.plot.ly/plotly-2.24.1.min.js"></script>                <div id="40955c87-9e73-4655-b149-e02bd0d12c59" class="plotly-graph-div" style="height:100%; width:100%;"></div>            <script type="text/javascript">                                    window.PLOTLYENV=window.PLOTLYENV || {};                                    if (document.getElementById("40955c87-9e73-4655-b149-e02bd0d12c59")) {                    Plotly.newPlot(                        "40955c87-9e73-4655-b149-e02bd0d12c59",                        [{"alignmentgroup":"True","bingroup":"x","histnorm":"percent","hovertemplate":"roast=%{x}\u003cbr\u003epercent=%{y}\u003cextra\u003e\u003c\u002fextra\u003e","legendgroup":"","marker":{"color":"#636efa","pattern":{"shape":""}},"name":"","offsetgroup":"","orientation":"v","showlegend":false,"x":["Medium-Light","Medium-Light","Medium","Light","Medium-Light","Medium-Light","Medium-Light","Medium","Medium","Medium-Light","Medium-Light","Medium-Light","Medium-Light","Medium-Light","Medium-Dark","Medium-Light","Medium-Light","Light","Medium-Light","Medium-Light","Light","Medium-Light","Medium","Medium-Light","Medium-Light","Medium-Light","Light","Medium-Light","Medium-Light","Medium-Light","Medium-Light","Medium-Light","Medium-Light","Medium","Medium-Light","Light","Medium-Light","Light","Light","Medium-Light","Medium-Light","Medium","Medium-Light","Medium-Light","Medium-Light","Medium-Light","Light","Light","Medium-Light","Medium-Light","Light","Medium-Light","Medium-Dark","Medium","Medium-Light","Light","Light","Light","Medium-Light","Medium-Light","Medium","Light","Medium","Medium-Light","Medium-Light","Light","Medium-Light","Light","Medium","Medium","Medium-Light","Medium-Light","Medium-Light","Medium-Light","Light","Medium-Light","Light","Medium","Medium-Light","Medium-Light","Medium-Light","Medium-Light","Medium-Light","Medium-Light","Medium-Light","Light","Medium-Light","Medium-Light","Medium-Light","Medium","Medium-Light","Medium-Light","Medium-Light","Medium-Light","Medium-Light","Medium","Medium-Light","Medium-Light","Medium-Light","Medium-Light","Medium-Light","Medium-Light","Medium-Light","Medium-Light","Medium-Light","Medium-Light","Medium-Light","Medium-Light","Medium-Light","Medium-Light","Medium-Light","Medium-Light","Medium-Light","Medium","Light","Light","Light","Medium-Light","Medium-Light","Medium-Dark","Medium","Medium-Light","Medium-Light","Medium-Light","Medium-Light","Medium-Light","Medium-Light","Medium","Medium-Light","Medium","Medium","Medium-Light","Medium-Light","Medium-Light","Medium-Light","Medium-Light","Medium-Light","Medium-Light","Medium-Light","Light","Medium-Light","Medium-Light","Medium-Light","Medium-Light","Medium-Light","Medium-Light","Medium-Light","Medium-Light","Medium-Light","Medium-Light","Medium-Light","Medium-Light","Medium-Light","Medium-Light","Medium-Light","Medium-Light","Medium-Light","Medium-Light","Medium-Light","Medium-Light","Medium-Light","Medium-Light","Medium","Medium-Light","Light","Medium-Light","Medium-Light","Medium-Dark","Medium-Dark","Medium-Light","Medium","Medium-Light","Medium-Light","Medium","Light","Medium-Light","Medium-Light","Medium-Light","Medium-Light","Medium-Light","Medium-Light","Medium-Light","Medium-Light","Medium-Light","Medium-Light","Medium-Light","Medium-Light","Medium-Light","Medium-Light","Medium-Light","Light","Light","Medium-Light","Medium-Light","Medium-Light","Medium-Light","Medium-Light","Medium-Light","Medium-Light","Medium-Light","Medium-Light","Medium","Medium-Light","Medium","Medium-Light","Medium-Light","Medium-Light","Medium-Light","Light","Medium","Medium-Light","Medium-Light","Medium-Light","Medium-Light","Medium-Light","Medium-Light","Medium-Light","Medium-Light","Medium-Light","Medium-Light","Medium-Light","Medium-Light","Medium-Light","Medium-Light","Medium-Light","Medium","Medium-Light","Medium-Light","Medium-Light","Medium-Light","Medium-Light","Medium-Light","Medium-Light","Medium-Light","Medium","Medium-Light","Medium","Medium-Light","Medium-Light","Medium-Light","Medium-Light","Medium-Light","Medium-Light","Medium-Light","Medium-Light","Medium-Light","Medium-Light","Medium-Light","Medium-Light","Medium-Light","Light","Medium-Light","Medium-Light","Light","Medium-Light","Medium-Light","Medium","Medium-Light","Medium","Medium-Light","Medium-Light","Medium-Light","Medium-Light","Medium-Light","Medium","Medium-Light","Medium","Medium-Light","Medium-Light","Light","Medium-Light","Medium-Light","Medium-Light","Medium-Light","Medium-Light","Medium-Light","Medium-Light","Medium","Medium-Light","Medium","Medium-Light","Medium-Light","Medium-Light","Medium-Light","Medium-Light","Medium","Medium","Medium-Light","Medium-Light","Medium-Light","Medium-Light","Medium-Light","Medium-Light","Medium-Light","Medium-Light","Medium-Light","Medium-Light","Medium","Medium-Light","Medium-Light","Medium","Medium-Light","Medium-Light","Medium-Light","Medium-Light","Medium-Light","Medium-Dark","Medium-Light","Medium-Light","Medium","Medium-Light","Medium-Light","Light","Medium","Medium","Medium-Light","Medium","Medium-Light","Medium","Medium","Medium-Light","Medium-Light","Medium-Light","Medium-Light","Medium-Light","Medium-Light","Medium-Light","Medium-Light","Medium-Light","Medium-Light","Medium-Light","Medium-Light","Light","Medium-Light","Medium-Light","Medium-Light","Medium-Light","Medium","Medium-Light","Medium","Medium","Dark","Medium-Light","Medium","Medium-Light","Light","Medium-Light","Medium-Light","Medium-Light","Medium-Light","Light","Medium-Light","Medium-Light","Medium-Light","Medium-Light","Medium-Light","Medium-Light","Medium-Light","Medium-Light","Medium-Light","Medium-Dark","Medium-Light","Medium-Light","Medium-Light","Medium-Light","Medium-Light","Medium-Light","Medium","Medium-Light","Medium-Light","Medium-Light","Medium","Medium-Light","Medium-Light","Medium-Light","Medium-Light","Medium","Medium","Medium-Light","Medium","Medium-Light","Medium-Light","Medium-Light","Medium-Light","Medium-Light","Medium","Medium","Medium-Light","Medium-Light","Medium","Medium","Medium","Medium-Light","Medium","Medium","Dark","Medium-Light","Medium-Light","Medium-Light","Medium-Light","Medium-Light","Medium-Light","Medium-Light","Medium-Light","Medium-Light","Medium","Medium-Light","Medium-Light","Medium-Light","Medium","Medium-Light","Medium-Light","Medium-Light","Medium-Light","Medium-Light","Medium","Medium","Medium-Light","Medium-Light","Medium-Light","Medium-Light","Medium-Light","Medium-Light","Light","Medium-Light","Medium","Medium-Light","Medium-Light","Medium-Light","Medium-Light","Medium-Light","Medium","Medium-Light","Medium-Light","Light","Medium-Light","Medium-Light","Medium-Light","Light","Medium-Light","Medium-Light","Medium-Light","Medium-Light","Light","Medium-Light","Medium-Light","Medium","Medium-Light","Medium-Light","Medium-Light","Medium-Light","Medium-Light","Medium","Medium-Light","Medium-Light","Medium-Light","Medium-Light","Medium","Medium-Light","Medium-Light","Medium","Medium-Light","Medium","Medium","Medium-Light","Medium-Light","Medium-Light","Medium-Light","Medium","Medium-Light","Medium","Medium-Light","Medium-Light","Medium","Medium-Light","Medium-Light","Medium-Light","Medium-Light","Medium-Light","Medium-Light","Medium-Light","Medium-Light","Medium-Light","Medium-Light","Light","Medium-Light","Medium-Light","Medium-Light","Medium-Light","Medium-Light","Medium-Light","Medium-Light","Medium-Light","Medium-Light","Medium-Light","Medium","Medium-Light","Medium-Light","Medium-Light","Light","Light","Medium-Light","Light","Medium-Light","Medium-Light","Medium-Light","Medium-Light","Medium-Light","Medium-Light","Medium-Light","Light","Light","Light","Medium-Light","Light","Medium-Light","Medium-Light","Light","Medium-Light","Light","Medium","Medium-Light","Medium-Light","Medium-Light","Medium-Light","Medium-Light","Medium-Light","Light","Medium-Light","Medium-Light","Light","Medium-Light","Medium-Light","Medium","Medium-Light","Medium-Light","Medium-Light","Medium-Light","Medium-Light","Medium-Light","Medium-Light","Medium-Light","Medium-Light","Medium-Light","Medium-Light","Medium-Light","Light","Medium-Light","Medium-Light","Medium-Light","Medium-Light","Medium-Light","Medium-Light","Medium-Light","Light","Medium-Light","Medium-Dark","Medium-Light","Medium-Light","Light","Medium-Light","Light","Medium-Light","Medium-Light","Medium-Light","Medium-Light","Medium-Light","Medium-Light","Light","Medium-Light","Medium-Light","Medium-Light","Medium","Medium-Light","Medium-Light","Medium-Light","Medium-Light","Medium-Light","Medium-Light","Medium-Light","Medium-Light","Medium-Light","Medium-Light","Medium-Light","Medium-Light","Medium","Medium-Light","Medium-Light","Medium","Medium-Dark","Medium-Light","Medium-Light","Medium-Light","Medium-Light","Medium-Light","Medium-Light","Medium-Light","Light","Medium-Light","Medium-Light","Medium-Light","Medium-Light","Medium-Light","Medium-Light","Medium-Light","Medium","Medium-Light","Medium-Light","Light","Medium-Light","Medium-Light","Medium-Light","Medium-Light","Medium-Light","Medium-Light","Medium-Light","Medium-Light","Medium","Medium","Medium-Light","Medium-Light","Medium-Light","Medium-Light","Medium-Light","Medium","Light","Medium-Light","Medium-Light","Medium-Light","Medium-Light","Medium-Light","Light","Medium-Light","Medium-Light","Medium-Light","Light","Medium-Light","Medium-Light","Medium","Light","Medium-Light","Medium-Light","Medium","Medium-Light","Medium-Light","Medium-Light","Medium-Light","Light","Medium-Light","Medium-Light","Medium-Light","Medium-Light","Light","Medium","Medium","Medium-Light","Medium-Light","Medium-Light","Light","Medium-Light","Medium-Light","Medium-Light","Light","Medium-Light","Medium","Medium-Light","Medium-Light","Light","Medium-Light","Medium-Light","Medium-Light","Medium-Light","Medium-Light","Medium","Light","Medium-Light","Medium-Light","Medium-Light","Medium-Light","Medium-Light","Medium-Light","Light","Light","Medium-Light","Medium-Light","Medium-Light","Light","Light","Medium-Light","Medium-Light","Medium-Light","Medium-Light","Light","Light","Light","Medium-Light","Light","Medium-Light","Light","Medium-Light","Light","Medium-Light","Medium-Light","Light","Medium-Light","Medium-Light","Medium-Light","Medium-Light","Medium-Light","Medium","Medium-Light","Medium-Light","Medium","Medium-Light","Medium-Light","Light","Light","Light","Medium-Light","Medium-Light","Medium-Light","Medium-Light","Medium-Light","Light","Medium","Medium-Dark","Medium-Light","Light","Medium-Light","Medium-Light","Medium-Light","Light","Medium-Light","Medium-Light","Medium-Light","Light","Light","Medium-Light","Medium-Light","Medium-Light","Medium-Light","Medium-Light","Light","Medium-Light","Light","Medium-Light","Light","Medium-Light","Medium-Light","Medium-Light","Medium-Light","Medium-Light","Light","Medium-Light","Medium-Light","Light","Medium-Light","Medium-Light","Medium-Light","Medium-Light","Medium-Light","Medium-Light","Light","Medium-Light","Medium-Light","Medium-Light","Medium-Light","Medium-Light","Light","Light","Light","Light","Medium-Light","Medium-Light","Medium-Light","Light","Medium-Light","Medium-Light","Medium-Light","Medium-Light","Medium-Light","Medium-Light","Medium-Light","Medium","Medium-Light","Medium-Light","Medium-Light","Medium-Light","Medium-Light","Medium-Light","Medium-Light","Medium-Light","Medium-Light","Medium-Light","Medium-Light","Light","Light","Medium-Light","Light","Medium-Light","Light","Light","Medium","Medium-Light","Medium-Light","Light","Medium-Light","Medium-Light","Medium-Light","Medium-Light","Light","Medium-Light","Light","Medium-Light","Medium-Light","Medium-Light","Medium-Light","Light","Light","Light","Medium-Light","Medium-Light","Medium-Light","Light","Light","Medium-Light","Medium-Light","Light","Light","Medium-Light","Medium-Light","Medium-Light","Medium-Light","Medium-Light","Medium-Light","Light","Medium-Light","Medium-Light","Light","Medium-Light","Medium-Light","Medium-Light","Medium-Light","Light","Medium-Light","Medium-Light","Light","Medium-Light","Medium-Light","Medium-Light","Medium-Light","Medium-Light","Medium-Light","Medium-Light","Light","Medium-Light","Medium-Light","Light","Medium-Light","Medium-Light","Medium-Light","Medium-Light","Medium-Light","Medium-Light","Light","Medium-Light","Medium-Light","Medium-Light","Medium","Medium-Light","Medium-Light","Medium-Light","Light","Medium-Light","Medium-Light","Light","Medium-Light","Medium-Light","Medium-Light","Medium-Light","Light","Medium-Light","Medium-Light","Medium-Light","Medium-Light","Medium-Light","Medium-Light","Medium-Light","Medium-Light","Medium-Light","Medium-Light","Medium-Light","Medium-Light","Medium-Light","Medium-Light","Medium","Medium-Light","Medium-Light","Medium-Light","Light","Medium-Light","Medium-Light","Medium","Medium-Light","Medium-Light","Medium-Light","Light","Medium-Light","Medium-Light","Medium-Light","Medium-Light","Medium-Light","Medium-Light","Light","Medium-Light","Medium-Light","Light","Medium-Light","Medium-Light","Medium-Light","Medium-Light","Light","Medium-Light","Light","Medium-Light","Medium-Light","Medium","Light","Light","Light","Medium-Light","Medium-Light","Light","Light","Medium-Light","Medium-Light","Medium-Light","Medium-Light","Medium-Light","Medium-Light","Medium-Light","Light","Medium-Light","Medium-Light","Light","Light","Medium-Light","Light","Medium-Light","Medium-Light","Medium-Light","Medium-Light","Medium-Light","Medium-Light","Light","Medium-Light","Medium-Light","Medium-Light","Light","Light","Medium","Light","Medium-Light","Light","Medium","Medium-Light","Medium-Light","Medium-Light","Medium-Light","Medium-Light","Light","Medium","Medium-Light","Medium-Light","Medium-Light","Medium-Light","Medium-Light","Medium-Light","Light","Medium-Light","Medium-Light","Light","Medium-Light","Medium-Light","Medium-Light","Medium-Light","Light","Light","Medium-Light","Medium-Light","Medium-Light","Medium-Light","Medium-Light","Medium","Medium-Light","Medium-Light","Medium-Light","Medium-Light","Medium-Light","Medium-Light","Medium-Light","Medium-Light","Medium-Light","Light","Medium-Light","Medium-Light","Medium-Light","Light","Medium-Light","Light","Medium-Light","Medium-Light","Medium-Light","Light","Medium-Light","Medium-Light","Medium-Light","Medium-Light","Medium-Light","Light","Medium-Light","Medium-Light","Medium-Light","Light","Medium-Light","Medium-Light","Light","Light","Medium-Light","Medium-Light","Medium-Light","Medium-Light","Medium-Light","Medium-Light","Medium","Medium-Light","Light","Medium-Light","Medium-Light","Light","Medium-Light","Medium-Light","Medium-Light","Light","Medium-Light","Medium-Light","Medium","Medium","Medium-Dark","Medium-Dark","Medium","Medium-Dark","Medium-Dark","Medium-Dark","Dark","Medium-Light","Medium-Light","Light","Medium-Light","Light","Medium","Medium-Light","Medium-Light","Medium-Light","Medium-Light","Medium-Light","Medium-Light","Medium","Medium-Light","Medium-Light","Medium-Light","Medium-Light","Light","Medium-Light","Medium-Light","Medium-Light","Medium-Light","Medium-Light","Medium-Light","Medium-Light","Medium-Light","Medium-Light","Medium-Light","Medium-Light","Medium-Light","Medium-Light","Medium-Light","Medium-Light","Medium-Light","Medium-Light","Medium-Light","Medium-Light","Medium-Light","Medium-Light","Medium-Light","Medium-Light","Medium-Light","Medium-Light","Medium-Light","Medium-Light","Medium-Light","Medium-Light","Medium-Light","Medium-Light","Medium-Light","Medium-Light","Medium-Light","Medium-Light","Medium-Light","Medium-Light","Medium-Light","Medium-Light","Medium-Light","Medium-Light","Medium-Light","Medium-Light","Medium-Light","Medium-Light","Medium-Light","Medium-Light","Medium-Light","Medium-Light","Medium-Light","Medium-Light","Medium-Light","Medium-Light","Light","Medium-Light","Medium-Light","Medium-Light","Light","Medium-Light","Medium-Light","Medium-Light","Medium-Light","Medium-Light","Medium-Light","Medium-Light","Medium-Light","Medium-Light","Medium","Medium-Light","Medium-Light","Light","Light","Medium-Light","Medium-Light","Medium-Light","Medium-Light","Light","Medium-Light","Light","Medium-Light","Medium-Light","Medium-Light","Medium-Light","Light","Medium-Light","Medium-Light","Medium-Light","Medium-Light","Medium-Light","Medium-Light","Medium-Light","Medium-Light","Medium-Light","Light","Light","Medium-Light","Medium-Light","Medium-Light","Medium-Light","Medium-Light","Light","Medium","Light","Light","Medium-Light","Medium-Light","Light","Light","Light","Light","Medium-Light","Medium-Light","Light","Light","Light","Medium-Light","Medium-Light","Medium-Light","Medium-Light","Medium-Light","Medium-Light","Light","Light","Medium-Light","Medium-Light","Medium-Light","Medium-Light","Medium-Light","Light","Medium-Light","Light","Light","Light","Light","Medium-Light","Medium-Light","Light","Medium-Light","Medium-Light","Light","Medium-Light","Medium","Light","Medium-Light","Medium-Light","Light","Light","Medium-Light","Medium-Light","Medium-Light","Medium-Light","Light","Medium-Light","Medium-Light","Medium","Medium-Light","Light","Medium-Light","Light","Medium-Light","Medium-Light","Medium-Light","Medium-Light","Medium-Light","Light","Medium-Light","Light","Medium-Light","Medium-Light","Medium-Light","Medium-Light","Medium-Light","Medium-Light"],"xaxis":"x","yaxis":"y","type":"histogram"}],                        {"template":{"data":{"histogram2dcontour":[{"type":"histogram2dcontour","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"choropleth":[{"type":"choropleth","colorbar":{"outlinewidth":0,"ticks":""}}],"histogram2d":[{"type":"histogram2d","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"heatmap":[{"type":"heatmap","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"heatmapgl":[{"type":"heatmapgl","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"contourcarpet":[{"type":"contourcarpet","colorbar":{"outlinewidth":0,"ticks":""}}],"contour":[{"type":"contour","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"surface":[{"type":"surface","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"mesh3d":[{"type":"mesh3d","colorbar":{"outlinewidth":0,"ticks":""}}],"scatter":[{"fillpattern":{"fillmode":"overlay","size":10,"solidity":0.2},"type":"scatter"}],"parcoords":[{"type":"parcoords","line":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scatterpolargl":[{"type":"scatterpolargl","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"bar":[{"error_x":{"color":"#2a3f5f"},"error_y":{"color":"#2a3f5f"},"marker":{"line":{"color":"#E5ECF6","width":0.5},"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"bar"}],"scattergeo":[{"type":"scattergeo","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scatterpolar":[{"type":"scatterpolar","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"histogram":[{"marker":{"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"histogram"}],"scattergl":[{"type":"scattergl","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scatter3d":[{"type":"scatter3d","line":{"colorbar":{"outlinewidth":0,"ticks":""}},"marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scattermapbox":[{"type":"scattermapbox","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scatterternary":[{"type":"scatterternary","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scattercarpet":[{"type":"scattercarpet","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"carpet":[{"aaxis":{"endlinecolor":"#2a3f5f","gridcolor":"white","linecolor":"white","minorgridcolor":"white","startlinecolor":"#2a3f5f"},"baxis":{"endlinecolor":"#2a3f5f","gridcolor":"white","linecolor":"white","minorgridcolor":"white","startlinecolor":"#2a3f5f"},"type":"carpet"}],"table":[{"cells":{"fill":{"color":"#EBF0F8"},"line":{"color":"white"}},"header":{"fill":{"color":"#C8D4E3"},"line":{"color":"white"}},"type":"table"}],"barpolar":[{"marker":{"line":{"color":"#E5ECF6","width":0.5},"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"barpolar"}],"pie":[{"automargin":true,"type":"pie"}]},"layout":{"autotypenumbers":"strict","colorway":["#636efa","#EF553B","#00cc96","#ab63fa","#FFA15A","#19d3f3","#FF6692","#B6E880","#FF97FF","#FECB52"],"font":{"color":"#2a3f5f"},"hovermode":"closest","hoverlabel":{"align":"left"},"paper_bgcolor":"white","plot_bgcolor":"#E5ECF6","polar":{"bgcolor":"#E5ECF6","angularaxis":{"gridcolor":"white","linecolor":"white","ticks":""},"radialaxis":{"gridcolor":"white","linecolor":"white","ticks":""}},"ternary":{"bgcolor":"#E5ECF6","aaxis":{"gridcolor":"white","linecolor":"white","ticks":""},"baxis":{"gridcolor":"white","linecolor":"white","ticks":""},"caxis":{"gridcolor":"white","linecolor":"white","ticks":""}},"coloraxis":{"colorbar":{"outlinewidth":0,"ticks":""}},"colorscale":{"sequential":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"sequentialminus":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"diverging":[[0,"#8e0152"],[0.1,"#c51b7d"],[0.2,"#de77ae"],[0.3,"#f1b6da"],[0.4,"#fde0ef"],[0.5,"#f7f7f7"],[0.6,"#e6f5d0"],[0.7,"#b8e186"],[0.8,"#7fbc41"],[0.9,"#4d9221"],[1,"#276419"]]},"xaxis":{"gridcolor":"white","linecolor":"white","ticks":"","title":{"standoff":15},"zerolinecolor":"white","automargin":true,"zerolinewidth":2},"yaxis":{"gridcolor":"white","linecolor":"white","ticks":"","title":{"standoff":15},"zerolinecolor":"white","automargin":true,"zerolinewidth":2},"scene":{"xaxis":{"backgroundcolor":"#E5ECF6","gridcolor":"white","linecolor":"white","showbackground":true,"ticks":"","zerolinecolor":"white","gridwidth":2},"yaxis":{"backgroundcolor":"#E5ECF6","gridcolor":"white","linecolor":"white","showbackground":true,"ticks":"","zerolinecolor":"white","gridwidth":2},"zaxis":{"backgroundcolor":"#E5ECF6","gridcolor":"white","linecolor":"white","showbackground":true,"ticks":"","zerolinecolor":"white","gridwidth":2}},"shapedefaults":{"line":{"color":"#2a3f5f"}},"annotationdefaults":{"arrowcolor":"#2a3f5f","arrowhead":0,"arrowwidth":1},"geo":{"bgcolor":"white","landcolor":"#E5ECF6","subunitcolor":"white","showland":true,"showlakes":true,"lakecolor":"white"},"title":{"x":0.05},"mapbox":{"style":"light"}}},"xaxis":{"anchor":"y","domain":[0.0,1.0],"title":{"text":"roast"},"categoryorder":"array","categoryarray":["Light","Medium-Light","Medium","Medium-Dark","Dark"]},"yaxis":{"anchor":"x","domain":[0.0,1.0],"title":{"text":"percent"}},"legend":{"tracegroupgap":0},"margin":{"t":60},"barmode":"relative"},                        {"responsive": true}                    )                };                            </script>        </div>

### Roaster country
Most of the data we have is from US rosters.

```python
df["roaster_country"].value_counts()
```

| roaster_country|     |
|----------------|-----|
| United States  |  774|
| Taiwan         |  339|
| Hawai'i        |   77|
| Guatemala      |   24|
| Hong Kong      |    9|
| Japan          |    8|
| England        |    7|
| Canada         |    5|
| Australia      |    1|
| China          |    1|
| Kenya          |    1|

If we look at the distribution of pricing for the most common countries, we see that the distribution is quite different in each country. In particular, the coffees sold in the US are much more "peaky". This likely indicates that there is some bias in the dataset. Given that CoffeeReview is based in the US, there are disproportionately more affordable coffees from US roasters.

> :warning: This strong bias towards coffees roasted in the US means that it is unclear how well our will apply to coffees roasted outside the US. In addition, the number of different countries present is very small, and we cannot for example, predict if coffees from German roasters would be more or less likely to be highly rated.


```python
import plotly.express as px

countries = ["United States", "Taiwan", "Guatemala"]
px.histogram(
    df[df["roaster_country"].apply(lambda c: c in countries)],
    x="price_per_100g",
    color="roaster_country",
    barmode="group",
    histnorm='percent',
)
```

<div>                        <script type="text/javascript">window.PlotlyConfig = {MathJaxConfig: 'local'};</script>
        <script charset="utf-8" src="https://cdn.plot.ly/plotly-2.24.1.min.js"></script>                <div id="e796131c-d16b-4770-8cb6-8e33f08eedc2" class="plotly-graph-div" style="height:100%; width:100%;"></div>            <script type="text/javascript">                                    window.PLOTLYENV=window.PLOTLYENV || {};                                    if (document.getElementById("e796131c-d16b-4770-8cb6-8e33f08eedc2")) {                    Plotly.newPlot(                        "e796131c-d16b-4770-8cb6-8e33f08eedc2",                        [{"alignmentgroup":"True","bingroup":"x","histnorm":"percent","hovertemplate":"roaster_country=United States\u003cbr\u003eprice_per_100g=%{x}\u003cbr\u003epercent=%{y}\u003cextra\u003e\u003c\u002fextra\u003e","legendgroup":"United States","marker":{"color":"#636efa","pattern":{"shape":""}},"name":"United States","offsetgroup":"United States","orientation":"v","showlegend":true,"x":[4.7,4.19,4.85,5.14,3.97,5.14,5.29,5.73,5.28,5.29,5.58,5.86,4.41,5.58,4.98,4.98,7.35,6.47,4.41,16.17,32.63,5.86,4.98,26.46,17.64,5.0,5.28,7.35,7.05,4.11,5.51,4.99,5.0,22.49,23.81,5.58,7.05,4.56,4.85,4.63,4.63,4.98,8.77,8.77,7.35,4.41,4.12,4.26,5.28,4.85,6.15,5.0,5.88,22.49,16.53,5.51,4.63,5.88,6.61,33.07,63.93,5.73,5.28,5.29,5.0,5.29,15.43,4.85,4.56,5.64,5.29,5.29,4.56,4.56,4.52,4.41,5.58,5.29,4.98,5.29,5.29,4.1,4.1,6.17,6.03,5.57,3.51,5.73,5.88,5.88,6.91,5.29,11.76,11.76,5.29,5.29,5.29,4.7,5.29,4.7,4.41,5.29,5.0,5.14,6.03,5.51,5.51,4.63,5.73,5.73,5.73,33.07,4.92,3.97,3.51,5.88,6.17,4.7,3.53,4.98,4.76,5.86,3.6,5.29,5.73,33.07,19.84,4.54,5.44,5.14,5.0,30.86,19.84,6.17,5.29,5.57,14.11,19.84,15.87,11.75,11.75,4.98,5.58,4.41,4.98,6.76,4.7,5.29,5.14,5.29,5.88,4.7,16.17,5.73,7.35,6.76,6.17,6.61,5.44,5.0,5.58,5.88,4.97,5.28,26.46,7.61,7.05,5.29,6.47,4.11,5.29,11.76,5.58,5.29,4.41,7.61,6.91,4.7,4.41,5.58,5.29,5.29,4.98,5.0,10.58,5.44,5.58,4.76,4.76,16.53,4.69,5.86,4.67,17.59,37.04,14.11,4.7,12.35,5.29,7.33,5.88,17.64,43.65,26.46,5.58,4.67,6.23,8.82,4.41,6.17,4.67,5.29,6.76,5.58,4.82,11.76,6.23,7.35,9.92,6.17,5.58,6.76,5.58,22.71,26.46,22.05,5.58,5.03,5.03,3.53,5.5,5.5,5.88,5.29,17.61,8.8,5.73,26.46,5.29,5.29,5.88,6.47,5.29,5.29,4.7,6.45,5.28,6.16,5.64,5.88,5.86,6.17,6.17,4.98,41.12,6.17,17.59,4.69,5.86,5.29,4.03,17.59,5.81,4.11,4.11,3.32,1.49,3.08,5.58,5.26,5.14,5.29,5.73,5.81,3.53,5.41,13.23,4.76,4.41,5.29,5.26,5.26,10.58,3.97,5.88,6.17,5.86,9.7,6.61,5.29,5.0,5.29,5.88,6.76,6.91,4.85,22.0,6.17,8.52,8.52,5.0,5.88,5.88,11.73,7.33,17.59,7.05,6.17,5.58,20.55,17.64,5.29,5.88,5.86,5.58,6.75,5.58,5.51,5.88,6.17,6.17,5.0,16.71,5.88,5.29,5.51,5.0,1.32,1.34,17.64,7.35,6.17,6.17,5.29,6.17,9.96,8.23,5.36,5.28,5.58,4.12,4.12,11.73,17.62,5.29,5.88,5.29,5.29,5.29,4.12,4.7,5.29,5.29,13.52,6.17,4.41,5.58,4.41,5.44,4.28,4.28,4.7,4.7,4.7,5.88,7.33,4.98,5.29,6.47,7.05,8.81,6.17,5.64,26.41,22.0,5.86,5.51,5.73,5.29,5.36,6.17,5.88,5.88,5.73,5.88,22.0,6.03,4.7,7.61,5.26,5.51,12.35,6.47,5.88,6.76,14.11,6.47,5.0,6.45,6.76,5.29,10.58,7.35,5.29,6.91,4.98,6.75,17.59,17.59,4.64,6.47,5.29,5.58,5.88,4.98,57.28,49.97,28.66,6.47,5.57,49.97,5.29,5.58,5.88,15.43,5.29,26.41,6.17,22.0,7.33,3.82,17.59,5.86,5.29,6.47,4.7,5.29,6.47,4.41,6.17,8.8,4.69,24.69,6.76,7.33,6.47,17.59,6.47,4.98,4.98,5.57,5.88,8.82,6.32,8.23,5.58,22.0,26.41,22.0,6.46,5.88,9.96,4.18,8.67,5.0,5.57,5.58,5.58,4.17,5.58,4.98,6.17,5.58,6.03,5.58,5.58,26.41,8.79,17.59,4.63,5.88,6.17,4.58,3.67,22.0,5.57,5.29,8.81,3.96,3.96,6.76,4.08,8.82,4.7,26.46,8.52,5.88,8.52,6.47,7.72,5.58,4.17,8.8,4.08,13.23,26.41,5.88,7.35,7.33,7.35,7.27,3.25,8.82,5.28,4.12,6.47,7.35,7.35,7.28,7.94,26.41,5.88,6.61,5.64,5.29,8.23,7.35,13.23,8.52,6.03,6.17,5.26,15.43,15.43,15.43,6.32,3.82,66.09,17.64,5.28,6.47,13.23,16.15,5.58,5.73,5.29,6.61,6.03,6.03,6.47,5.58,7.05,8.79,22.0,7.05,5.28,4.7,4.69,6.91,5.0,4.7,3.69,3.69,22.0,7.33,22.0,9.48,6.17,5.86,4.08,5.86,7.64,3.63,7.05,23.52,6.91,39.68,17.64,5.57,4.98,6.61,5.73,12.35,6.61,5.88,8.82,4.1,5.58,6.17,5.57,10.57,44.09,23.37,6.76,5.86,6.47,4.7,6.47,26.46,70.55,35.27,5.44,4.7,6.91,5.88,3.82,8.23,132.28,127.87,29.39,11.76,7.35,5.0,4.08,5.88,5.64,5.29,5.29,5.29,22.05,6.47,5.58,26.46,6.03,5.88,44.09,7.35,8.82,10.58,7.64,4.98,8.52,7.05,11.02,5.58,11.02,5.58,7.35,15.41,11.0,5.58,5.29,5.88,5.58,11.32,7.35,6.76,5.88,6.47,5.58,7.35,5.58,11.02,6.47,5.22,6.47,40.56,35.27,35.27,22.05,10.58,17.64,14.11,5.88,7.64,5.58,5.88,26.46,8.82,4.26,3.96,3.82,5.29,7.64,5.58,7.64,5.29,5.86,4.98,6.47,123.46,7.05,5.58,5.88,5.73,26.46,14.11,5.29,6.76,4.85,5.44,6.76,8.23,8.82,11.17,5.88,5.73,5.29,5.29,5.88,6.76,5.58,5.22,5.29,11.02,8.82,7.35,5.42,7.94,28.66,26.46,5.58,5.58,6.76,5.73,15.71,15.58,4.12,6.76,6.47,4.69,5.86,13.23,6.17,7.64,5.88,5.28,5.28,5.58,11.17,5.14,5.48,6.47,6.17,4.74,4.08,5.58,44.09,44.09,5.0,5.14,6.47,6.47,8.38,7.05,3.53,5.58,4.91,11.61,35.27,9.17,5.88,7.5,6.47,6.47,7.64,5.58,6.45,6.8,6.88,6.8,7.35,7.41,5.31,6.91,5.29,5.88,6.47,13.52,5.57,8.82,9.17,5.88,8.11],"xaxis":"x","yaxis":"y","type":"histogram"},{"alignmentgroup":"True","bingroup":"x","histnorm":"percent","hovertemplate":"roaster_country=Taiwan\u003cbr\u003eprice_per_100g=%{x}\u003cbr\u003epercent=%{y}\u003cextra\u003e\u003c\u002fextra\u003e","legendgroup":"Taiwan","marker":{"color":"#EF553B","pattern":{"shape":""}},"name":"Taiwan","offsetgroup":"Taiwan","orientation":"v","showlegend":true,"x":[4.6,3.89,8.44,17.7,90.83,90.83,9.2,4.25,4.6,3.92,6.51,12.74,4.93,13.45,4.96,6.83,8.88,5.66,5.92,3.19,8.5,9.16,9.24,5.31,5.66,3.68,21.24,6.02,5.64,3.89,5.36,8.21,3.89,9.91,10.62,5.31,9.6,8.0,20.53,7.08,11.02,7.94,7.05,4.25,4.11,4.25,5.66,6.4,6.61,6.8,4.6,15.58,4.96,8.38,21.6,17.07,8.53,9.39,5.1,2.55,3.68,2.83,2.56,13.23,90.83,3.19,4.96,3.68,3.89,16.7,6.34,4.25,21.24,38.4,4.96,4.6,3.54,3.54,2.83,8.5,25.6,19.2,3.2,6.4,15.58,9.12,8.0,6.4,4.8,4.25,4.25,4.25,8.8,16.0,8.0,6.61,32.0,32.0,32.0,8.53,32.0,45.31,6.23,9.6,4.6,8.48,4.25,4.25,8.46,9.28,6.37,3.19,11.33,4.27,3.89,5.77,5.66,5.82,8.5,5.66,4.11,5.82,7.05,2.83,7.08,9.74,3.54,8.0,7.65,80.0,3.89,10.57,7.82,6.34,4.6,8.0,5.66,12.74,12.79,13.67,7.35,7.35,16.99,4.6,1.98,9.6,6.34,6.4,33.98,90.83,90.83,15.58,15.58,17.56,6.63,6.37,4.25,5.31,4.96,4.25,9.6,8.32,28.8,36.81,8.44,4.81,4.39,5.38,4.39,8.78,8.35,4.41,5.24,3.55,7.2,9.24,5.64,5.82,7.08,2.97,5.31,5.12,2.97,4.98,6.34,3.52,4.41,5.66,8.53,7.89,9.2,7.11,4.6,8.0,8.8,6.4,7.05,5.88,4.11,19.82,4.6,10.67,13.87,9.6,4.0,5.31,5.81,8.96,7.05,6.34,7.05,9.59,6.68,4.93,21.38,4.53,3.67,9.16,4.16,4.16,20.22,3.17,21.52,3.17,5.66,3.89,5.31,8.5,4.6,12.04,3.52,5.64,12.52,7.04,10.67,3.19,3.96,10.62,16.0,16.28,5.31,7.08,7.79,12.04,10.4,8.8,11.33,2.97,13.45,5.64,4.93,7.05,6.68,6.37,6.37,5.26,4.25,4.67,2.26,4.96,5.1,8.21,10.57,25.6,115.2,6.98,11.33,8.8,4.93,4.93,5.64,4.93,4.93,5.66,4.81,7.75,6.34,6.34,19.84,6.55,5.66,4.6,4.6,16.0,5.1,4.94,11.17,4.94,3.39,9.6,9.6,14.08,10.08,15.58,6.34,6.34,8.0,8.46,2.36,7.05,5.65,6.07,2.83,4.4,8.46,10.43,6.37,7.08,5.52,8.5,9.91,3.4,4.96,7.33,8.8,8.8,5.66,4.6,7.2,8.0,7.2,7.33,9.46,6.51,7.05,3.89,11.95,9.6,16.0,8.32,9.04,9.91,1.36,8.82,4.41,14.16,8.8,6.08,7.04],"xaxis":"x","yaxis":"y","type":"histogram"},{"alignmentgroup":"True","bingroup":"x","histnorm":"percent","hovertemplate":"roaster_country=Guatemala\u003cbr\u003eprice_per_100g=%{x}\u003cbr\u003epercent=%{y}\u003cextra\u003e\u003c\u002fextra\u003e","legendgroup":"Guatemala","marker":{"color":"#00cc96","pattern":{"shape":""}},"name":"Guatemala","offsetgroup":"Guatemala","orientation":"v","showlegend":true,"x":[3.82,4.85,4.85,4.85,2.94,1.47,1.47,3.82,2.94,3.82,4.85,1.47,4.85,4.85,3.82,1.47,4.85,1.47,1.47,4.7,2.94,2.94,4.7,5.88],"xaxis":"x","yaxis":"y","type":"histogram"}],                        {"template":{"data":{"histogram2dcontour":[{"type":"histogram2dcontour","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"choropleth":[{"type":"choropleth","colorbar":{"outlinewidth":0,"ticks":""}}],"histogram2d":[{"type":"histogram2d","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"heatmap":[{"type":"heatmap","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"heatmapgl":[{"type":"heatmapgl","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"contourcarpet":[{"type":"contourcarpet","colorbar":{"outlinewidth":0,"ticks":""}}],"contour":[{"type":"contour","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"surface":[{"type":"surface","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"mesh3d":[{"type":"mesh3d","colorbar":{"outlinewidth":0,"ticks":""}}],"scatter":[{"fillpattern":{"fillmode":"overlay","size":10,"solidity":0.2},"type":"scatter"}],"parcoords":[{"type":"parcoords","line":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scatterpolargl":[{"type":"scatterpolargl","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"bar":[{"error_x":{"color":"#2a3f5f"},"error_y":{"color":"#2a3f5f"},"marker":{"line":{"color":"#E5ECF6","width":0.5},"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"bar"}],"scattergeo":[{"type":"scattergeo","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scatterpolar":[{"type":"scatterpolar","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"histogram":[{"marker":{"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"histogram"}],"scattergl":[{"type":"scattergl","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scatter3d":[{"type":"scatter3d","line":{"colorbar":{"outlinewidth":0,"ticks":""}},"marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scattermapbox":[{"type":"scattermapbox","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scatterternary":[{"type":"scatterternary","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scattercarpet":[{"type":"scattercarpet","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"carpet":[{"aaxis":{"endlinecolor":"#2a3f5f","gridcolor":"white","linecolor":"white","minorgridcolor":"white","startlinecolor":"#2a3f5f"},"baxis":{"endlinecolor":"#2a3f5f","gridcolor":"white","linecolor":"white","minorgridcolor":"white","startlinecolor":"#2a3f5f"},"type":"carpet"}],"table":[{"cells":{"fill":{"color":"#EBF0F8"},"line":{"color":"white"}},"header":{"fill":{"color":"#C8D4E3"},"line":{"color":"white"}},"type":"table"}],"barpolar":[{"marker":{"line":{"color":"#E5ECF6","width":0.5},"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"barpolar"}],"pie":[{"automargin":true,"type":"pie"}]},"layout":{"autotypenumbers":"strict","colorway":["#636efa","#EF553B","#00cc96","#ab63fa","#FFA15A","#19d3f3","#FF6692","#B6E880","#FF97FF","#FECB52"],"font":{"color":"#2a3f5f"},"hovermode":"closest","hoverlabel":{"align":"left"},"paper_bgcolor":"white","plot_bgcolor":"#E5ECF6","polar":{"bgcolor":"#E5ECF6","angularaxis":{"gridcolor":"white","linecolor":"white","ticks":""},"radialaxis":{"gridcolor":"white","linecolor":"white","ticks":""}},"ternary":{"bgcolor":"#E5ECF6","aaxis":{"gridcolor":"white","linecolor":"white","ticks":""},"baxis":{"gridcolor":"white","linecolor":"white","ticks":""},"caxis":{"gridcolor":"white","linecolor":"white","ticks":""}},"coloraxis":{"colorbar":{"outlinewidth":0,"ticks":""}},"colorscale":{"sequential":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"sequentialminus":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"diverging":[[0,"#8e0152"],[0.1,"#c51b7d"],[0.2,"#de77ae"],[0.3,"#f1b6da"],[0.4,"#fde0ef"],[0.5,"#f7f7f7"],[0.6,"#e6f5d0"],[0.7,"#b8e186"],[0.8,"#7fbc41"],[0.9,"#4d9221"],[1,"#276419"]]},"xaxis":{"gridcolor":"white","linecolor":"white","ticks":"","title":{"standoff":15},"zerolinecolor":"white","automargin":true,"zerolinewidth":2},"yaxis":{"gridcolor":"white","linecolor":"white","ticks":"","title":{"standoff":15},"zerolinecolor":"white","automargin":true,"zerolinewidth":2},"scene":{"xaxis":{"backgroundcolor":"#E5ECF6","gridcolor":"white","linecolor":"white","showbackground":true,"ticks":"","zerolinecolor":"white","gridwidth":2},"yaxis":{"backgroundcolor":"#E5ECF6","gridcolor":"white","linecolor":"white","showbackground":true,"ticks":"","zerolinecolor":"white","gridwidth":2},"zaxis":{"backgroundcolor":"#E5ECF6","gridcolor":"white","linecolor":"white","showbackground":true,"ticks":"","zerolinecolor":"white","gridwidth":2}},"shapedefaults":{"line":{"color":"#2a3f5f"}},"annotationdefaults":{"arrowcolor":"#2a3f5f","arrowhead":0,"arrowwidth":1},"geo":{"bgcolor":"white","landcolor":"#E5ECF6","subunitcolor":"white","showland":true,"showlakes":true,"lakecolor":"white"},"title":{"x":0.05},"mapbox":{"style":"light"}}},"xaxis":{"anchor":"y","domain":[0.0,1.0],"title":{"text":"price_per_100g"}},"yaxis":{"anchor":"x","domain":[0.0,1.0],"title":{"text":"percent"}},"legend":{"title":{"text":"roaster_country"},"tracegroupgap":0},"margin":{"t":60},"barmode":"group"},                        {"responsive": true}                    )                };                            </script>        </div>

### Country of origin
We will now examine the country of origin for the different coffees:

```python
df["country_of_origin"].hist(histnorm='percent')
```

<div>                        <script type="text/javascript">window.PlotlyConfig = {MathJaxConfig: 'local'};</script>
        <script charset="utf-8" src="https://cdn.plot.ly/plotly-2.24.1.min.js"></script>                <div id="89bb5b45-ae2b-4fea-bf1f-4438127f4371" class="plotly-graph-div" style="height:100%; width:100%;"></div>            <script type="text/javascript">                                    window.PLOTLYENV=window.PLOTLYENV || {};                                    if (document.getElementById("89bb5b45-ae2b-4fea-bf1f-4438127f4371")) {                    Plotly.newPlot(                        "89bb5b45-ae2b-4fea-bf1f-4438127f4371",                        [{"alignmentgroup":"True","bingroup":"x","histnorm":"percent","hovertemplate":"variable=country_of_origin\u003cbr\u003evalue=%{x}\u003cbr\u003epercent=%{y}\u003cextra\u003e\u003c\u002fextra\u003e","legendgroup":"country_of_origin","marker":{"color":"#636efa","pattern":{"shape":""}},"name":"country_of_origin","offsetgroup":"country_of_origin","orientation":"v","showlegend":true,"x":["Ethiopia","Ethiopia","Ethiopia","Ethiopia","Ethiopia","Ethiopia","Ethiopia","Ethiopia","Ethiopia","Ethiopia","Ethiopia","Ethiopia","Hawai'I","Kenya","Kenya","Ethiopia","Kenya","Guatemala","Kenya","Ethiopia","Ethiopia","Ethiopia","Colombia","Ethiopia","Kenya","Kenya","Ethiopia","Panama","Panama","Hawai'I","Kenya","Colombia","Hawai'I","Ethiopia","Panama","Panama","Hawai'I","Guatemala","Nicaragua","Kenya","Kenya","Ethiopia","Ethiopia","Ethiopia","Ethiopia","Hawai'I","Ethiopia","Colombia","Panama","Indonesia","Panama","Ethiopia","Ethiopia","Ethiopia","Kenya","Ethiopia","Ethiopia","Peru","Guatemala","Colombia","Rwanda","Ethiopia","Nepal","Costa Rica","Ethiopia","Kenya","Ethiopia","Ethiopia","Rwanda","Hawai'I","Ethiopia","Ethiopia","Ecuador","Kenya","Ethiopia","Colombia","Ethiopia","Colombia","Ethiopia","Colombia","Panama","Ethiopia","Panama","Indonesia","Brazil","Ethiopia","Panama","Panama","Ethiopia","Kenya","Hawai'I","Ethiopia","Hawai'I","Ethiopia","Democratic Republic Of The Congo","Kenya","Kenya","Colombia","Colombia","Kenya","Brazil","Brazil","Brazil","Brazil","Brazil","Brazil","Brazil","Ethiopia","Burundi","Rwanda","Burundi","Burundi","Burundi","Burundi","Ethiopia","Ethiopia","Ethiopia","Costa Rica","Ethiopia","Ethiopia","Costa Rica","Ethiopia","Guatemala","Peru","Peru","Kenya","Costa Rica","Kenya","Ethiopia","Guatemala","Ethiopia","Ethiopia","Panama","Guatemala","Kenya","Guatemala","Colombia","Colombia","Costa Rica","Kenya","Indonesia","Ethiopia","Ethiopia","Guatemala","Ethiopia","Ethiopia","Ethiopia","Ethiopia","Guatemala","Ethiopia","Ethiopia","Ethiopia","Kenya","Ethiopia","Ethiopia","Colombia","Kenya","Kenya","Kenya","Panama","Kenya","Ethiopia","Kenya","Kenya","Kenya","Ethiopia","Colombia","Ethiopia","Kenya","Kenya","Ethiopia","Ethiopia","Kenya","Guatemala","Ethiopia","Kenya","Panama","Panama","Colombia","Colombia","Guatemala","Kenya","Ethiopia","Guatemala","Panama","Costa Rica","Guatemala","Guatemala","Guatemala","Guatemala","Guatemala","Nicaragua","Ethiopia","Colombia","Panama","Panama","Panama","Panama","Ethiopia","Ethiopia","Colombia","Colombia","Ethiopia","Hawai'I","Ethiopia","Kenya","Ethiopia","Guatemala","Ethiopia","Kenya","Indonesia","Kenya","Ethiopia","Ethiopia","Panama","Ethiopia","El Salvador","Ethiopia","Ethiopia","Ethiopia","Hawai'I","Ethiopia","Ethiopia","Ethiopia","Ethiopia","Kenya","Ethiopia","Democratic Republic Of The Congo","Ethiopia","Panama","Colombia","Colombia","Rwanda","Ethiopia","Kenya","Colombia","Ethiopia","Ethiopia","Ethiopia","Ethiopia","Ethiopia","Ethiopia","Ecuador","Ecuador","Ethiopia","Hawai'I","Hawai'I","Rwanda","Kenya","Ethiopia","Ethiopia","Kenya","Indonesia","Indonesia","Ethiopia","Panama","Kenya","Rwanda","Hawai'I","Democratic Republic Of The Congo","Ethiopia","Rwanda","Rwanda","Ethiopia","Colombia","Colombia","Indonesia","Indonesia","Colombia","Hawai'I","Hawai'I","Hawai'I","Hawai'I","Hawai'I","Hawai'I","Hawai'I","Colombia","Colombia","Ethiopia","Yemen","Ethiopia","Ethiopia","Colombia","Colombia","Kenya","Hawai'I","Guatemala","Panama","Colombia","Colombia","Colombia","Kenya","Colombia","Ethiopia","Peru","Guatemala","Peru","Guatemala","Ethiopia","Kenya","Kenya","Hawai'I","Ethiopia","Ethiopia","Ethiopia","Ethiopia","Ethiopia","Kenya","Kenya","Kenya","Ethiopia","Ethiopia","El Salvador","El Salvador","El Salvador","Ethiopia","Ethiopia","Ethiopia","Guatemala","Kenya","Guatemala","Ethiopia","Panama","Panama","Ethiopia","Ethiopia","Ethiopia","Ethiopia","Ethiopia","Panama","Kenya","Kenya","Ethiopia","Ethiopia","Ethiopia","Ethiopia","Ethiopia","Guatemala","Guatemala","Guatemala","Colombia","Indonesia","Ethiopia","Colombia","Costa Rica","Costa Rica","Colombia","Ethiopia","Ethiopia","Kenya","Colombia","Panama","Nicaragua","Ethiopia","Panama","Ethiopia","Ethiopia","Kenya","Ethiopia","Kenya","Ethiopia","Costa Rica","Kenya","Ethiopia","Kenya","Ethiopia","Guatemala","Ethiopia","Guatemala","Ethiopia","Panama","Kenya","Kenya","Ethiopia","Ethiopia","Hawai'I","Costa Rica","Ethiopia","Ethiopia","Costa Rica","Ethiopia","Ethiopia","Ethiopia","Panama","Ethiopia","Colombia","Kenya","Colombia","Guatemala","Kenya","El Salvador","Ethiopia","Ethiopia","Ethiopia","Colombia","Indonesia","Hawai'I","Panama","Ethiopia","Guatemala","Ethiopia","Ethiopia","Ethiopia","Ethiopia","Ethiopia","Kenya","Ethiopia","Panama","Peru","Ethiopia","Kenya","Ethiopia","Ethiopia","Democratic Republic Of The Congo","Democratic Republic Of The Congo","Hawai'I","Costa Rica","Panama","Hawai'I","Hawai'I","Hawai'I","Ethiopia","Hawai'I","Ethiopia","Ethiopia","Ethiopia","Ethiopia","Ethiopia","Ethiopia","Costa Rica","Colombia","Kenya","Colombia","Hawai'I","Burundi","Colombia","Colombia","Ethiopia","Ethiopia","Democratic Republic Of The Congo","Ethiopia","Ethiopia","Colombia","Colombia","Hawai'I","Nepal","Hawai'I","Ethiopia","Ethiopia","Hawai'I","Panama","Colombia","Ethiopia","Ethiopia","Democratic Republic Of The Congo","Colombia","Colombia","Ethiopia","Hawai'I","Hawai'I","Hawai'I","Ethiopia","Guatemala","Hawai'I","Kenya","Colombia","Ethiopia","Hawai'I","Hawai'I","Bolivia","Ethiopia","Indonesia","Colombia","Hawai'I","Ethiopia","Indonesia","Guatemala","Taiwan","Ethiopia","Guatemala","Panama","Ethiopia","Ethiopia","Brazil","Colombia","Ethiopia","Hawai'I","Kenya","Kenya","Colombia","Colombia","El Salvador","Colombia","Ethiopia","Ethiopia","El Salvador","Guatemala","Ethiopia","Ethiopia","Nicaragua","Colombia","Ethiopia","Ethiopia","Ethiopia","Kenya","Ethiopia","Ethiopia","Ethiopia","Ethiopia","Ethiopia","Ethiopia","Ethiopia","Ethiopia","Indonesia","Colombia","Kenya","Ethiopia","Ethiopia","Peru","Ethiopia","Indonesia","Mexico","Ethiopia","Ethiopia","Ethiopia","Kenya","Ethiopia","Ethiopia","Guatemala","Costa Rica","Hawai'I","Guatemala","Ethiopia","Costa Rica","Ethiopia","Costa Rica","Ethiopia","Kenya","Colombia","Kenya","Costa Rica","Hawai'I","Hawai'I","Ethiopia","Ethiopia","Indonesia","Nicaragua","El Salvador","Guatemala","Guatemala","Guatemala","Ethiopia","Ethiopia","Ethiopia","Ethiopia","Hawai'I","Hawai'I","Hawai'I","Ethiopia","Colombia","Ethiopia","Panama","Nicaragua","Hawai'I","Ethiopia","Costa Rica","Ethiopia","Colombia","Ethiopia","Mexico","Colombia","Colombia","Kenya","Kenya","Kenya","Kenya","Kenya","Kenya","Kenya","Kenya","Kenya","Kenya","Kenya","Guatemala","Guatemala","Guatemala","Guatemala","Guatemala","Guatemala","Guatemala","Ethiopia","Costa Rica","Ethiopia","Ethiopia","Kenya","Ethiopia","Costa Rica","Guatemala","Hawai'I","Colombia","Colombia","Kenya","Ethiopia","Ethiopia","Ethiopia","Kenya","Panama","Colombia","Taiwan","Panama","Panama","Kenya","Ethiopia","Ethiopia","Ethiopia","Ethiopia","Panama","Hawai'I","Hawai'I","Hawai'I","Ethiopia","Colombia","Ethiopia","Colombia","Ethiopia","Ethiopia","Ethiopia","Ethiopia","Hawai'I","Hawai'I","Ethiopia","Democratic Republic Of The Congo","Ethiopia","Kenya","Hawai'I","Ethiopia","Hawai'I","Hawai'I","Dominican Republic","Guatemala","Hawai'I","Hawai'I","Hawai'I","Hawai'I","Panama","Ethiopia","Guatemala","Burundi","Mexico","Honduras","Kenya","Ethiopia","Ethiopia","Ethiopia","Taiwan","Colombia","Ethiopia","Guatemala","Guatemala","Guatemala","Colombia","Costa Rica","Ethiopia","Ethiopia","Hawai'I","Panama","Ethiopia","Ethiopia","Peru","Hawai'I","Ethiopia","Ethiopia","Hawai'I","Thailand","Kenya","Thailand","Ethiopia","Ethiopia","Ethiopia","Taiwan","Ethiopia","Colombia","Colombia","Colombia","Colombia","Ethiopia","Ethiopia","Ethiopia","Hawai'I","Ethiopia","Kenya","Costa Rica","Hawai'I","Hawai'I","Guatemala","Ethiopia","Ethiopia","Rwanda","Colombia","Colombia","Colombia","Colombia","Colombia","Guatemala","Guatemala","Indonesia","Ethiopia","Colombia","Ethiopia","Indonesia","Ethiopia","Ethiopia","Guatemala","Ethiopia","Costa Rica","Colombia","Kenya","Democratic Republic Of The Congo","Kenya","Ethiopia","Peru","Colombia","Hawai'I","Colombia","Hawai'I","Colombia","Ethiopia","Democratic Republic Of The Congo","Ethiopia","Ethiopia","Colombia","Ethiopia","Yemen","Democratic Republic Of The Congo","Panama","Ethiopia","Colombia","Colombia","Colombia","Ethiopia","Ethiopia","Guatemala","Ethiopia","Hawai'I","Panama","Hawai'I","Panama","Hawai'I","Hawai'I","Hawai'I","Uganda","Kenya","Ethiopia","Ethiopia","Ethiopia","Ethiopia","Colombia","Kenya","Hawai'I","Yemen","Colombia","Colombia","Ethiopia","Costa Rica","Kenya","Colombia","Ethiopia","Panama","Ethiopia","Ethiopia","Ethiopia","Ethiopia","Hawai'I","Colombia","Ethiopia","Ethiopia","Colombia","Ethiopia","Ethiopia","Colombia","Panama","Ethiopia","Panama","Ethiopia","Colombia","Kenya","Ethiopia","Kenya","Ethiopia","Ethiopia","Kenya","Ethiopia","Colombia","Colombia","Colombia","Mexico","Nicaragua","Ethiopia","Ethiopia","Democratic Republic Of The Congo","Burundi","Rwanda","Burundi","Ethiopia","Taiwan","Ethiopia","Ethiopia","Colombia","Colombia","Colombia","Ethiopia","Hawai'I","Ecuador","Colombia","Kenya","Ecuador","Indonesia","Yemen","Costa Rica","Brazil","Yemen","Yemen","Brazil","Ethiopia","Ethiopia","Ethiopia","Panama","Ethiopia","Ethiopia","Colombia","Yemen","Kenya","Ethiopia","Ethiopia","Dominican Republic","Tanzania","Panama","Nicaragua","Ethiopia","Ethiopia","Ethiopia","Ethiopia","Colombia","Ethiopia","Colombia","Indonesia","Ethiopia","Guatemala","Ethiopia","Guatemala","Kenya","Guatemala","Guatemala","Colombia","Panama","Bolivia","Kenya","Nicaragua","Hawai'I","Kenya","El Salvador","Ethiopia","Democratic Republic Of The Congo","Mexico","Guatemala","Mexico","Kenya","Kenya","Colombia","Colombia","Taiwan","Ethiopia","Panama","Ethiopia","Hawai'I","Costa Rica","Kenya","Ethiopia","Kenya","Ethiopia","Ethiopia","Brazil","Ethiopia","Kenya","Panama","Kenya","Yemen","Yemen","Yemen","Yemen","Colombia","Honduras","Ethiopia","Ethiopia","Hawai'I","Hawai'I","Ethiopia","Guatemala","Guatemala","Ethiopia","Kenya","Ethiopia","Kenya","Colombia","Ethiopia","Panama","Ethiopia","Ethiopia","Panama","Ethiopia","Ethiopia","Ethiopia","El Salvador","Ethiopia","Colombia","Hawai'I","Ethiopia","Kenya","Guatemala","Ethiopia","Hawai'I","Ethiopia","Hawai'I","Colombia","Colombia","Ethiopia","Ethiopia","Ethiopia","Guatemala","Colombia","Tanzania","Colombia","Guatemala","Ethiopia","Hawai'I","Hawai'I","Ethiopia","Kenya","Ethiopia","Honduras","Colombia","Ethiopia","Hawai'I","Panama","Ethiopia","Panama","Hawai'I","Ethiopia","Philippines","Ethiopia","Hawai'I","Ethiopia","Ethiopia","Ethiopia","Ethiopia","Guatemala","Kenya","Guatemala","Guatemala","Guatemala","Guatemala","Guatemala","Guatemala","Guatemala","Guatemala","Panama","Ethiopia","Ethiopia","Kenya","Ethiopia","Ethiopia","Ethiopia","Hawai'I","Kenya","Ethiopia","Hawai'I","Ethiopia","Ethiopia","Panama","Ethiopia","Yemen","Guatemala","Costa Rica","Kenya","Colombia","Ethiopia","Ethiopia","Panama","Ethiopia","Ethiopia","Ethiopia","Costa Rica","Ethiopia","Hawai'I","Colombia","Colombia","Guatemala","Ethiopia","Uganda","Ethiopia","Ethiopia","Ethiopia","Hawai'I","Ethiopia","Indonesia","Costa Rica","Ethiopia","Ethiopia","Colombia","Costa Rica","Kenya","Hawai'I","Guatemala","Ethiopia","Ethiopia","Panama","Ethiopia","Ethiopia","Indonesia","Ethiopia","Hawai'I","Colombia","Yemen","El Salvador","Ethiopia","Guatemala","Colombia","Colombia","Hawai'I","Hawai'I","Hawai'I","Honduras","Hawai'I","Hawai'I","Hawai'I","Ethiopia","Colombia","Ethiopia","Ethiopia","Ethiopia","Ethiopia","Ethiopia","Kenya","Honduras","Kenya","Hawai'I","Panama","Hawai'I","Ecuador","Indonesia","Hawai'I","Indonesia","Kenya","Kenya","Indonesia","Taiwan","Ethiopia","Ethiopia","Ethiopia","Colombia","Mexico","Costa Rica","Guatemala","Kenya","Burundi","Ecuador","Indonesia","Kenya","Democratic Republic Of The Congo","Kenya","Ethiopia","Hawai'I","Colombia","Ethiopia","Ethiopia","Costa Rica","Ethiopia","Guatemala","Guatemala","Costa Rica","Kenya","Honduras","Rwanda","Ethiopia","Brazil","Brazil","Costa Rica","Colombia","Colombia","Colombia","Ethiopia","Ethiopia","Colombia","Colombia","Nicaragua","Colombia","Ethiopia","Kenya","Kenya","Kenya","Ethiopia","Ethiopia","Ethiopia","Ethiopia","Ethiopia","Ethiopia","Colombia","Colombia","Colombia","Ethiopia","Ethiopia","Hawai'I","Colombia","Panama","Hawai'I","Ethiopia","Costa Rica","Costa Rica","Ethiopia","Colombia","Kenya","Philippines","Costa Rica","Ethiopia","Mexico","Kenya","Ethiopia","Ethiopia","Colombia","Panama","Panama","Panama","Costa Rica","Costa Rica","Burundi","Colombia","Burundi","Ethiopia","Costa Rica","Taiwan","Peru","Brazil","Ethiopia","Colombia","Ethiopia","Ethiopia","Rwanda","El Salvador","Ethiopia","Ethiopia","Indonesia","Indonesia","Colombia","Ethiopia","Panama","Panama","Ethiopia","Panama","Peru","Guatemala","Hawai'I","Nicaragua","Ethiopia","Ethiopia","Colombia","Indonesia","Ethiopia","Ethiopia","Ethiopia","Ethiopia","Mexico","Mexico","Colombia","Colombia","Hawai'I","Colombia","Ethiopia","Ethiopia","Kenya","Kenya","Ecuador","Kenya","Hawai'I","Hawai'I","Kenya","Ethiopia","Ethiopia","Ethiopia","Guatemala","Guatemala","Guatemala","Mexico","Peru","Colombia","Ethiopia","Ethiopia","Ethiopia","Kenya","Kenya","Hawai'I","Kenya","Ethiopia","Kenya","Ethiopia","Ethiopia","Ethiopia","Ethiopia","Colombia","Kenya","Ethiopia","Kenya","Kenya","Costa Rica","Ethiopia","Ethiopia","Ethiopia","Kenya","Ethiopia","Ethiopia","Colombia","Costa Rica","Costa Rica","Colombia","Costa Rica","Colombia","Taiwan","Guatemala","Guatemala","Guatemala","Ethiopia","Guatemala","Colombia","Hawai'I","Costa Rica","Peru","El Salvador","El Salvador","Panama","Costa Rica","Colombia","Ethiopia","Guatemala","Guatemala","Guatemala","Guatemala","Guatemala"],"xaxis":"x","yaxis":"y","type":"histogram"}],                        {"template":{"data":{"histogram2dcontour":[{"type":"histogram2dcontour","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"choropleth":[{"type":"choropleth","colorbar":{"outlinewidth":0,"ticks":""}}],"histogram2d":[{"type":"histogram2d","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"heatmap":[{"type":"heatmap","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"heatmapgl":[{"type":"heatmapgl","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"contourcarpet":[{"type":"contourcarpet","colorbar":{"outlinewidth":0,"ticks":""}}],"contour":[{"type":"contour","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"surface":[{"type":"surface","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"mesh3d":[{"type":"mesh3d","colorbar":{"outlinewidth":0,"ticks":""}}],"scatter":[{"fillpattern":{"fillmode":"overlay","size":10,"solidity":0.2},"type":"scatter"}],"parcoords":[{"type":"parcoords","line":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scatterpolargl":[{"type":"scatterpolargl","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"bar":[{"error_x":{"color":"#2a3f5f"},"error_y":{"color":"#2a3f5f"},"marker":{"line":{"color":"#E5ECF6","width":0.5},"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"bar"}],"scattergeo":[{"type":"scattergeo","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scatterpolar":[{"type":"scatterpolar","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"histogram":[{"marker":{"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"histogram"}],"scattergl":[{"type":"scattergl","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scatter3d":[{"type":"scatter3d","line":{"colorbar":{"outlinewidth":0,"ticks":""}},"marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scattermapbox":[{"type":"scattermapbox","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scatterternary":[{"type":"scatterternary","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scattercarpet":[{"type":"scattercarpet","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"carpet":[{"aaxis":{"endlinecolor":"#2a3f5f","gridcolor":"white","linecolor":"white","minorgridcolor":"white","startlinecolor":"#2a3f5f"},"baxis":{"endlinecolor":"#2a3f5f","gridcolor":"white","linecolor":"white","minorgridcolor":"white","startlinecolor":"#2a3f5f"},"type":"carpet"}],"table":[{"cells":{"fill":{"color":"#EBF0F8"},"line":{"color":"white"}},"header":{"fill":{"color":"#C8D4E3"},"line":{"color":"white"}},"type":"table"}],"barpolar":[{"marker":{"line":{"color":"#E5ECF6","width":0.5},"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"barpolar"}],"pie":[{"automargin":true,"type":"pie"}]},"layout":{"autotypenumbers":"strict","colorway":["#636efa","#EF553B","#00cc96","#ab63fa","#FFA15A","#19d3f3","#FF6692","#B6E880","#FF97FF","#FECB52"],"font":{"color":"#2a3f5f"},"hovermode":"closest","hoverlabel":{"align":"left"},"paper_bgcolor":"white","plot_bgcolor":"#E5ECF6","polar":{"bgcolor":"#E5ECF6","angularaxis":{"gridcolor":"white","linecolor":"white","ticks":""},"radialaxis":{"gridcolor":"white","linecolor":"white","ticks":""}},"ternary":{"bgcolor":"#E5ECF6","aaxis":{"gridcolor":"white","linecolor":"white","ticks":""},"baxis":{"gridcolor":"white","linecolor":"white","ticks":""},"caxis":{"gridcolor":"white","linecolor":"white","ticks":""}},"coloraxis":{"colorbar":{"outlinewidth":0,"ticks":""}},"colorscale":{"sequential":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"sequentialminus":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"diverging":[[0,"#8e0152"],[0.1,"#c51b7d"],[0.2,"#de77ae"],[0.3,"#f1b6da"],[0.4,"#fde0ef"],[0.5,"#f7f7f7"],[0.6,"#e6f5d0"],[0.7,"#b8e186"],[0.8,"#7fbc41"],[0.9,"#4d9221"],[1,"#276419"]]},"xaxis":{"gridcolor":"white","linecolor":"white","ticks":"","title":{"standoff":15},"zerolinecolor":"white","automargin":true,"zerolinewidth":2},"yaxis":{"gridcolor":"white","linecolor":"white","ticks":"","title":{"standoff":15},"zerolinecolor":"white","automargin":true,"zerolinewidth":2},"scene":{"xaxis":{"backgroundcolor":"#E5ECF6","gridcolor":"white","linecolor":"white","showbackground":true,"ticks":"","zerolinecolor":"white","gridwidth":2},"yaxis":{"backgroundcolor":"#E5ECF6","gridcolor":"white","linecolor":"white","showbackground":true,"ticks":"","zerolinecolor":"white","gridwidth":2},"zaxis":{"backgroundcolor":"#E5ECF6","gridcolor":"white","linecolor":"white","showbackground":true,"ticks":"","zerolinecolor":"white","gridwidth":2}},"shapedefaults":{"line":{"color":"#2a3f5f"}},"annotationdefaults":{"arrowcolor":"#2a3f5f","arrowhead":0,"arrowwidth":1},"geo":{"bgcolor":"white","landcolor":"#E5ECF6","subunitcolor":"white","showland":true,"showlakes":true,"lakecolor":"white"},"title":{"x":0.05},"mapbox":{"style":"light"}}},"xaxis":{"anchor":"y","domain":[0.0,1.0],"title":{"text":"value"}},"yaxis":{"anchor":"x","domain":[0.0,1.0],"title":{"text":"percent"}},"legend":{"title":{"text":"variable"},"tracegroupgap":0},"margin":{"t":60},"barmode":"relative"},                        {"responsive": true}                    )                };                            </script>        </div>

As expected, most of the coffees come from the largest coffee producing regions in the world. Almost all examples are from one of the following regions:

- Africa such as Ethiopia or Kenya
- Central or South America such as Colombia or Guatemala

There are also a lot of coffees from Hawaii, which is likely again because the data is from a US-based website.

### Highly and lowly rated coffees

If we look at the highest and lowest rates coffees, we see that they are dominated by certain roasters. 

```python
df.loc[df["rating"] > 96, ["name", "roaster"]].groupby("roaster").count()
```

|roaster  |	     count        |
|---------|-------------------|
|Barrington Coffee Roasting	|1|
|Bird Rock Coffee Roasters	|1|
|Dragonfly Coffee Roasters	|1|
|Hula Daddy Kona Coffee	    |1|
|JBC Coffee Roasters     	|3|
|Kakalove Cafe          	|1|
|Paradise Roasters	        |2|

```python
df.loc[df["rating"] < 90, ["name", "roaster"]].groupby("roaster").count()
```
|roaster  |	     count        |
|---------|-------------------|
|El Gran Cafe	            |8|
|Other	                    |4|


This suggests that either:
- Certain roasters find the best/worst coffees or roast them particularly well
- The reviewers favour/dislike certainer roasters

In either case, our model may need to access the roaster.

## Feature engineering

### Roaster
Let's first verify that the information about each roaster (in this case only country) is consistent across all coffees from the same roaster.

```python
def _assert_identical_values(df: pd.DataFrame) -> pd.Series:
    assert (df.iloc[1:, :] == df.iloc[0, :]).all().all()
    return df.iloc[0, :]


roaster_map = df[["roaster", "roaster_country"]].groupby("roaster").first()["roaster_country"]
```

There is evidence that certain roasters product particularly good/poor coffee (or are preferred/disliked by the reviewers). The model may therefore need a feature giving it this information.

We cannot simply convert the roaster using one-hot encoding as there are too many different values. Let us instead only include the most common roasters (those with > 10 coffees).


```python
roasters = df["roaster"].value_counts()
popular_roasters = sorted(roasters[roasters > 10].index)
```

Let's save this information to [`roasters.json`](https://github.com/alxhslm/coffee-rating-prediction/blob/main/data/roasters.json) for later use.
```python
roaster_info = {"known_roasters": roaster_map.to_dict(), "popular_roasters": popular_roasters}
with open("data/roasters.json", "w") as f:
    json.dump(roaster_info, f, indent=4)
```

We can now use this information to engineer roaster features with a smaller number of uniqute values.

```python
df["roaster"] = df["roaster"].where(df["roaster"].apply(lambda r: r in popular_roasters), "Other")
```

> :warning: If we find these features have a strong influence on the model, we need to be careful when applying the model to new coffees from unknown roasters. Even if the coffee is from a well-known roaster, they will have a "roaster" value of "Other" if they are not present in the training set. 

### Region of origin
The different regions of the world typically produce coffees which are similar in style. Eg African coffees are typically more acidic. Therefore it seems possible that the region may provide as much information as the country of origin. We will therefore engineer this feature.


```python
with open("./data/regions.json", "r") as f:
    REGIONS = json.load(f)

regions = {}
for r, countries in REGIONS.items():
    for c in countries:
        regions[c] = r

df["region_of_origin"] = df["country_of_origin"].map(regions).fillna("Other")
```

The vast majority of coffees in the dataset come from the major coffee producing regions of the world as expected.


```python
df["region_of_origin"].hist(histnorm="percent")
```

<div>                        <script type="text/javascript">window.PlotlyConfig = {MathJaxConfig: 'local'};</script>
        <script charset="utf-8" src="https://cdn.plot.ly/plotly-2.24.1.min.js"></script>                <div id="9d67c5d6-f2b7-4a29-9ca3-fc9158c8340a" class="plotly-graph-div" style="height:100%; width:100%;"></div>            <script type="text/javascript">                                    window.PLOTLYENV=window.PLOTLYENV || {};                                    if (document.getElementById("9d67c5d6-f2b7-4a29-9ca3-fc9158c8340a")) {                    Plotly.newPlot(                        "9d67c5d6-f2b7-4a29-9ca3-fc9158c8340a",                        [{"alignmentgroup":"True","bingroup":"x","histnorm":"percent","hovertemplate":"variable=region_of_origin\u003cbr\u003evalue=%{x}\u003cbr\u003epercent=%{y}\u003cextra\u003e\u003c\u002fextra\u003e","legendgroup":"region_of_origin","marker":{"color":"#636efa","pattern":{"shape":""}},"name":"region_of_origin","offsetgroup":"region_of_origin","orientation":"v","showlegend":true,"x":["East Africa","East Africa","East Africa","East Africa","East Africa","East Africa","East Africa","East Africa","East Africa","East Africa","East Africa","East Africa","North America","East Africa","East Africa","East Africa","East Africa","Central America","East Africa","East Africa","East Africa","East Africa","South America","East Africa","East Africa","East Africa","East Africa","Central America","Central America","North America","East Africa","South America","North America","East Africa","Central America","Central America","North America","Central America","Central America","East Africa","East Africa","East Africa","East Africa","East Africa","East Africa","North America","East Africa","South America","Central America","Southeast Asia","Central America","East Africa","East Africa","East Africa","East Africa","East Africa","East Africa","South America","Central America","South America","East Africa","East Africa","Other","Central America","East Africa","East Africa","East Africa","East Africa","East Africa","North America","East Africa","East Africa","South America","East Africa","East Africa","South America","East Africa","South America","East Africa","South America","Central America","East Africa","Central America","Southeast Asia","South America","East Africa","Central America","Central America","East Africa","East Africa","North America","East Africa","North America","East Africa","Other","East Africa","East Africa","South America","South America","East Africa","South America","South America","South America","South America","South America","South America","South America","East Africa","East Africa","East Africa","East Africa","East Africa","East Africa","East Africa","East Africa","East Africa","East Africa","Central America","East Africa","East Africa","Central America","East Africa","Central America","South America","South America","East Africa","Central America","East Africa","East Africa","Central America","East Africa","East Africa","Central America","Central America","East Africa","Central America","South America","South America","Central America","East Africa","Southeast Asia","East Africa","East Africa","Central America","East Africa","East Africa","East Africa","East Africa","Central America","East Africa","East Africa","East Africa","East Africa","East Africa","East Africa","South America","East Africa","East Africa","East Africa","Central America","East Africa","East Africa","East Africa","East Africa","East Africa","East Africa","South America","East Africa","East Africa","East Africa","East Africa","East Africa","East Africa","Central America","East Africa","East Africa","Central America","Central America","South America","South America","Central America","East Africa","East Africa","Central America","Central America","Central America","Central America","Central America","Central America","Central America","Central America","Central America","East Africa","South America","Central America","Central America","Central America","Central America","East Africa","East Africa","South America","South America","East Africa","North America","East Africa","East Africa","East Africa","Central America","East Africa","East Africa","Southeast Asia","East Africa","East Africa","East Africa","Central America","East Africa","Central America","East Africa","East Africa","East Africa","North America","East Africa","East Africa","East Africa","East Africa","East Africa","East Africa","Other","East Africa","Central America","South America","South America","East Africa","East Africa","East Africa","South America","East Africa","East Africa","East Africa","East Africa","East Africa","East Africa","South America","South America","East Africa","North America","North America","East Africa","East Africa","East Africa","East Africa","East Africa","Southeast Asia","Southeast Asia","East Africa","Central America","East Africa","East Africa","North America","Other","East Africa","East Africa","East Africa","East Africa","South America","South America","Southeast Asia","Southeast Asia","South America","North America","North America","North America","North America","North America","North America","North America","South America","South America","East Africa","Other","East Africa","East Africa","South America","South America","East Africa","North America","Central America","Central America","South America","South America","South America","East Africa","South America","East Africa","South America","Central America","South America","Central America","East Africa","East Africa","East Africa","North America","East Africa","East Africa","East Africa","East Africa","East Africa","East Africa","East Africa","East Africa","East Africa","East Africa","Central America","Central America","Central America","East Africa","East Africa","East Africa","Central America","East Africa","Central America","East Africa","Central America","Central America","East Africa","East Africa","East Africa","East Africa","East Africa","Central America","East Africa","East Africa","East Africa","East Africa","East Africa","East Africa","East Africa","Central America","Central America","Central America","South America","Southeast Asia","East Africa","South America","Central America","Central America","South America","East Africa","East Africa","East Africa","South America","Central America","Central America","East Africa","Central America","East Africa","East Africa","East Africa","East Africa","East Africa","East Africa","Central America","East Africa","East Africa","East Africa","East Africa","Central America","East Africa","Central America","East Africa","Central America","East Africa","East Africa","East Africa","East Africa","North America","Central America","East Africa","East Africa","Central America","East Africa","East Africa","East Africa","Central America","East Africa","South America","East Africa","South America","Central America","East Africa","Central America","East Africa","East Africa","East Africa","South America","Southeast Asia","North America","Central America","East Africa","Central America","East Africa","East Africa","East Africa","East Africa","East Africa","East Africa","East Africa","Central America","South America","East Africa","East Africa","East Africa","East Africa","Other","Other","North America","Central America","Central America","North America","North America","North America","East Africa","North America","East Africa","East Africa","East Africa","East Africa","East Africa","East Africa","Central America","South America","East Africa","South America","North America","East Africa","South America","South America","East Africa","East Africa","Other","East Africa","East Africa","South America","South America","North America","Other","North America","East Africa","East Africa","North America","Central America","South America","East Africa","East Africa","Other","South America","South America","East Africa","North America","North America","North America","East Africa","Central America","North America","East Africa","South America","East Africa","North America","North America","South America","East Africa","Southeast Asia","South America","North America","East Africa","Southeast Asia","Central America","Other","East Africa","Central America","Central America","East Africa","East Africa","South America","South America","East Africa","North America","East Africa","East Africa","South America","South America","Central America","South America","East Africa","East Africa","Central America","Central America","East Africa","East Africa","Central America","South America","East Africa","East Africa","East Africa","East Africa","East Africa","East Africa","East Africa","East Africa","East Africa","East Africa","East Africa","East Africa","Southeast Asia","South America","East Africa","East Africa","East Africa","South America","East Africa","Southeast Asia","North America","East Africa","East Africa","East Africa","East Africa","East Africa","East Africa","Central America","Central America","North America","Central America","East Africa","Central America","East Africa","Central America","East Africa","East Africa","South America","East Africa","Central America","North America","North America","East Africa","East Africa","Southeast Asia","Central America","Central America","Central America","Central America","Central America","East Africa","East Africa","East Africa","East Africa","North America","North America","North America","East Africa","South America","East Africa","Central America","Central America","North America","East Africa","Central America","East Africa","South America","East Africa","North America","South America","South America","East Africa","East Africa","East Africa","East Africa","East Africa","East Africa","East Africa","East Africa","East Africa","East Africa","East Africa","Central America","Central America","Central America","Central America","Central America","Central America","Central America","East Africa","Central America","East Africa","East Africa","East Africa","East Africa","Central America","Central America","North America","South America","South America","East Africa","East Africa","East Africa","East Africa","East Africa","Central America","South America","Other","Central America","Central America","East Africa","East Africa","East Africa","East Africa","East Africa","Central America","North America","North America","North America","East Africa","South America","East Africa","South America","East Africa","East Africa","East Africa","East Africa","North America","North America","East Africa","Other","East Africa","East Africa","North America","East Africa","North America","North America","North America","Central America","North America","North America","North America","North America","Central America","East Africa","Central America","East Africa","North America","Central America","East Africa","East Africa","East Africa","East Africa","Other","South America","East Africa","Central America","Central America","Central America","South America","Central America","East Africa","East Africa","North America","Central America","East Africa","East Africa","South America","North America","East Africa","East Africa","North America","Southeast Asia","East Africa","Southeast Asia","East Africa","East Africa","East Africa","Other","East Africa","South America","South America","South America","South America","East Africa","East Africa","East Africa","North America","East Africa","East Africa","Central America","North America","North America","Central America","East Africa","East Africa","East Africa","South America","South America","South America","South America","South America","Central America","Central America","Southeast Asia","East Africa","South America","East Africa","Southeast Asia","East Africa","East Africa","Central America","East Africa","Central America","South America","East Africa","Other","East Africa","East Africa","South America","South America","North America","South America","North America","South America","East Africa","Other","East Africa","East Africa","South America","East Africa","Other","Other","Central America","East Africa","South America","South America","South America","East Africa","East Africa","Central America","East Africa","North America","Central America","North America","Central America","North America","North America","North America","East Africa","East Africa","East Africa","East Africa","East Africa","East Africa","South America","East Africa","North America","Other","South America","South America","East Africa","Central America","East Africa","South America","East Africa","Central America","East Africa","East Africa","East Africa","East Africa","North America","South America","East Africa","East Africa","South America","East Africa","East Africa","South America","Central America","East Africa","Central America","East Africa","South America","East Africa","East Africa","East Africa","East Africa","East Africa","East Africa","East Africa","South America","South America","South America","North America","Central America","East Africa","East Africa","Other","East Africa","East Africa","East Africa","East Africa","Other","East Africa","East Africa","South America","South America","South America","East Africa","North America","South America","South America","East Africa","South America","Southeast Asia","Other","Central America","South America","Other","Other","South America","East Africa","East Africa","East Africa","Central America","East Africa","East Africa","South America","Other","East Africa","East Africa","East Africa","North America","East Africa","Central America","Central America","East Africa","East Africa","East Africa","East Africa","South America","East Africa","South America","Southeast Asia","East Africa","Central America","East Africa","Central America","East Africa","Central America","Central America","South America","Central America","South America","East Africa","Central America","North America","East Africa","Central America","East Africa","Other","North America","Central America","North America","East Africa","East Africa","South America","South America","Other","East Africa","Central America","East Africa","North America","Central America","East Africa","East Africa","East Africa","East Africa","East Africa","South America","East Africa","East Africa","Central America","East Africa","Other","Other","Other","Other","South America","Central America","East Africa","East Africa","North America","North America","East Africa","Central America","Central America","East Africa","East Africa","East Africa","East Africa","South America","East Africa","Central America","East Africa","East Africa","Central America","East Africa","East Africa","East Africa","Central America","East Africa","South America","North America","East Africa","East Africa","Central America","East Africa","North America","East Africa","North America","South America","South America","East Africa","East Africa","East Africa","Central America","South America","East Africa","South America","Central America","East Africa","North America","North America","East Africa","East Africa","East Africa","Central America","South America","East Africa","North America","Central America","East Africa","Central America","North America","East Africa","Southeast Asia","East Africa","North America","East Africa","East Africa","East Africa","East Africa","Central America","East Africa","Central America","Central America","Central America","Central America","Central America","Central America","Central America","Central America","Central America","East Africa","East Africa","East Africa","East Africa","East Africa","East Africa","North America","East Africa","East Africa","North America","East Africa","East Africa","Central America","East Africa","Other","Central America","Central America","East Africa","South America","East Africa","East Africa","Central America","East Africa","East Africa","East Africa","Central America","East Africa","North America","South America","South America","Central America","East Africa","East Africa","East Africa","East Africa","East Africa","North America","East Africa","Southeast Asia","Central America","East Africa","East Africa","South America","Central America","East Africa","North America","Central America","East Africa","East Africa","Central America","East Africa","East Africa","Southeast Asia","East Africa","North America","South America","Other","Central America","East Africa","Central America","South America","South America","North America","North America","North America","Central America","North America","North America","North America","East Africa","South America","East Africa","East Africa","East Africa","East Africa","East Africa","East Africa","Central America","East Africa","North America","Central America","North America","South America","Southeast Asia","North America","Southeast Asia","East Africa","East Africa","Southeast Asia","Other","East Africa","East Africa","East Africa","South America","North America","Central America","Central America","East Africa","East Africa","South America","Southeast Asia","East Africa","Other","East Africa","East Africa","North America","South America","East Africa","East Africa","Central America","East Africa","Central America","Central America","Central America","East Africa","Central America","East Africa","East Africa","South America","South America","Central America","South America","South America","South America","East Africa","East Africa","South America","South America","Central America","South America","East Africa","East Africa","East Africa","East Africa","East Africa","East Africa","East Africa","East Africa","East Africa","East Africa","South America","South America","South America","East Africa","East Africa","North America","South America","Central America","North America","East Africa","Central America","Central America","East Africa","South America","East Africa","Southeast Asia","Central America","East Africa","North America","East Africa","East Africa","East Africa","South America","Central America","Central America","Central America","Central America","Central America","East Africa","South America","East Africa","East Africa","Central America","Other","South America","South America","East Africa","South America","East Africa","East Africa","East Africa","Central America","East Africa","East Africa","Southeast Asia","Southeast Asia","South America","East Africa","Central America","Central America","East Africa","Central America","South America","Central America","North America","Central America","East Africa","East Africa","South America","Southeast Asia","East Africa","East Africa","East Africa","East Africa","North America","North America","South America","South America","North America","South America","East Africa","East Africa","East Africa","East Africa","South America","East Africa","North America","North America","East Africa","East Africa","East Africa","East Africa","Central America","Central America","Central America","North America","South America","South America","East Africa","East Africa","East Africa","East Africa","East Africa","North America","East Africa","East Africa","East Africa","East Africa","East Africa","East Africa","East Africa","South America","East Africa","East Africa","East Africa","East Africa","Central America","East Africa","East Africa","East Africa","East Africa","East Africa","East Africa","South America","Central America","Central America","South America","Central America","South America","Other","Central America","Central America","Central America","East Africa","Central America","South America","North America","Central America","South America","Central America","Central America","Central America","Central America","South America","East Africa","Central America","Central America","Central America","Central America","Central America"],"xaxis":"x","yaxis":"y","type":"histogram"}],                        {"template":{"data":{"histogram2dcontour":[{"type":"histogram2dcontour","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"choropleth":[{"type":"choropleth","colorbar":{"outlinewidth":0,"ticks":""}}],"histogram2d":[{"type":"histogram2d","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"heatmap":[{"type":"heatmap","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"heatmapgl":[{"type":"heatmapgl","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"contourcarpet":[{"type":"contourcarpet","colorbar":{"outlinewidth":0,"ticks":""}}],"contour":[{"type":"contour","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"surface":[{"type":"surface","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"mesh3d":[{"type":"mesh3d","colorbar":{"outlinewidth":0,"ticks":""}}],"scatter":[{"fillpattern":{"fillmode":"overlay","size":10,"solidity":0.2},"type":"scatter"}],"parcoords":[{"type":"parcoords","line":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scatterpolargl":[{"type":"scatterpolargl","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"bar":[{"error_x":{"color":"#2a3f5f"},"error_y":{"color":"#2a3f5f"},"marker":{"line":{"color":"#E5ECF6","width":0.5},"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"bar"}],"scattergeo":[{"type":"scattergeo","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scatterpolar":[{"type":"scatterpolar","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"histogram":[{"marker":{"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"histogram"}],"scattergl":[{"type":"scattergl","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scatter3d":[{"type":"scatter3d","line":{"colorbar":{"outlinewidth":0,"ticks":""}},"marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scattermapbox":[{"type":"scattermapbox","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scatterternary":[{"type":"scatterternary","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scattercarpet":[{"type":"scattercarpet","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"carpet":[{"aaxis":{"endlinecolor":"#2a3f5f","gridcolor":"white","linecolor":"white","minorgridcolor":"white","startlinecolor":"#2a3f5f"},"baxis":{"endlinecolor":"#2a3f5f","gridcolor":"white","linecolor":"white","minorgridcolor":"white","startlinecolor":"#2a3f5f"},"type":"carpet"}],"table":[{"cells":{"fill":{"color":"#EBF0F8"},"line":{"color":"white"}},"header":{"fill":{"color":"#C8D4E3"},"line":{"color":"white"}},"type":"table"}],"barpolar":[{"marker":{"line":{"color":"#E5ECF6","width":0.5},"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"barpolar"}],"pie":[{"automargin":true,"type":"pie"}]},"layout":{"autotypenumbers":"strict","colorway":["#636efa","#EF553B","#00cc96","#ab63fa","#FFA15A","#19d3f3","#FF6692","#B6E880","#FF97FF","#FECB52"],"font":{"color":"#2a3f5f"},"hovermode":"closest","hoverlabel":{"align":"left"},"paper_bgcolor":"white","plot_bgcolor":"#E5ECF6","polar":{"bgcolor":"#E5ECF6","angularaxis":{"gridcolor":"white","linecolor":"white","ticks":""},"radialaxis":{"gridcolor":"white","linecolor":"white","ticks":""}},"ternary":{"bgcolor":"#E5ECF6","aaxis":{"gridcolor":"white","linecolor":"white","ticks":""},"baxis":{"gridcolor":"white","linecolor":"white","ticks":""},"caxis":{"gridcolor":"white","linecolor":"white","ticks":""}},"coloraxis":{"colorbar":{"outlinewidth":0,"ticks":""}},"colorscale":{"sequential":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"sequentialminus":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"diverging":[[0,"#8e0152"],[0.1,"#c51b7d"],[0.2,"#de77ae"],[0.3,"#f1b6da"],[0.4,"#fde0ef"],[0.5,"#f7f7f7"],[0.6,"#e6f5d0"],[0.7,"#b8e186"],[0.8,"#7fbc41"],[0.9,"#4d9221"],[1,"#276419"]]},"xaxis":{"gridcolor":"white","linecolor":"white","ticks":"","title":{"standoff":15},"zerolinecolor":"white","automargin":true,"zerolinewidth":2},"yaxis":{"gridcolor":"white","linecolor":"white","ticks":"","title":{"standoff":15},"zerolinecolor":"white","automargin":true,"zerolinewidth":2},"scene":{"xaxis":{"backgroundcolor":"#E5ECF6","gridcolor":"white","linecolor":"white","showbackground":true,"ticks":"","zerolinecolor":"white","gridwidth":2},"yaxis":{"backgroundcolor":"#E5ECF6","gridcolor":"white","linecolor":"white","showbackground":true,"ticks":"","zerolinecolor":"white","gridwidth":2},"zaxis":{"backgroundcolor":"#E5ECF6","gridcolor":"white","linecolor":"white","showbackground":true,"ticks":"","zerolinecolor":"white","gridwidth":2}},"shapedefaults":{"line":{"color":"#2a3f5f"}},"annotationdefaults":{"arrowcolor":"#2a3f5f","arrowhead":0,"arrowwidth":1},"geo":{"bgcolor":"white","landcolor":"#E5ECF6","subunitcolor":"white","showland":true,"showlakes":true,"lakecolor":"white"},"title":{"x":0.05},"mapbox":{"style":"light"}}},"xaxis":{"anchor":"y","domain":[0.0,1.0],"title":{"text":"value"}},"yaxis":{"anchor":"x","domain":[0.0,1.0],"title":{"text":"percent"}},"legend":{"title":{"text":"variable"},"tracegroupgap":0},"margin":{"t":60},"barmode":"relative"},                        {"responsive": true}                    )                };                            </script>        </div>

### Flavour notes
As it stands, we cannot glean any information from the review column as it is unstructured. Let's begin by analysing the keywords present in the reviews.


```python
import re


def extract_words(string: str) -> list[str]:
    return re.findall(r'\w+', string.lower())


words = pd.Series([word for review in df["review"] for word in extract_words(review)]).value_counts()

GENERIC_WORDS = ["and", "in", "with", "the", "of", "to", "a", "by", "like", "is", "around"]
COFFEE_WORDS = ["cup", "notes", "finish", "aroma", "hint", "undertones", "resonant", "high", "consolidates", "flavor"]
words = words.drop(GENERIC_WORDS + COFFEE_WORDS)
words.head()
```

We can see that the most common words relate to the flavour of the coffee. This suggests that we can extract some features for the different flavours in the coffee.

Using this information and the [coffee flavour wheel](https://www.anychart.com/products/anychart/gallery/Sunburst_Charts/Coffee_Flavour_Wheel.php), we can manually define some flavours and corresponding keywords which are stored in [`flavours.json`](https://github.com/alxhslm/coffee-rating-prediction/blob/main/data/flavours.json).


```python
with open("./data/flavours.json", "r") as f:
    FLAVOURS = json.load(f)
```

We can now add boolean features for each flavour.


```python
def rating_contains_words(review: str, keywords: list[str]) -> bool:
    words = extract_words(review)
    for w in keywords:
        if w in words:
            return True
    return False


for flavour, keywords in FLAVOURS.items():
    df[flavour] = df["review"].apply(rating_contains_words, args=(keywords,))
```

Let's now combine the flavours into a single column.


```python
df["flavours"] = df.apply(lambda coffee: [flavour for flavour in FLAVOURS if coffee[flavour]], axis=1)
```

It is useful to examine the popularity of the different flavours, by plotting the histogram. We can see that the most common flavours are:
- Caramelly
- Acidic
- Fruity
- Chocolate

Intuitively, this makes sense as these are the sorts of flavours we see on coffee packets.

```python
df[list(FLAVOURS.keys())].sum().divide(df.shape[0]).sort_values(ascending=False).plot.bar(labels={"index":"flavour"})
```
<div>                        <script type="text/javascript">window.PlotlyConfig = {MathJaxConfig: 'local'};</script>
        <script charset="utf-8" src="https://cdn.plot.ly/plotly-2.24.1.min.js"></script>                <div id="9b46dbec-c952-4108-80f3-61b397d8f577" class="plotly-graph-div" style="height:100%; width:100%;"></div>            <script type="text/javascript">                                    window.PLOTLYENV=window.PLOTLYENV || {};                                    if (document.getElementById("9b46dbec-c952-4108-80f3-61b397d8f577")) {                    Plotly.newPlot(                        "9b46dbec-c952-4108-80f3-61b397d8f577",                        [{"alignmentgroup":"True","hovertemplate":"variable=0\u003cbr\u003eflavour=%{x}\u003cbr\u003epercent=%{y}\u003cextra\u003e\u003c\u002fextra\u003e","legendgroup":"0","marker":{"color":"#636efa","pattern":{"shape":""}},"name":"0","offsetgroup":"0","orientation":"v","showlegend":true,"textposition":"auto","x":["caramelly","acidic","fruity","chocolate","floral","resinous","spicy","nutty","herby","carbony"],"xaxis":"x","y":[94.0609951845907,93.17817014446229,90.6099518459069,83.94863563402889,71.99036918138042,53.21027287319422,40.69020866773676,35.63402889245586,12.76083467094703,11.476725521669342],"yaxis":"y","type":"bar"}],                        {"template":{"data":{"histogram2dcontour":[{"type":"histogram2dcontour","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"choropleth":[{"type":"choropleth","colorbar":{"outlinewidth":0,"ticks":""}}],"histogram2d":[{"type":"histogram2d","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"heatmap":[{"type":"heatmap","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"heatmapgl":[{"type":"heatmapgl","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"contourcarpet":[{"type":"contourcarpet","colorbar":{"outlinewidth":0,"ticks":""}}],"contour":[{"type":"contour","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"surface":[{"type":"surface","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"mesh3d":[{"type":"mesh3d","colorbar":{"outlinewidth":0,"ticks":""}}],"scatter":[{"fillpattern":{"fillmode":"overlay","size":10,"solidity":0.2},"type":"scatter"}],"parcoords":[{"type":"parcoords","line":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scatterpolargl":[{"type":"scatterpolargl","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"bar":[{"error_x":{"color":"#2a3f5f"},"error_y":{"color":"#2a3f5f"},"marker":{"line":{"color":"#E5ECF6","width":0.5},"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"bar"}],"scattergeo":[{"type":"scattergeo","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scatterpolar":[{"type":"scatterpolar","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"histogram":[{"marker":{"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"histogram"}],"scattergl":[{"type":"scattergl","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scatter3d":[{"type":"scatter3d","line":{"colorbar":{"outlinewidth":0,"ticks":""}},"marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scattermapbox":[{"type":"scattermapbox","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scatterternary":[{"type":"scatterternary","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scattercarpet":[{"type":"scattercarpet","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"carpet":[{"aaxis":{"endlinecolor":"#2a3f5f","gridcolor":"white","linecolor":"white","minorgridcolor":"white","startlinecolor":"#2a3f5f"},"baxis":{"endlinecolor":"#2a3f5f","gridcolor":"white","linecolor":"white","minorgridcolor":"white","startlinecolor":"#2a3f5f"},"type":"carpet"}],"table":[{"cells":{"fill":{"color":"#EBF0F8"},"line":{"color":"white"}},"header":{"fill":{"color":"#C8D4E3"},"line":{"color":"white"}},"type":"table"}],"barpolar":[{"marker":{"line":{"color":"#E5ECF6","width":0.5},"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"barpolar"}],"pie":[{"automargin":true,"type":"pie"}]},"layout":{"autotypenumbers":"strict","colorway":["#636efa","#EF553B","#00cc96","#ab63fa","#FFA15A","#19d3f3","#FF6692","#B6E880","#FF97FF","#FECB52"],"font":{"color":"#2a3f5f"},"hovermode":"closest","hoverlabel":{"align":"left"},"paper_bgcolor":"white","plot_bgcolor":"#E5ECF6","polar":{"bgcolor":"#E5ECF6","angularaxis":{"gridcolor":"white","linecolor":"white","ticks":""},"radialaxis":{"gridcolor":"white","linecolor":"white","ticks":""}},"ternary":{"bgcolor":"#E5ECF6","aaxis":{"gridcolor":"white","linecolor":"white","ticks":""},"baxis":{"gridcolor":"white","linecolor":"white","ticks":""},"caxis":{"gridcolor":"white","linecolor":"white","ticks":""}},"coloraxis":{"colorbar":{"outlinewidth":0,"ticks":""}},"colorscale":{"sequential":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"sequentialminus":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"diverging":[[0,"#8e0152"],[0.1,"#c51b7d"],[0.2,"#de77ae"],[0.3,"#f1b6da"],[0.4,"#fde0ef"],[0.5,"#f7f7f7"],[0.6,"#e6f5d0"],[0.7,"#b8e186"],[0.8,"#7fbc41"],[0.9,"#4d9221"],[1,"#276419"]]},"xaxis":{"gridcolor":"white","linecolor":"white","ticks":"","title":{"standoff":15},"zerolinecolor":"white","automargin":true,"zerolinewidth":2},"yaxis":{"gridcolor":"white","linecolor":"white","ticks":"","title":{"standoff":15},"zerolinecolor":"white","automargin":true,"zerolinewidth":2},"scene":{"xaxis":{"backgroundcolor":"#E5ECF6","gridcolor":"white","linecolor":"white","showbackground":true,"ticks":"","zerolinecolor":"white","gridwidth":2},"yaxis":{"backgroundcolor":"#E5ECF6","gridcolor":"white","linecolor":"white","showbackground":true,"ticks":"","zerolinecolor":"white","gridwidth":2},"zaxis":{"backgroundcolor":"#E5ECF6","gridcolor":"white","linecolor":"white","showbackground":true,"ticks":"","zerolinecolor":"white","gridwidth":2}},"shapedefaults":{"line":{"color":"#2a3f5f"}},"annotationdefaults":{"arrowcolor":"#2a3f5f","arrowhead":0,"arrowwidth":1},"geo":{"bgcolor":"white","landcolor":"#E5ECF6","subunitcolor":"white","showland":true,"showlakes":true,"lakecolor":"white"},"title":{"x":0.05},"mapbox":{"style":"light"}}},"xaxis":{"anchor":"y","domain":[0.0,1.0],"title":{"text":"flavour"}},"yaxis":{"anchor":"x","domain":[0.0,1.0],"title":{"text":"percent"}},"legend":{"title":{"text":"variable"},"tracegroupgap":0},"margin":{"t":60},"barmode":"relative"},                        {"responsive": true}                    )                };                            </script>        </div>

It is also interesting to check how many flavours the different coffees have. If we have done a good job at defining the flavour keywords, we would expect not many coffees to have no flavours.

```python
df[list(FLAVOURS.keys())].sum(axis=1).hist(histnorm="percent", labels={"value":"num_flavours"})
```

<div>                        <script type="text/javascript">window.PlotlyConfig = {MathJaxConfig: 'local'};</script>
        <script charset="utf-8" src="https://cdn.plot.ly/plotly-2.24.1.min.js"></script>                <div id="0df01c52-b8f9-4a19-a49e-7e83f8e016f9" class="plotly-graph-div" style="height:100%; width:100%;"></div>            <script type="text/javascript">                                    window.PLOTLYENV=window.PLOTLYENV || {};                                    if (document.getElementById("0df01c52-b8f9-4a19-a49e-7e83f8e016f9")) {                    Plotly.newPlot(                        "0df01c52-b8f9-4a19-a49e-7e83f8e016f9",                        [{"alignmentgroup":"True","bingroup":"x","histnorm":"percent","hovertemplate":"variable=0\u003cbr\u003evalue=%{x}\u003cbr\u003epercent=%{y}\u003cextra\u003e\u003c\u002fextra\u003e","legendgroup":"0","marker":{"color":"#636efa","pattern":{"shape":""}},"name":"0","offsetgroup":"0","orientation":"v","showlegend":true,"x":[7,8,5,5,6,4,8,7,6,5,8,5,7,7,6,6,4,5,5,5,5,8,6,5,7,4,7,5,6,5,6,3,6,7,6,5,5,7,7,6,5,6,7,6,5,3,5,5,8,7,8,5,4,4,7,6,5,7,4,5,5,5,6,5,5,8,6,7,6,8,6,6,5,5,5,7,6,5,7,8,7,6,6,5,4,5,6,5,7,7,5,5,7,6,6,9,7,7,8,8,6,8,5,7,5,6,9,8,6,8,5,7,6,4,6,6,6,5,6,5,8,5,4,7,7,7,8,5,5,6,6,6,4,6,6,8,7,6,4,7,5,7,6,7,6,7,6,6,5,7,6,6,7,4,5,5,4,8,6,8,7,7,7,4,5,5,5,6,5,8,6,8,5,8,6,8,4,7,7,8,7,7,6,8,6,7,8,6,6,4,4,9,7,7,7,6,6,6,6,4,6,4,7,7,7,6,7,6,7,8,8,9,5,6,5,6,4,7,6,5,6,6,7,8,6,7,6,5,6,5,6,5,6,6,6,8,5,7,7,6,4,7,7,6,6,6,4,5,5,6,6,7,5,5,6,6,5,7,9,8,5,4,6,4,7,3,7,6,5,7,6,6,5,6,7,8,7,3,6,7,4,6,6,6,6,6,6,3,7,5,6,6,6,6,7,6,6,6,5,5,5,6,6,7,6,6,7,4,6,6,7,7,4,6,6,6,6,5,7,6,6,6,4,6,7,6,6,7,6,4,6,5,6,6,5,6,7,6,6,4,6,7,6,5,4,6,6,4,6,7,7,7,6,7,6,5,5,7,6,4,5,5,5,5,6,8,8,6,6,6,5,7,7,6,7,5,8,6,6,5,5,7,5,5,7,4,7,5,8,5,5,7,7,7,5,5,6,5,7,5,4,6,8,5,6,6,5,7,4,5,5,6,6,9,6,8,6,4,4,5,3,5,6,4,7,7,5,7,6,4,6,6,8,6,6,6,7,5,5,6,5,5,6,5,7,8,5,7,5,5,5,4,8,6,7,6,6,5,4,7,6,7,6,6,5,5,5,5,5,7,7,5,6,6,7,6,6,5,4,6,6,5,7,3,5,6,6,5,5,7,5,6,7,5,7,6,8,5,6,7,7,7,6,6,6,7,6,6,6,4,3,4,5,7,4,7,4,6,6,4,6,6,5,6,6,5,7,6,6,6,6,7,4,6,4,6,4,7,5,4,5,4,5,4,5,6,7,5,4,4,4,8,5,7,7,5,5,6,4,5,7,6,6,6,4,6,6,4,5,7,5,3,8,7,7,7,8,7,6,6,6,5,5,7,6,7,6,8,8,4,5,5,5,7,5,5,4,5,6,8,6,6,7,4,8,4,7,6,5,5,4,7,7,6,3,7,4,6,5,5,5,7,5,4,9,6,5,6,5,5,7,5,5,8,5,4,3,5,8,7,6,5,6,6,5,5,7,5,5,5,6,6,6,5,6,6,5,7,6,6,7,7,5,4,6,5,5,4,6,5,5,5,5,6,7,7,8,7,6,5,5,8,7,6,5,7,6,6,5,5,7,8,5,6,6,5,4,7,5,9,6,5,6,7,6,5,5,7,7,5,6,5,6,5,6,4,5,5,6,7,6,4,7,5,5,6,7,8,7,4,8,6,7,5,7,8,4,7,5,5,7,4,6,4,6,8,6,6,5,5,5,4,7,8,6,5,6,6,6,5,7,5,5,6,6,5,6,6,6,6,7,6,4,6,5,4,5,6,6,5,7,6,5,7,5,7,6,6,6,5,5,7,6,6,5,5,7,7,6,5,7,5,6,6,6,4,6,6,5,5,6,7,5,7,5,5,3,6,5,7,7,5,6,3,4,7,7,6,6,5,5,7,5,8,5,6,7,8,5,7,4,5,6,5,5,8,6,6,5,5,6,7,6,6,6,5,7,6,5,5,5,6,6,7,6,8,4,7,7,7,6,6,3,6,6,8,7,8,5,6,6,6,7,7,6,6,6,8,7,6,7,7,6,6,6,8,6,6,5,6,5,7,7,6,6,6,4,6,5,7,6,6,6,5,6,6,5,5,7,8,6,7,6,6,7,7,7,7,5,5,8,5,6,6,7,5,6,7,7,4,6,7,4,6,5,6,5,5,6,6,7,5,6,6,5,5,5,7,4,5,7,5,7,4,7,6,6,7,4,6,6,3,6,5,7,5,6,7,5,7,5,6,5,8,7,6,6,7,6,2,8,4,7,5,5,5,5,5,7,7,7,5,6,6,7,5,6,4,5,3,7,7,4,6,5,5,4,6,6,3,5,7,6,6,6,5,6,5,7,4,3,5,5,5,9,7,5,5,5,5,8,4,7,4,6,9,8,6,5,6,6,6,9,5,5,6,5,7,6,6,7,2,7,5,6,5,7,5,5,6,7,6,4,5,5,6,5,8,7,6,5,5,5,6,7,8,5,5,5,7,7,5,7,5,6,6,6,5,5,5,6,7,5,7,6,5,2,5,3,6,6,6,5,6,6,6,5,7,7,4,6,8,8,5,7,6,7,6,6,4,5,6,5,4,7,6,6,6,6,6,5,7,6,6,7,7,7,6,7,7,6,4,6,6,6,5,5,4,6,7,4,5,7,5,5,5,6,6,6,4,6,7,4,6,6,5,7,8,7,5,5,6,6,4,7,7,5,6,8,5,7,6,6,7,6,5,5,7,7,8,5,6,5,8,7,5,6,5,6,6,7,6,8,7,6,5,5,7,6,5,6,6,4,6,6,5,8,5,6,6,5,6,8,7,5,6,6,5,6,6,8,6,7,5,4,6],"xaxis":"x","yaxis":"y","type":"histogram"}],                        {"template":{"data":{"histogram2dcontour":[{"type":"histogram2dcontour","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"choropleth":[{"type":"choropleth","colorbar":{"outlinewidth":0,"ticks":""}}],"histogram2d":[{"type":"histogram2d","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"heatmap":[{"type":"heatmap","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"heatmapgl":[{"type":"heatmapgl","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"contourcarpet":[{"type":"contourcarpet","colorbar":{"outlinewidth":0,"ticks":""}}],"contour":[{"type":"contour","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"surface":[{"type":"surface","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"mesh3d":[{"type":"mesh3d","colorbar":{"outlinewidth":0,"ticks":""}}],"scatter":[{"fillpattern":{"fillmode":"overlay","size":10,"solidity":0.2},"type":"scatter"}],"parcoords":[{"type":"parcoords","line":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scatterpolargl":[{"type":"scatterpolargl","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"bar":[{"error_x":{"color":"#2a3f5f"},"error_y":{"color":"#2a3f5f"},"marker":{"line":{"color":"#E5ECF6","width":0.5},"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"bar"}],"scattergeo":[{"type":"scattergeo","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scatterpolar":[{"type":"scatterpolar","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"histogram":[{"marker":{"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"histogram"}],"scattergl":[{"type":"scattergl","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scatter3d":[{"type":"scatter3d","line":{"colorbar":{"outlinewidth":0,"ticks":""}},"marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scattermapbox":[{"type":"scattermapbox","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scatterternary":[{"type":"scatterternary","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scattercarpet":[{"type":"scattercarpet","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"carpet":[{"aaxis":{"endlinecolor":"#2a3f5f","gridcolor":"white","linecolor":"white","minorgridcolor":"white","startlinecolor":"#2a3f5f"},"baxis":{"endlinecolor":"#2a3f5f","gridcolor":"white","linecolor":"white","minorgridcolor":"white","startlinecolor":"#2a3f5f"},"type":"carpet"}],"table":[{"cells":{"fill":{"color":"#EBF0F8"},"line":{"color":"white"}},"header":{"fill":{"color":"#C8D4E3"},"line":{"color":"white"}},"type":"table"}],"barpolar":[{"marker":{"line":{"color":"#E5ECF6","width":0.5},"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"barpolar"}],"pie":[{"automargin":true,"type":"pie"}]},"layout":{"autotypenumbers":"strict","colorway":["#636efa","#EF553B","#00cc96","#ab63fa","#FFA15A","#19d3f3","#FF6692","#B6E880","#FF97FF","#FECB52"],"font":{"color":"#2a3f5f"},"hovermode":"closest","hoverlabel":{"align":"left"},"paper_bgcolor":"white","plot_bgcolor":"#E5ECF6","polar":{"bgcolor":"#E5ECF6","angularaxis":{"gridcolor":"white","linecolor":"white","ticks":""},"radialaxis":{"gridcolor":"white","linecolor":"white","ticks":""}},"ternary":{"bgcolor":"#E5ECF6","aaxis":{"gridcolor":"white","linecolor":"white","ticks":""},"baxis":{"gridcolor":"white","linecolor":"white","ticks":""},"caxis":{"gridcolor":"white","linecolor":"white","ticks":""}},"coloraxis":{"colorbar":{"outlinewidth":0,"ticks":""}},"colorscale":{"sequential":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"sequentialminus":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"diverging":[[0,"#8e0152"],[0.1,"#c51b7d"],[0.2,"#de77ae"],[0.3,"#f1b6da"],[0.4,"#fde0ef"],[0.5,"#f7f7f7"],[0.6,"#e6f5d0"],[0.7,"#b8e186"],[0.8,"#7fbc41"],[0.9,"#4d9221"],[1,"#276419"]]},"xaxis":{"gridcolor":"white","linecolor":"white","ticks":"","title":{"standoff":15},"zerolinecolor":"white","automargin":true,"zerolinewidth":2},"yaxis":{"gridcolor":"white","linecolor":"white","ticks":"","title":{"standoff":15},"zerolinecolor":"white","automargin":true,"zerolinewidth":2},"scene":{"xaxis":{"backgroundcolor":"#E5ECF6","gridcolor":"white","linecolor":"white","showbackground":true,"ticks":"","zerolinecolor":"white","gridwidth":2},"yaxis":{"backgroundcolor":"#E5ECF6","gridcolor":"white","linecolor":"white","showbackground":true,"ticks":"","zerolinecolor":"white","gridwidth":2},"zaxis":{"backgroundcolor":"#E5ECF6","gridcolor":"white","linecolor":"white","showbackground":true,"ticks":"","zerolinecolor":"white","gridwidth":2}},"shapedefaults":{"line":{"color":"#2a3f5f"}},"annotationdefaults":{"arrowcolor":"#2a3f5f","arrowhead":0,"arrowwidth":1},"geo":{"bgcolor":"white","landcolor":"#E5ECF6","subunitcolor":"white","showland":true,"showlakes":true,"lakecolor":"white"},"title":{"x":0.05},"mapbox":{"style":"light"}}},"xaxis":{"anchor":"y","domain":[0.0,1.0],"title":{"text":"num_flavours"}},"yaxis":{"anchor":"x","domain":[0.0,1.0],"title":{"text":"percent"}},"legend":{"title":{"text":"variable"},"tracegroupgap":0},"margin":{"t":60},"barmode":"relative"},                        {"responsive": true}                    )                };                            </script>        </div>

Indeed, this appears to be the case. All coffees have at least some flavours, and in fact, most coffees have 6 flavours!

## Building a model

```python
features = ["roaster", "roast", "roaster_country", "region_of_origin", "price_per_100g", "flavours"]
X = df[features].copy()
X["price_per_100g"] = X["price_per_100g"].apply(np.log1p)
y = df["rating"]
```


* Split the dataset into train/validation/test sets with 60%/20%/20% distribution. 
* Use the `train_test_split` function and set the `random_state` parameter to 1.


```python
from sklearn.model_selection import train_test_split

X_train_val, X_test = train_test_split(X, test_size=0.2, random_state=1)
y_train_val, y_test = train_test_split(y, test_size=0.2, random_state=1)

X_train, X_val = train_test_split(X_train_val, test_size=0.25, random_state=1)
y_train, y_val = train_test_split(y_train_val, test_size=0.25, random_state=1)
```


```python
from sklearn.feature_extraction import DictVectorizer

dv = DictVectorizer(sparse=False)
dv.fit(X_train.to_dict(orient="records"))


def _transform(df: pd.DataFrame):
    return dv.transform(df.to_dict(orient="records"))
```

### Linear regression
Let's start with the simplest model which is a linear regressor. 


```python
from sklearn.linear_model import Ridge
from sklearn.metrics import mean_squared_error

scores = pd.DataFrame(columns=["test", "validation"])
for alpha in [0.01, 0.03, 0.1, 0.3, 1.0, 3.0, 10.0]:
    model = Ridge(alpha=alpha)
    model.fit(_transform(X_train), y_train)
    scores.loc[alpha, :] = pd.Series(
        {
            "test": mean_squared_error(y_train, model.predict(_transform(X_train)), squared=False),
            "validation": mean_squared_error(y_val, model.predict(_transform(X_val)), squared=False),
        }
    )

fig = scores.plot(log_x=True, labels={"index":"alpha", "value":"loss"})
```

<div>                        <script type="text/javascript">window.PlotlyConfig = {MathJaxConfig: 'local'};</script>
        <script charset="utf-8" src="https://cdn.plot.ly/plotly-2.24.1.min.js"></script>                <div id="b08d9712-fe67-49d9-90fe-825389f79bf0" class="plotly-graph-div" style="height:100%; width:100%;"></div>            <script type="text/javascript">                                    window.PLOTLYENV=window.PLOTLYENV || {};                                    if (document.getElementById("b08d9712-fe67-49d9-90fe-825389f79bf0")) {                    Plotly.newPlot(                        "b08d9712-fe67-49d9-90fe-825389f79bf0",                        [{"hovertemplate":"variable=test\u003cbr\u003ealpha=%{x}\u003cbr\u003eloss=%{y}\u003cextra\u003e\u003c\u002fextra\u003e","legendgroup":"test","line":{"color":"#636efa","dash":"solid"},"marker":{"symbol":"circle"},"mode":"lines","name":"test","orientation":"v","showlegend":true,"x":[0.01,0.03,0.1,0.3,1.0,3.0,10.0],"xaxis":"x","y":[1.117872264502906,1.1178791739120013,1.1179477869887697,1.1183712730578161,1.1203863342078921,1.124957034457939,1.1362498324101795],"yaxis":"y","type":"scatter"},{"hovertemplate":"variable=validation\u003cbr\u003ealpha=%{x}\u003cbr\u003eloss=%{y}\u003cextra\u003e\u003c\u002fextra\u003e","legendgroup":"validation","line":{"color":"#EF553B","dash":"solid"},"marker":{"symbol":"circle"},"mode":"lines","name":"validation","orientation":"v","showlegend":true,"x":[0.01,0.03,0.1,0.3,1.0,3.0,10.0],"xaxis":"x","y":[1.0953497851624219,1.0952721550985403,1.0950143359697406,1.094372868614584,1.0927899276983932,1.0907544817483366,1.0915891078725117],"yaxis":"y","type":"scatter"}],                        {"template":{"data":{"histogram2dcontour":[{"type":"histogram2dcontour","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"choropleth":[{"type":"choropleth","colorbar":{"outlinewidth":0,"ticks":""}}],"histogram2d":[{"type":"histogram2d","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"heatmap":[{"type":"heatmap","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"heatmapgl":[{"type":"heatmapgl","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"contourcarpet":[{"type":"contourcarpet","colorbar":{"outlinewidth":0,"ticks":""}}],"contour":[{"type":"contour","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"surface":[{"type":"surface","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"mesh3d":[{"type":"mesh3d","colorbar":{"outlinewidth":0,"ticks":""}}],"scatter":[{"fillpattern":{"fillmode":"overlay","size":10,"solidity":0.2},"type":"scatter"}],"parcoords":[{"type":"parcoords","line":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scatterpolargl":[{"type":"scatterpolargl","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"bar":[{"error_x":{"color":"#2a3f5f"},"error_y":{"color":"#2a3f5f"},"marker":{"line":{"color":"#E5ECF6","width":0.5},"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"bar"}],"scattergeo":[{"type":"scattergeo","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scatterpolar":[{"type":"scatterpolar","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"histogram":[{"marker":{"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"histogram"}],"scattergl":[{"type":"scattergl","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scatter3d":[{"type":"scatter3d","line":{"colorbar":{"outlinewidth":0,"ticks":""}},"marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scattermapbox":[{"type":"scattermapbox","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scatterternary":[{"type":"scatterternary","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scattercarpet":[{"type":"scattercarpet","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"carpet":[{"aaxis":{"endlinecolor":"#2a3f5f","gridcolor":"white","linecolor":"white","minorgridcolor":"white","startlinecolor":"#2a3f5f"},"baxis":{"endlinecolor":"#2a3f5f","gridcolor":"white","linecolor":"white","minorgridcolor":"white","startlinecolor":"#2a3f5f"},"type":"carpet"}],"table":[{"cells":{"fill":{"color":"#EBF0F8"},"line":{"color":"white"}},"header":{"fill":{"color":"#C8D4E3"},"line":{"color":"white"}},"type":"table"}],"barpolar":[{"marker":{"line":{"color":"#E5ECF6","width":0.5},"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"barpolar"}],"pie":[{"automargin":true,"type":"pie"}]},"layout":{"autotypenumbers":"strict","colorway":["#636efa","#EF553B","#00cc96","#ab63fa","#FFA15A","#19d3f3","#FF6692","#B6E880","#FF97FF","#FECB52"],"font":{"color":"#2a3f5f"},"hovermode":"closest","hoverlabel":{"align":"left"},"paper_bgcolor":"white","plot_bgcolor":"#E5ECF6","polar":{"bgcolor":"#E5ECF6","angularaxis":{"gridcolor":"white","linecolor":"white","ticks":""},"radialaxis":{"gridcolor":"white","linecolor":"white","ticks":""}},"ternary":{"bgcolor":"#E5ECF6","aaxis":{"gridcolor":"white","linecolor":"white","ticks":""},"baxis":{"gridcolor":"white","linecolor":"white","ticks":""},"caxis":{"gridcolor":"white","linecolor":"white","ticks":""}},"coloraxis":{"colorbar":{"outlinewidth":0,"ticks":""}},"colorscale":{"sequential":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"sequentialminus":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"diverging":[[0,"#8e0152"],[0.1,"#c51b7d"],[0.2,"#de77ae"],[0.3,"#f1b6da"],[0.4,"#fde0ef"],[0.5,"#f7f7f7"],[0.6,"#e6f5d0"],[0.7,"#b8e186"],[0.8,"#7fbc41"],[0.9,"#4d9221"],[1,"#276419"]]},"xaxis":{"gridcolor":"white","linecolor":"white","ticks":"","title":{"standoff":15},"zerolinecolor":"white","automargin":true,"zerolinewidth":2},"yaxis":{"gridcolor":"white","linecolor":"white","ticks":"","title":{"standoff":15},"zerolinecolor":"white","automargin":true,"zerolinewidth":2},"scene":{"xaxis":{"backgroundcolor":"#E5ECF6","gridcolor":"white","linecolor":"white","showbackground":true,"ticks":"","zerolinecolor":"white","gridwidth":2},"yaxis":{"backgroundcolor":"#E5ECF6","gridcolor":"white","linecolor":"white","showbackground":true,"ticks":"","zerolinecolor":"white","gridwidth":2},"zaxis":{"backgroundcolor":"#E5ECF6","gridcolor":"white","linecolor":"white","showbackground":true,"ticks":"","zerolinecolor":"white","gridwidth":2}},"shapedefaults":{"line":{"color":"#2a3f5f"}},"annotationdefaults":{"arrowcolor":"#2a3f5f","arrowhead":0,"arrowwidth":1},"geo":{"bgcolor":"white","landcolor":"#E5ECF6","subunitcolor":"white","showland":true,"showlakes":true,"lakecolor":"white"},"title":{"x":0.05},"mapbox":{"style":"light"}}},"xaxis":{"anchor":"y","domain":[0.0,1.0],"title":{"text":"alpha"},"type":"log"},"yaxis":{"anchor":"x","domain":[0.0,1.0],"title":{"text":"loss"}},"legend":{"title":{"text":"variable"},"tracegroupgap":0},"margin":{"t":60}},                        {"responsive": true}                    )                };                            </script>        </div>

This suggests that the best value is 1.0 since this gives the same loss on the validation and test sets. We can now fit a model on the combined train and validation set.


```python
linear_model = Ridge(alpha=1.0)
linear_model.fit(_transform(X_train_val), y_train_val)
```

This model captures the central part of the distribution quite well, but fails to predict the very high or low ratings.


```python
pd.DataFrame(
    {"true": y_train_val, "prediction": np.round(linear_model.predict(_transform(X_train_val)), decimals=0)}
).hist(histnorm="percent", barmode="group")
```

<div>                        <script type="text/javascript">window.PlotlyConfig = {MathJaxConfig: 'local'};</script>
        <script charset="utf-8" src="https://cdn.plot.ly/plotly-2.24.1.min.js"></script>                <div id="a7e84fdc-61ff-4ae7-a0f3-d198b86054fb" class="plotly-graph-div" style="height:100%; width:100%;"></div>            <script type="text/javascript">                                    window.PLOTLYENV=window.PLOTLYENV || {};                                    if (document.getElementById("a7e84fdc-61ff-4ae7-a0f3-d198b86054fb")) {                    Plotly.newPlot(                        "a7e84fdc-61ff-4ae7-a0f3-d198b86054fb",                        [{"alignmentgroup":"True","bingroup":"x","histnorm":"percent","hovertemplate":"variable=true\u003cbr\u003erating=%{x}\u003cbr\u003epercent=%{y}\u003cextra\u003e\u003c\u002fextra\u003e","legendgroup":"true","marker":{"color":"#636efa","pattern":{"shape":""}},"name":"true","offsetgroup":"true","orientation":"v","showlegend":true,"x":[94.0,96.0,94.0,94.0,94.0,93.0,93.0,95.0,91.0,93.0,94.0,94.0,94.0,96.0,93.0,94.0,95.0,94.0,94.0,94.0,93.0,95.0,94.0,93.0,93.0,95.0,93.0,95.0,94.0,94.0,94.0,91.0,93.0,96.0,94.0,95.0,92.0,92.0,92.0,93.0,84.0,95.0,93.0,93.0,94.0,93.0,94.0,91.0,92.0,93.0,93.0,92.0,92.0,94.0,95.0,94.0,94.0,91.0,94.0,94.0,96.0,93.0,94.0,94.0,93.0,90.0,93.0,95.0,94.0,94.0,94.0,94.0,94.0,94.0,95.0,91.0,95.0,93.0,92.0,92.0,93.0,92.0,92.0,93.0,93.0,95.0,91.0,93.0,93.0,92.0,92.0,92.0,93.0,91.0,94.0,93.0,93.0,93.0,94.0,93.0,94.0,94.0,93.0,93.0,90.0,96.0,92.0,94.0,93.0,94.0,92.0,94.0,92.0,95.0,93.0,92.0,93.0,94.0,94.0,90.0,93.0,92.0,93.0,95.0,92.0,94.0,94.0,93.0,94.0,93.0,90.0,95.0,91.0,93.0,95.0,93.0,93.0,91.0,93.0,93.0,94.0,93.0,94.0,96.0,92.0,93.0,93.0,93.0,92.0,93.0,93.0,95.0,90.0,93.0,95.0,93.0,96.0,93.0,90.0,96.0,93.0,92.0,94.0,94.0,92.0,94.0,94.0,93.0,91.0,91.0,95.0,95.0,93.0,95.0,95.0,92.0,93.0,94.0,93.0,93.0,94.0,94.0,95.0,90.0,91.0,93.0,93.0,94.0,93.0,93.0,93.0,94.0,93.0,93.0,94.0,94.0,92.0,93.0,95.0,93.0,94.0,94.0,93.0,94.0,92.0,94.0,94.0,92.0,92.0,95.0,94.0,93.0,93.0,94.0,94.0,94.0,94.0,96.0,93.0,92.0,93.0,94.0,94.0,93.0,93.0,90.0,94.0,93.0,93.0,94.0,96.0,96.0,94.0,93.0,93.0,95.0,91.0,91.0,94.0,94.0,94.0,94.0,94.0,95.0,93.0,92.0,95.0,90.0,93.0,92.0,93.0,94.0,95.0,94.0,93.0,94.0,95.0,94.0,95.0,94.0,95.0,95.0,94.0,94.0,90.0,93.0,92.0,93.0,92.0,95.0,92.0,94.0,94.0,93.0,93.0,96.0,95.0,95.0,93.0,95.0,94.0,94.0,93.0,93.0,93.0,95.0,95.0,94.0,94.0,93.0,93.0,92.0,94.0,94.0,90.0,95.0,93.0,93.0,94.0,94.0,92.0,94.0,92.0,92.0,96.0,95.0,92.0,93.0,95.0,94.0,94.0,92.0,93.0,90.0,95.0,94.0,95.0,93.0,93.0,93.0,93.0,95.0,92.0,94.0,97.0,90.0,95.0,93.0,92.0,93.0,93.0,91.0,92.0,91.0,92.0,92.0,94.0,94.0,95.0,93.0,92.0,96.0,94.0,95.0,92.0,92.0,93.0,97.0,94.0,94.0,94.0,94.0,94.0,93.0,93.0,93.0,94.0,93.0,90.0,95.0,93.0,93.0,92.0,93.0,97.0,94.0,94.0,95.0,93.0,93.0,93.0,92.0,93.0,94.0,92.0,92.0,93.0,94.0,93.0,95.0,94.0,93.0,94.0,93.0,93.0,92.0,93.0,93.0,91.0,95.0,91.0,93.0,96.0,91.0,94.0,93.0,93.0,94.0,94.0,95.0,95.0,94.0,86.0,91.0,91.0,91.0,94.0,93.0,93.0,94.0,92.0,92.0,94.0,94.0,95.0,91.0,95.0,94.0,94.0,94.0,93.0,94.0,94.0,95.0,94.0,94.0,94.0,90.0,94.0,94.0,95.0,92.0,94.0,94.0,94.0,93.0,91.0,93.0,93.0,94.0,94.0,93.0,93.0,90.0,94.0,96.0,94.0,93.0,95.0,93.0,96.0,94.0,93.0,93.0,93.0,93.0,94.0,93.0,92.0,93.0,95.0,94.0,92.0,94.0,92.0,93.0,94.0,88.0,93.0,94.0,93.0,94.0,93.0,89.0,87.0,94.0,93.0,96.0,93.0,92.0,97.0,93.0,95.0,93.0,95.0,92.0,91.0,95.0,90.0,94.0,95.0,93.0,95.0,93.0,93.0,94.0,92.0,92.0,96.0,94.0,95.0,94.0,92.0,95.0,94.0,94.0,92.0,95.0,93.0,88.0,95.0,95.0,94.0,94.0,92.0,95.0,95.0,94.0,94.0,94.0,94.0,92.0,90.0,92.0,94.0,95.0,95.0,93.0,93.0,92.0,93.0,93.0,94.0,94.0,93.0,93.0,90.0,95.0,95.0,93.0,94.0,93.0,94.0,94.0,93.0,94.0,93.0,94.0,93.0,94.0,93.0,93.0,93.0,90.0,94.0,93.0,94.0,92.0,93.0,94.0,93.0,94.0,94.0,94.0,92.0,94.0,93.0,93.0,94.0,90.0,93.0,93.0,93.0,92.0,94.0,93.0,95.0,92.0,94.0,95.0,95.0,93.0,95.0,95.0,94.0,93.0,94.0,94.0,92.0,94.0,97.0,92.0,94.0,94.0,95.0,95.0,94.0,95.0,94.0,92.0,94.0,92.0,92.0,93.0,95.0,94.0,91.0,94.0,93.0,91.0,92.0,95.0,93.0,92.0,93.0,96.0,93.0,94.0,94.0,95.0,94.0,93.0,96.0,90.0,94.0,95.0,94.0,93.0,93.0,93.0,95.0,95.0,95.0,94.0,95.0,95.0,94.0,94.0,92.0,93.0,96.0,96.0,94.0,94.0,95.0,93.0,94.0,94.0,95.0,92.0,92.0,94.0,90.0,91.0,94.0,94.0,94.0,93.0,94.0,94.0,94.0,92.0,92.0,94.0,94.0,95.0,92.0,93.0,94.0,94.0,92.0,95.0,93.0,94.0,95.0,93.0,93.0,96.0,94.0,94.0,91.0,93.0,93.0,93.0,93.0,93.0,94.0,93.0,93.0,94.0,90.0,93.0,93.0,96.0,95.0,93.0,93.0,94.0,91.0,92.0,92.0,93.0,93.0,95.0,93.0,93.0,95.0,93.0,94.0,93.0,94.0,93.0,92.0,93.0,95.0,96.0,95.0,94.0,92.0,95.0,95.0,92.0,93.0,92.0,93.0,93.0,94.0,93.0,95.0,91.0,94.0,93.0,94.0,94.0,93.0,93.0,95.0,94.0,92.0,93.0,93.0,92.0,94.0,93.0,92.0,92.0,92.0,92.0,93.0,95.0,93.0,97.0,92.0,96.0,92.0,95.0,90.0,95.0,92.0,92.0,94.0,95.0,94.0,95.0,93.0,93.0,93.0,93.0,96.0,93.0,93.0,94.0,95.0,93.0,93.0,91.0,91.0,93.0,93.0,92.0,94.0,90.0,93.0,94.0,93.0,94.0,94.0,94.0,94.0,94.0,91.0,94.0,92.0,92.0,93.0,94.0,91.0,93.0,93.0,93.0,93.0,93.0,94.0,93.0,92.0,93.0,94.0,94.0,94.0,93.0,93.0,92.0,95.0,93.0,94.0,95.0,92.0,97.0,92.0,95.0,93.0,91.0,91.0,93.0,92.0,93.0,92.0,95.0,93.0,95.0,93.0,94.0,93.0,94.0,92.0,95.0,94.0,94.0,92.0,93.0,94.0,90.0,94.0,93.0,94.0,93.0,91.0,92.0,94.0,93.0,92.0,92.0,92.0,97.0,91.0,91.0,95.0,92.0,95.0,94.0,91.0,93.0,95.0,92.0,95.0,92.0,93.0,90.0,90.0,91.0,94.0,91.0,95.0,95.0,95.0,93.0,92.0,94.0,93.0,93.0,92.0,94.0,90.0,94.0,95.0,95.0,93.0,94.0,94.0,93.0,93.0,93.0,94.0,94.0,95.0,94.0,95.0,94.0,94.0,93.0,93.0,95.0,92.0,94.0,92.0,93.0,94.0,91.0,94.0,92.0,93.0,93.0,92.0,94.0,92.0,92.0,92.0,93.0,93.0,93.0,95.0,95.0,90.0,95.0,95.0,92.0,93.0,93.0,94.0,94.0,94.0,95.0,95.0,96.0,90.0,93.0,95.0,95.0,92.0,94.0,91.0,90.0,91.0,94.0,95.0,95.0,94.0,93.0,94.0,95.0,92.0,92.0,94.0,95.0,94.0,94.0,89.0,94.0,93.0,94.0,93.0,94.0,92.0,97.0,91.0,93.0,94.0,93.0,93.0,92.0,93.0,94.0,95.0,94.0,93.0,94.0,92.0,91.0,93.0,93.0,93.0,92.0,94.0,93.0,94.0,93.0,93.0,92.0,93.0,88.0,93.0,96.0,94.0,94.0,92.0,93.0],"xaxis":"x","yaxis":"y","type":"histogram"},{"alignmentgroup":"True","bingroup":"x","histnorm":"percent","hovertemplate":"variable=prediction\u003cbr\u003erating=%{x}\u003cbr\u003epercent=%{y}\u003cextra\u003e\u003c\u002fextra\u003e","legendgroup":"prediction","marker":{"color":"#EF553B","pattern":{"shape":""}},"name":"prediction","offsetgroup":"prediction","orientation":"v","showlegend":true,"x":[94.0,95.0,94.0,94.0,94.0,93.0,92.0,94.0,92.0,92.0,94.0,94.0,94.0,94.0,93.0,93.0,95.0,93.0,94.0,93.0,93.0,93.0,94.0,92.0,93.0,95.0,92.0,94.0,94.0,94.0,94.0,93.0,94.0,95.0,94.0,94.0,92.0,91.0,93.0,93.0,91.0,93.0,93.0,93.0,93.0,94.0,95.0,93.0,91.0,93.0,93.0,93.0,93.0,94.0,94.0,93.0,94.0,93.0,94.0,94.0,95.0,93.0,93.0,93.0,91.0,91.0,92.0,94.0,94.0,93.0,94.0,94.0,94.0,94.0,94.0,93.0,94.0,94.0,93.0,93.0,93.0,93.0,93.0,93.0,93.0,96.0,92.0,93.0,92.0,92.0,94.0,92.0,93.0,92.0,93.0,92.0,94.0,93.0,94.0,92.0,92.0,95.0,93.0,94.0,93.0,94.0,93.0,95.0,92.0,95.0,92.0,94.0,93.0,93.0,93.0,93.0,93.0,93.0,94.0,92.0,92.0,93.0,93.0,94.0,93.0,93.0,92.0,92.0,93.0,93.0,91.0,94.0,93.0,93.0,95.0,94.0,93.0,93.0,93.0,94.0,93.0,93.0,93.0,95.0,92.0,94.0,94.0,94.0,93.0,93.0,94.0,93.0,91.0,93.0,95.0,94.0,95.0,94.0,92.0,96.0,94.0,92.0,93.0,93.0,94.0,93.0,93.0,93.0,92.0,90.0,94.0,95.0,95.0,95.0,94.0,94.0,92.0,93.0,93.0,93.0,93.0,93.0,95.0,92.0,93.0,93.0,92.0,94.0,93.0,93.0,94.0,93.0,93.0,92.0,94.0,93.0,93.0,92.0,93.0,92.0,94.0,93.0,93.0,94.0,93.0,93.0,94.0,92.0,93.0,94.0,93.0,93.0,93.0,94.0,93.0,94.0,93.0,96.0,93.0,94.0,93.0,94.0,94.0,93.0,93.0,93.0,94.0,93.0,93.0,94.0,94.0,94.0,93.0,94.0,93.0,94.0,92.0,91.0,93.0,93.0,94.0,93.0,93.0,94.0,94.0,92.0,94.0,93.0,93.0,93.0,94.0,94.0,93.0,93.0,94.0,94.0,94.0,93.0,94.0,94.0,93.0,94.0,92.0,94.0,93.0,92.0,93.0,95.0,93.0,95.0,93.0,92.0,93.0,92.0,94.0,94.0,93.0,94.0,94.0,94.0,95.0,93.0,93.0,94.0,92.0,93.0,94.0,94.0,94.0,93.0,93.0,91.0,93.0,93.0,92.0,93.0,94.0,93.0,94.0,93.0,93.0,93.0,94.0,93.0,96.0,95.0,92.0,94.0,94.0,94.0,93.0,93.0,93.0,92.0,96.0,93.0,95.0,93.0,93.0,93.0,93.0,94.0,94.0,94.0,96.0,92.0,93.0,94.0,93.0,93.0,93.0,93.0,93.0,92.0,93.0,92.0,93.0,95.0,93.0,92.0,92.0,94.0,93.0,94.0,94.0,92.0,93.0,94.0,93.0,94.0,95.0,93.0,93.0,93.0,93.0,94.0,93.0,93.0,92.0,95.0,94.0,94.0,93.0,93.0,94.0,94.0,93.0,95.0,93.0,93.0,94.0,93.0,93.0,93.0,93.0,94.0,93.0,93.0,93.0,94.0,94.0,93.0,95.0,92.0,94.0,92.0,93.0,93.0,92.0,93.0,92.0,93.0,95.0,92.0,94.0,93.0,93.0,94.0,95.0,94.0,94.0,93.0,90.0,93.0,93.0,92.0,95.0,93.0,92.0,93.0,94.0,93.0,94.0,93.0,93.0,92.0,93.0,93.0,93.0,95.0,95.0,94.0,93.0,94.0,93.0,93.0,94.0,91.0,94.0,93.0,93.0,92.0,94.0,94.0,94.0,91.0,92.0,93.0,94.0,93.0,93.0,93.0,93.0,93.0,94.0,94.0,94.0,94.0,94.0,93.0,94.0,93.0,92.0,93.0,93.0,92.0,94.0,94.0,92.0,94.0,93.0,93.0,92.0,94.0,93.0,93.0,93.0,91.0,93.0,94.0,92.0,94.0,93.0,92.0,91.0,94.0,93.0,94.0,92.0,93.0,95.0,93.0,93.0,93.0,94.0,92.0,93.0,95.0,92.0,92.0,96.0,93.0,95.0,93.0,94.0,94.0,93.0,94.0,95.0,94.0,95.0,94.0,94.0,94.0,93.0,94.0,91.0,94.0,93.0,91.0,93.0,93.0,94.0,92.0,93.0,95.0,93.0,93.0,95.0,94.0,93.0,93.0,92.0,93.0,93.0,93.0,94.0,92.0,93.0,93.0,93.0,91.0,93.0,94.0,93.0,94.0,93.0,96.0,94.0,94.0,93.0,92.0,93.0,95.0,93.0,93.0,93.0,94.0,93.0,94.0,93.0,93.0,94.0,92.0,94.0,93.0,94.0,93.0,93.0,93.0,94.0,93.0,95.0,93.0,93.0,95.0,94.0,93.0,93.0,93.0,93.0,94.0,93.0,92.0,93.0,92.0,93.0,93.0,94.0,93.0,95.0,93.0,94.0,96.0,94.0,93.0,93.0,93.0,93.0,94.0,95.0,93.0,94.0,94.0,94.0,94.0,94.0,93.0,94.0,93.0,92.0,93.0,91.0,92.0,94.0,93.0,93.0,95.0,92.0,92.0,93.0,94.0,92.0,92.0,94.0,96.0,96.0,93.0,94.0,94.0,94.0,94.0,94.0,92.0,94.0,93.0,94.0,91.0,92.0,94.0,95.0,95.0,94.0,94.0,94.0,95.0,94.0,94.0,92.0,93.0,94.0,95.0,94.0,93.0,93.0,92.0,94.0,93.0,94.0,93.0,93.0,94.0,92.0,92.0,95.0,94.0,94.0,93.0,93.0,93.0,95.0,92.0,94.0,93.0,93.0,94.0,93.0,93.0,94.0,94.0,93.0,93.0,94.0,93.0,93.0,94.0,93.0,95.0,95.0,93.0,92.0,93.0,94.0,92.0,94.0,93.0,93.0,93.0,94.0,94.0,92.0,92.0,93.0,94.0,95.0,93.0,94.0,94.0,93.0,95.0,93.0,93.0,93.0,94.0,94.0,93.0,94.0,92.0,93.0,93.0,93.0,95.0,91.0,90.0,93.0,95.0,94.0,93.0,93.0,94.0,94.0,94.0,93.0,93.0,93.0,93.0,95.0,93.0,95.0,92.0,94.0,94.0,93.0,94.0,93.0,94.0,94.0,93.0,93.0,93.0,93.0,93.0,93.0,94.0,94.0,93.0,93.0,93.0,94.0,94.0,94.0,94.0,91.0,95.0,93.0,94.0,93.0,94.0,92.0,93.0,93.0,95.0,94.0,94.0,93.0,93.0,95.0,93.0,94.0,93.0,93.0,93.0,95.0,93.0,92.0,93.0,94.0,93.0,93.0,93.0,93.0,92.0,92.0,94.0,92.0,94.0,91.0,94.0,94.0,95.0,93.0,94.0,92.0,93.0,93.0,94.0,93.0,93.0,94.0,92.0,93.0,93.0,93.0,93.0,94.0,93.0,94.0,93.0,96.0,93.0,93.0,93.0,92.0,93.0,94.0,94.0,92.0,95.0,94.0,94.0,93.0,93.0,93.0,93.0,93.0,93.0,93.0,94.0,92.0,93.0,93.0,94.0,96.0,94.0,92.0,94.0,94.0,93.0,91.0,94.0,93.0,93.0,94.0,92.0,94.0,94.0,91.0,93.0,94.0,93.0,92.0,94.0,93.0,95.0,92.0,93.0,93.0,93.0,94.0,94.0,93.0,93.0,95.0,93.0,94.0,93.0,93.0,92.0,92.0,94.0,94.0,93.0,94.0,94.0,93.0,94.0,93.0,92.0,93.0,94.0,92.0,95.0,92.0,93.0,94.0,96.0,94.0,94.0,94.0,93.0,93.0,93.0,94.0,93.0,95.0,94.0,95.0,93.0,96.0,92.0,93.0,93.0,93.0,94.0,93.0,92.0,94.0,92.0,94.0,93.0,94.0,92.0,93.0,94.0,94.0,94.0,93.0,93.0,93.0,94.0,94.0,94.0,92.0,93.0,94.0,92.0,92.0,92.0,94.0,94.0,94.0,94.0,94.0,95.0,91.0,93.0,95.0,94.0,93.0,94.0,92.0,93.0,93.0,93.0,94.0,95.0,93.0,93.0,94.0,94.0,93.0,92.0,92.0,94.0,93.0,93.0,90.0,93.0,93.0,94.0,93.0,93.0,92.0,95.0,92.0,93.0,93.0,93.0,93.0,93.0,94.0,94.0,93.0,94.0,94.0,93.0,94.0,93.0,93.0,93.0,94.0,92.0,93.0,93.0,94.0,93.0,93.0,92.0,93.0,90.0,93.0,93.0,94.0,94.0,92.0,93.0],"xaxis":"x","yaxis":"y","type":"histogram"}],                        {"template":{"data":{"histogram2dcontour":[{"type":"histogram2dcontour","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"choropleth":[{"type":"choropleth","colorbar":{"outlinewidth":0,"ticks":""}}],"histogram2d":[{"type":"histogram2d","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"heatmap":[{"type":"heatmap","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"heatmapgl":[{"type":"heatmapgl","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"contourcarpet":[{"type":"contourcarpet","colorbar":{"outlinewidth":0,"ticks":""}}],"contour":[{"type":"contour","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"surface":[{"type":"surface","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"mesh3d":[{"type":"mesh3d","colorbar":{"outlinewidth":0,"ticks":""}}],"scatter":[{"fillpattern":{"fillmode":"overlay","size":10,"solidity":0.2},"type":"scatter"}],"parcoords":[{"type":"parcoords","line":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scatterpolargl":[{"type":"scatterpolargl","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"bar":[{"error_x":{"color":"#2a3f5f"},"error_y":{"color":"#2a3f5f"},"marker":{"line":{"color":"#E5ECF6","width":0.5},"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"bar"}],"scattergeo":[{"type":"scattergeo","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scatterpolar":[{"type":"scatterpolar","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"histogram":[{"marker":{"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"histogram"}],"scattergl":[{"type":"scattergl","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scatter3d":[{"type":"scatter3d","line":{"colorbar":{"outlinewidth":0,"ticks":""}},"marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scattermapbox":[{"type":"scattermapbox","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scatterternary":[{"type":"scatterternary","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scattercarpet":[{"type":"scattercarpet","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"carpet":[{"aaxis":{"endlinecolor":"#2a3f5f","gridcolor":"white","linecolor":"white","minorgridcolor":"white","startlinecolor":"#2a3f5f"},"baxis":{"endlinecolor":"#2a3f5f","gridcolor":"white","linecolor":"white","minorgridcolor":"white","startlinecolor":"#2a3f5f"},"type":"carpet"}],"table":[{"cells":{"fill":{"color":"#EBF0F8"},"line":{"color":"white"}},"header":{"fill":{"color":"#C8D4E3"},"line":{"color":"white"}},"type":"table"}],"barpolar":[{"marker":{"line":{"color":"#E5ECF6","width":0.5},"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"barpolar"}],"pie":[{"automargin":true,"type":"pie"}]},"layout":{"autotypenumbers":"strict","colorway":["#636efa","#EF553B","#00cc96","#ab63fa","#FFA15A","#19d3f3","#FF6692","#B6E880","#FF97FF","#FECB52"],"font":{"color":"#2a3f5f"},"hovermode":"closest","hoverlabel":{"align":"left"},"paper_bgcolor":"white","plot_bgcolor":"#E5ECF6","polar":{"bgcolor":"#E5ECF6","angularaxis":{"gridcolor":"white","linecolor":"white","ticks":""},"radialaxis":{"gridcolor":"white","linecolor":"white","ticks":""}},"ternary":{"bgcolor":"#E5ECF6","aaxis":{"gridcolor":"white","linecolor":"white","ticks":""},"baxis":{"gridcolor":"white","linecolor":"white","ticks":""},"caxis":{"gridcolor":"white","linecolor":"white","ticks":""}},"coloraxis":{"colorbar":{"outlinewidth":0,"ticks":""}},"colorscale":{"sequential":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"sequentialminus":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"diverging":[[0,"#8e0152"],[0.1,"#c51b7d"],[0.2,"#de77ae"],[0.3,"#f1b6da"],[0.4,"#fde0ef"],[0.5,"#f7f7f7"],[0.6,"#e6f5d0"],[0.7,"#b8e186"],[0.8,"#7fbc41"],[0.9,"#4d9221"],[1,"#276419"]]},"xaxis":{"gridcolor":"white","linecolor":"white","ticks":"","title":{"standoff":15},"zerolinecolor":"white","automargin":true,"zerolinewidth":2},"yaxis":{"gridcolor":"white","linecolor":"white","ticks":"","title":{"standoff":15},"zerolinecolor":"white","automargin":true,"zerolinewidth":2},"scene":{"xaxis":{"backgroundcolor":"#E5ECF6","gridcolor":"white","linecolor":"white","showbackground":true,"ticks":"","zerolinecolor":"white","gridwidth":2},"yaxis":{"backgroundcolor":"#E5ECF6","gridcolor":"white","linecolor":"white","showbackground":true,"ticks":"","zerolinecolor":"white","gridwidth":2},"zaxis":{"backgroundcolor":"#E5ECF6","gridcolor":"white","linecolor":"white","showbackground":true,"ticks":"","zerolinecolor":"white","gridwidth":2}},"shapedefaults":{"line":{"color":"#2a3f5f"}},"annotationdefaults":{"arrowcolor":"#2a3f5f","arrowhead":0,"arrowwidth":1},"geo":{"bgcolor":"white","landcolor":"#E5ECF6","subunitcolor":"white","showland":true,"showlakes":true,"lakecolor":"white"},"title":{"x":0.05},"mapbox":{"style":"light"}}},"xaxis":{"anchor":"y","domain":[0.0,1.0],"title":{"text":"rating"}},"yaxis":{"anchor":"x","domain":[0.0,1.0],"title":{"text":"percent"}},"legend":{"title":{"text":"variable"},"tracegroupgap":0},"margin":{"t":60},"barmode":"group"},                        {"responsive": true}                    )                };                            </script>        </div>

### Gradient-boosted trees

```python
import xgboost as xgb

eval_sets = {
    "train": (_transform(X_train), y_train),
    "validation": (_transform(X_val), y_val),
}

scores = {}
for max_depth in [1, 2, 3, 4, 5]:
    xgb_params = {
        'max_depth': max_depth,
        'min_child_weight': 1,
        'objective': 'reg:squarederror',
        'seed': 1,
        'verbosity': 1,
    }

    model = xgb.XGBRegressor(**xgb_params, eval_metric="rmse")
    model.fit(_transform(X_train), y_train, eval_set=list(eval_sets.values()))

    results = model.evals_result()
    scores[max_depth] = pd.DataFrame({k: results[f"validation_{i}"]["rmse"] for i, k in enumerate(eval_sets)})

pd.DataFrame({depth: df["validation"] for depth, df in scores.items()}).plot(
    labels={"index": "n_estimators", "variable": "max_depth", "value": "rmse"}
)
```

<div>                        <script type="text/javascript">window.PlotlyConfig = {MathJaxConfig: 'local'};</script>
        <script charset="utf-8" src="https://cdn.plot.ly/plotly-2.24.1.min.js"></script>                <div id="fa3ade45-fb85-462b-ad3d-4276287f4086" class="plotly-graph-div" style="height:100%; width:100%;"></div>            <script type="text/javascript">                                    window.PLOTLYENV=window.PLOTLYENV || {};                                    if (document.getElementById("fa3ade45-fb85-462b-ad3d-4276287f4086")) {                    Plotly.newPlot(                        "fa3ade45-fb85-462b-ad3d-4276287f4086",                        [{"hovertemplate":"max_depth=1\u003cbr\u003en_estimators=%{x}\u003cbr\u003ermse=%{y}\u003cextra\u003e\u003c\u002fextra\u003e","legendgroup":"1","line":{"color":"#636efa","dash":"solid"},"marker":{"symbol":"circle"},"mode":"lines","name":"1","orientation":"v","showlegend":true,"x":[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72,73,74,75,76,77,78,79,80,81,82,83,84,85,86,87,88,89,90,91,92,93,94,95,96,97,98,99],"xaxis":"x","y":[1.3388515210227436,1.3210679239717604,1.30678604708734,1.2836352205375894,1.2690629401764293,1.257043034926485,1.237615553808457,1.2279020395393145,1.2093596298639124,1.1980735638998465,1.1904520988210456,1.1864843495548452,1.1756306670264447,1.1744473907983757,1.1689707348235314,1.159906919500153,1.1566128572874022,1.1549509666222708,1.1486054818391214,1.1429657869009122,1.1429329700008184,1.1378392392811656,1.1362922500949904,1.1275981776792812,1.1242695311262838,1.120968576133572,1.1202668751902594,1.1200550513070398,1.1173856872836856,1.1184483288441587,1.1151031653884727,1.1202837735497355,1.1160697968199214,1.1126822881637513,1.1127017577660203,1.1106360543347071,1.1100760175640634,1.10894807466146,1.1100820130245246,1.108137727886561,1.108183251638726,1.1072848208832717,1.1025130363935722,1.1010641198122761,1.1010950907132606,1.1006426575093695,1.099144126851038,1.0994317270021738,1.0994491209650472,1.0992128331750286,1.095885314699277,1.0945824754436242,1.0931762058878416,1.0928312456917173,1.0920905167021229,1.093322848977398,1.0907418741580053,1.0907550947784914,1.088283737057983,1.088648048958019,1.0886317383065234,1.0852814207302979,1.0855629413189858,1.0855875212081625,1.0848684921806282,1.0847460046379107,1.0814959460362985,1.0806270770950694,1.0818820157603106,1.0818675189770182,1.0818808667559008,1.0808961305604567,1.0808840225229537,1.0805426383845493,1.079651340151075,1.07945526333311,1.0788663463901624,1.077791556062864,1.0811696176040797,1.0795631347819248,1.0794668851622156,1.0799650879765663,1.0804357108738785,1.0798917724839747,1.0795735047509716,1.0777032473764345,1.0777149246951652,1.07768903766811,1.077153544452605,1.0749488741190798,1.0749337791903164,1.074167419377661,1.0760635982414186,1.0764493498131684,1.0764386188506623,1.076461421560222,1.0776264544242942,1.076196528201645,1.075021880091515,1.074430847878214],"yaxis":"y","type":"scatter"},{"hovertemplate":"max_depth=2\u003cbr\u003en_estimators=%{x}\u003cbr\u003ermse=%{y}\u003cextra\u003e\u003c\u002fextra\u003e","legendgroup":"2","line":{"color":"#EF553B","dash":"solid"},"marker":{"symbol":"circle"},"mode":"lines","name":"2","orientation":"v","showlegend":true,"x":[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72,73,74,75,76,77,78,79,80,81,82,83,84,85,86,87,88,89,90,91,92,93,94,95,96,97,98,99],"xaxis":"x","y":[1.315613713546455,1.2767503018029878,1.2292141665436163,1.1969721405119162,1.171190611949883,1.149626048841875,1.1296758727700453,1.1205358485483214,1.117150274984252,1.101318035426784,1.0931640802458038,1.0871297467271899,1.0928453367382966,1.0892585987602759,1.0817894018061738,1.0765948565285197,1.0744019792695985,1.0695085935778859,1.0679514184487542,1.067166007495959,1.0666625230907834,1.065077803607434,1.0630419972229839,1.0572750689452655,1.0565070374238483,1.05548003499332,1.0539426979588622,1.0501880435553455,1.0474903972767122,1.0442110253868229,1.0476867348531629,1.0469562501833303,1.044733084901106,1.0443844212987656,1.0429704317809299,1.0432081806316147,1.0428815776164193,1.042946739684442,1.0432532551099347,1.0434383608171935,1.042274719507756,1.04139101376533,1.0412234737961947,1.0396147121612176,1.0367738449020767,1.0332184174681913,1.033589676084699,1.0325452964353745,1.0309164616909756,1.0307025656993374,1.0305854596598114,1.030495135096686,1.0309751523283952,1.031975077815659,1.032567071754956,1.033983283365915,1.0317388225521398,1.0314505776119,1.0324884874077067,1.032418412206257,1.0305514624786225,1.0300555472785788,1.0299369105920382,1.0284871300646576,1.0282504291059456,1.0327940956111161,1.0329301068348635,1.0349745801048642,1.0341753518859722,1.0338204257508163,1.0338222460944932,1.0351662489792064,1.0345132366556338,1.0348162117920239,1.033599510588963,1.0329187808492246,1.0335996155882805,1.0345667899414235,1.035299981249758,1.0364114777380977,1.0362768901008121,1.036762629372291,1.0362036517202555,1.0353696566166108,1.0351765865551146,1.035408459883889,1.0354862969735177,1.0368767635044762,1.0380386331274427,1.0390054064712886,1.0371703807440245,1.0363487255052697,1.0365991121662845,1.0373876852432338,1.037434742521766,1.037133313526245,1.0371095351197093,1.038166029442121,1.0359472562591991,1.035841051009428],"yaxis":"y","type":"scatter"},{"hovertemplate":"max_depth=3\u003cbr\u003en_estimators=%{x}\u003cbr\u003ermse=%{y}\u003cextra\u003e\u003c\u002fextra\u003e","legendgroup":"3","line":{"color":"#00cc96","dash":"solid"},"marker":{"symbol":"circle"},"mode":"lines","name":"3","orientation":"v","showlegend":true,"x":[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72,73,74,75,76,77,78,79,80,81,82,83,84,85,86,87,88,89,90,91,92,93,94,95,96,97,98,99],"xaxis":"x","y":[1.2859469342971275,1.2185091394600494,1.1715881008782087,1.126452203352672,1.1192783250709453,1.101462391470501,1.0844582694510574,1.0719238765555184,1.0682202515190102,1.0573847758588812,1.0540355575526514,1.0531511086879368,1.0552093825880458,1.0510820991495935,1.0492881144227724,1.0420324397414444,1.0420943511126541,1.0417272111275147,1.0406350302395442,1.036473896668563,1.033614554877372,1.0307584415220126,1.0315431277823386,1.03000164452374,1.0337361076539449,1.0335067391702892,1.0344861887803882,1.0347813916702029,1.033412768626885,1.0300956883773564,1.0303455352718176,1.0300478650525569,1.0287330226424765,1.026507599396691,1.0275110898017172,1.029074542338612,1.0281571673514038,1.0271902157033375,1.0263360645327413,1.025116756141469,1.023598300607321,1.0214339307943414,1.0205305740445665,1.020255730540292,1.0192535020740099,1.0172520148825566,1.0173324682506624,1.0218937211813461,1.0229937578308903,1.0226972037583626,1.0229880448729816,1.0235157928893444,1.030041458539732,1.0290135258679158,1.027022893935132,1.0279969860836262,1.0284404459506802,1.0281891894594717,1.0283544020200583,1.0289803330199905,1.0256139991774729,1.0280032632711544,1.0288177043490814,1.0287211634855915,1.0284579385850676,1.026373513333557,1.0266468872016183,1.0260256330358601,1.024987601907674,1.0250285175557035,1.0248899088337835,1.02626241321974,1.0260395233002042,1.0250549507248046,1.026172936224927,1.0243544239352391,1.026098349373481,1.0257131843342842,1.0279792139732058,1.0268367574460935,1.0271652846902075,1.0265214814164978,1.027800356882374,1.0299742309820623,1.0285310496299351,1.027394892627657,1.0277094422590116,1.0260891849486062,1.0270967668145,1.0271613107847275,1.028401012851239,1.027285400631874,1.0278301376474293,1.0264476788197356,1.0273223747504447,1.0306561257390672,1.0296657674218868,1.0297756706920147,1.0329844247019118,1.032045143864956],"yaxis":"y","type":"scatter"},{"hovertemplate":"max_depth=4\u003cbr\u003en_estimators=%{x}\u003cbr\u003ermse=%{y}\u003cextra\u003e\u003c\u002fextra\u003e","legendgroup":"4","line":{"color":"#ab63fa","dash":"solid"},"marker":{"symbol":"circle"},"mode":"lines","name":"4","orientation":"v","showlegend":true,"x":[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72,73,74,75,76,77,78,79,80,81,82,83,84,85,86,87,88,89,90,91,92,93,94,95,96,97,98,99],"xaxis":"x","y":[1.2637419570195607,1.199867442375238,1.1507909643192609,1.1184792331122175,1.113811602050914,1.099280499362942,1.087658334830589,1.1025697395182081,1.0980433828657188,1.0942544062857458,1.0924969610276107,1.0892357890548219,1.0885712374789909,1.0869096685058814,1.087406744052764,1.0846559274570209,1.0824991228908027,1.0784487208359297,1.0817867584269152,1.0826737399013324,1.083985380734374,1.0865089579576261,1.0849612669825992,1.0831730637152914,1.0819168985094711,1.07955380256326,1.0749887710468249,1.073218502514914,1.074327807711068,1.0756262822445606,1.0736529982604717,1.074874088816099,1.0754621331260215,1.0762402390681023,1.073065549674958,1.075370394447263,1.0768545801148603,1.079616766473196,1.0786445535153035,1.0816275059879765,1.0830976561315773,1.0835576076159184,1.0867532683533077,1.086932098218257,1.0866088323371494,1.0867919444130552,1.0853338628225546,1.092921710148962,1.0919922972366702,1.0909273209236494,1.0911042683911178,1.0911887940304297,1.0908927135549182,1.091169900027795,1.0913103536949909,1.0898705039553793,1.092755071177044,1.0898954553463722,1.0900506236534988,1.0910341626339581,1.0906024792013715,1.0908061575869845,1.09116734489665,1.0916786642591252,1.0935158183378904,1.0928717642630423,1.092417698383479,1.0925050752079934,1.0922907873721894,1.0942506298462458,1.0962495079301873,1.098216885179334,1.098303731695187,1.09470492885944,1.0946420254310254,1.0924096942324135,1.0896665598028765,1.088823650031641,1.0893287824556754,1.088425919932603,1.0901918601665876,1.0916263399566266,1.0945862686812353,1.0946811158102296,1.095938453765924,1.0952198257078887,1.096058394996468,1.097117388377093,1.09698063230336,1.0984866806633002,1.0979982404879671,1.0981570393045974,1.0944581065008476,1.0927151319903579,1.0917850542249128,1.0901921242705985,1.0900636909592818,1.0909698879936767,1.093586230554462,1.0941807062538487],"yaxis":"y","type":"scatter"},{"hovertemplate":"max_depth=5\u003cbr\u003en_estimators=%{x}\u003cbr\u003ermse=%{y}\u003cextra\u003e\u003c\u002fextra\u003e","legendgroup":"5","line":{"color":"#FFA15A","dash":"solid"},"marker":{"symbol":"circle"},"mode":"lines","name":"5","orientation":"v","showlegend":true,"x":[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72,73,74,75,76,77,78,79,80,81,82,83,84,85,86,87,88,89,90,91,92,93,94,95,96,97,98,99],"xaxis":"x","y":[1.2488811081796216,1.187962013948847,1.1563886738522364,1.1177080192884699,1.1029063492807905,1.073969694563444,1.074818377987231,1.072217080967004,1.0692287574199864,1.056658970055321,1.058607770281732,1.059266285161901,1.0605629063671709,1.0601005178096772,1.0573563206088719,1.0561641856599606,1.0584219655565719,1.0541315021562327,1.0578895285310397,1.0561866020339954,1.0535494221337443,1.052980096042882,1.060043419490907,1.0597535351468037,1.0604571391243673,1.0610542475693328,1.0596957741919046,1.0641915556679995,1.06279777315546,1.0600354508145537,1.061687582644865,1.061397106874474,1.0611945104162652,1.0625913644160612,1.0655345937822955,1.065973726310437,1.066489274126895,1.0666759542354112,1.0725400309422102,1.0731957865100772,1.0760658820466666,1.0824696182266265,1.0834260190567269,1.0851519042839428,1.0855036822785475,1.0861351423006231,1.0852062711086128,1.0855024846898982,1.0861987623016907,1.0893229812574652,1.088757223185979,1.0882397389458562,1.0900788885878907,1.0936643774867105,1.0942167965854677,1.0928784923655888,1.0927623881976298,1.097778490632736,1.0969039620745002,1.0953408549914005,1.0988630394317775,1.1012790752320465,1.1020049217184915,1.1030230719227168,1.1021828361694916,1.1052366853323223,1.103149417613965,1.1044171259945132,1.1050792288977251,1.107285616173667,1.10700971214315,1.105118813494696,1.107357485060452,1.1070189395560852,1.1078156180181011,1.1077681781262754,1.1105596124709942,1.111955645161186,1.1139786696785496,1.113941366990291,1.1149820411035913,1.117013036639886,1.1152597338529116,1.1138776351652082,1.1144496398956616,1.113597209187979,1.1153120966731858,1.1147112927698564,1.113128956569469,1.1111791401769575,1.1107875815361186,1.1125184347432304,1.1142259910999623,1.1140777333557395,1.115403657816065,1.1150831225070792,1.1150636885978094,1.116407764354555,1.117659584265726,1.1171310284262648],"yaxis":"y","type":"scatter"}],                        {"template":{"data":{"histogram2dcontour":[{"type":"histogram2dcontour","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"choropleth":[{"type":"choropleth","colorbar":{"outlinewidth":0,"ticks":""}}],"histogram2d":[{"type":"histogram2d","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"heatmap":[{"type":"heatmap","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"heatmapgl":[{"type":"heatmapgl","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"contourcarpet":[{"type":"contourcarpet","colorbar":{"outlinewidth":0,"ticks":""}}],"contour":[{"type":"contour","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"surface":[{"type":"surface","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"mesh3d":[{"type":"mesh3d","colorbar":{"outlinewidth":0,"ticks":""}}],"scatter":[{"fillpattern":{"fillmode":"overlay","size":10,"solidity":0.2},"type":"scatter"}],"parcoords":[{"type":"parcoords","line":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scatterpolargl":[{"type":"scatterpolargl","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"bar":[{"error_x":{"color":"#2a3f5f"},"error_y":{"color":"#2a3f5f"},"marker":{"line":{"color":"#E5ECF6","width":0.5},"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"bar"}],"scattergeo":[{"type":"scattergeo","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scatterpolar":[{"type":"scatterpolar","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"histogram":[{"marker":{"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"histogram"}],"scattergl":[{"type":"scattergl","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scatter3d":[{"type":"scatter3d","line":{"colorbar":{"outlinewidth":0,"ticks":""}},"marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scattermapbox":[{"type":"scattermapbox","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scatterternary":[{"type":"scatterternary","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scattercarpet":[{"type":"scattercarpet","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"carpet":[{"aaxis":{"endlinecolor":"#2a3f5f","gridcolor":"white","linecolor":"white","minorgridcolor":"white","startlinecolor":"#2a3f5f"},"baxis":{"endlinecolor":"#2a3f5f","gridcolor":"white","linecolor":"white","minorgridcolor":"white","startlinecolor":"#2a3f5f"},"type":"carpet"}],"table":[{"cells":{"fill":{"color":"#EBF0F8"},"line":{"color":"white"}},"header":{"fill":{"color":"#C8D4E3"},"line":{"color":"white"}},"type":"table"}],"barpolar":[{"marker":{"line":{"color":"#E5ECF6","width":0.5},"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"barpolar"}],"pie":[{"automargin":true,"type":"pie"}]},"layout":{"autotypenumbers":"strict","colorway":["#636efa","#EF553B","#00cc96","#ab63fa","#FFA15A","#19d3f3","#FF6692","#B6E880","#FF97FF","#FECB52"],"font":{"color":"#2a3f5f"},"hovermode":"closest","hoverlabel":{"align":"left"},"paper_bgcolor":"white","plot_bgcolor":"#E5ECF6","polar":{"bgcolor":"#E5ECF6","angularaxis":{"gridcolor":"white","linecolor":"white","ticks":""},"radialaxis":{"gridcolor":"white","linecolor":"white","ticks":""}},"ternary":{"bgcolor":"#E5ECF6","aaxis":{"gridcolor":"white","linecolor":"white","ticks":""},"baxis":{"gridcolor":"white","linecolor":"white","ticks":""},"caxis":{"gridcolor":"white","linecolor":"white","ticks":""}},"coloraxis":{"colorbar":{"outlinewidth":0,"ticks":""}},"colorscale":{"sequential":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"sequentialminus":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"diverging":[[0,"#8e0152"],[0.1,"#c51b7d"],[0.2,"#de77ae"],[0.3,"#f1b6da"],[0.4,"#fde0ef"],[0.5,"#f7f7f7"],[0.6,"#e6f5d0"],[0.7,"#b8e186"],[0.8,"#7fbc41"],[0.9,"#4d9221"],[1,"#276419"]]},"xaxis":{"gridcolor":"white","linecolor":"white","ticks":"","title":{"standoff":15},"zerolinecolor":"white","automargin":true,"zerolinewidth":2},"yaxis":{"gridcolor":"white","linecolor":"white","ticks":"","title":{"standoff":15},"zerolinecolor":"white","automargin":true,"zerolinewidth":2},"scene":{"xaxis":{"backgroundcolor":"#E5ECF6","gridcolor":"white","linecolor":"white","showbackground":true,"ticks":"","zerolinecolor":"white","gridwidth":2},"yaxis":{"backgroundcolor":"#E5ECF6","gridcolor":"white","linecolor":"white","showbackground":true,"ticks":"","zerolinecolor":"white","gridwidth":2},"zaxis":{"backgroundcolor":"#E5ECF6","gridcolor":"white","linecolor":"white","showbackground":true,"ticks":"","zerolinecolor":"white","gridwidth":2}},"shapedefaults":{"line":{"color":"#2a3f5f"}},"annotationdefaults":{"arrowcolor":"#2a3f5f","arrowhead":0,"arrowwidth":1},"geo":{"bgcolor":"white","landcolor":"#E5ECF6","subunitcolor":"white","showland":true,"showlakes":true,"lakecolor":"white"},"title":{"x":0.05},"mapbox":{"style":"light"}}},"xaxis":{"anchor":"y","domain":[0.0,1.0],"title":{"text":"n_estimators"}},"yaxis":{"anchor":"x","domain":[0.0,1.0],"title":{"text":"rmse"}},"legend":{"title":{"text":"max_depth"},"tracegroupgap":0},"margin":{"t":60}},                        {"responsive": true}                    )                };                            </script>        </div>

This suggests that we should pick `max_depth`=2 or 3 to prevent overfitting. Let us select `max_depth`=3 with 90 estimators, since this gives the lowest validation loss.


```python
scores = {}
for eta in [0.01, 0.03, 0.1, 0.3, 1.0]:
    xgb_params = {
        'max_depth': 3,
        'n_estimators': 90,
        "eta": eta,
        'min_child_weight': 1,
        'objective': 'reg:squarederror',
        'seed': 1,
        'verbosity': 1,
    }

    model = xgb.XGBRegressor(**xgb_params, eval_metric="rmse")
    model.fit(_transform(X_train), y_train, eval_set=list(eval_sets.values()))

    results = model.evals_result()
    scores[eta] = pd.DataFrame({k: results[f"validation_{i}"]["rmse"] for i, k in enumerate(eval_sets)})

pd.DataFrame({eta: df["validation"] for eta, df in scores.items()}).plot(
    labels={"index": "n_estimators", "variable": "eta", "value": "rmse"}
)
```

<div>                        <script type="text/javascript">window.PlotlyConfig = {MathJaxConfig: 'local'};</script>
        <script charset="utf-8" src="https://cdn.plot.ly/plotly-2.24.1.min.js"></script>                <div id="b8acf0fa-d162-413a-ab65-53dec97e7e60" class="plotly-graph-div" style="height:100%; width:100%;"></div>            <script type="text/javascript">                                    window.PLOTLYENV=window.PLOTLYENV || {};                                    if (document.getElementById("b8acf0fa-d162-413a-ab65-53dec97e7e60")) {                    Plotly.newPlot(                        "b8acf0fa-d162-413a-ab65-53dec97e7e60",                        [{"hovertemplate":"eta=0.01\u003cbr\u003en_estimators=%{x}\u003cbr\u003ermse=%{y}\u003cextra\u003e\u003c\u002fextra\u003e","legendgroup":"0.01","line":{"color":"#636efa","dash":"solid"},"marker":{"symbol":"circle"},"mode":"lines","name":"0.01","orientation":"v","showlegend":true,"x":[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72,73,74,75,76,77,78,79,80,81,82,83,84,85,86,87,88,89],"xaxis":"x","y":[1.366180716856113,1.3630091815711336,1.3597559501754335,1.3565632658281517,1.353483681438424,1.3505428667811539,1.347523546221206,1.3445604556760504,1.3417829690437215,1.3383821913137373,1.3356296115576929,1.3323394958890091,1.3297591649298608,1.3263849626060609,1.323117270424672,1.3206674215628622,1.317448012142053,1.31446131676693,1.3122898794744982,1.3100805822959707,1.307081466110169,1.3049502511860518,1.3022728382375315,1.300216184546195,1.2980046109356076,1.2952633724887173,1.2928463361610993,1.2900465311806162,1.288246636933333,1.2860806550819865,1.284249012242765,1.2825886957831232,1.280818584307334,1.2786098225188092,1.276023593619465,1.2744582303419825,1.2723028707217228,1.2703223981653176,1.2682211336016,1.266763563990637,1.2652835083196536,1.263255047207715,1.2613745138544463,1.259397850173515,1.2570855259335905,1.2557532019903705,1.2538445103135132,1.2520614839177253,1.2501775215539066,1.248908414709477,1.2467840362912228,1.2449883879100645,1.2436153901009888,1.2418640312273015,1.2404673142701876,1.2387601105090658,1.237145279151937,1.2354625748973023,1.2343985597598772,1.2327841222903135,1.2315836069050623,1.2300100971382266,1.2288047393143458,1.2272549029992832,1.2260487500059698,1.224554741858387,1.223453743105936,1.2220846729336394,1.2206724379399336,1.21970380367381,1.2182846865073262,1.2171072387077764,1.215830344576256,1.2144478182516811,1.213115618460814,1.2113553567564528,1.210358484973505,1.2086439486403164,1.2077984171602854,1.2062923560958405,1.20529584305256,1.2036588727000153,1.2017797889320734,1.2010379886132725,1.1994610392230682,1.1976443152522016,1.1967775587290412,1.195433593516201,1.193745031605481,1.1930018983798663],"yaxis":"y","type":"scatter"},{"hovertemplate":"eta=0.03\u003cbr\u003en_estimators=%{x}\u003cbr\u003ermse=%{y}\u003cextra\u003e\u003c\u002fextra\u003e","legendgroup":"0.03","line":{"color":"#EF553B","dash":"solid"},"marker":{"symbol":"circle"},"mode":"lines","name":"0.03","orientation":"v","showlegend":true,"x":[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72,73,74,75,76,77,78,79,80,81,82,83,84,85,86,87,88,89],"xaxis":"x","y":[1.3598037803965566,1.3503106807161118,1.3415059610728846,1.3317841111203133,1.3237408371187125,1.3139891531361814,1.307565236154336,1.29861818748853,1.292163024385273,1.284995644625312,1.2799832961664395,1.2751318374640475,1.2675968674401135,1.2613541846622156,1.2557559225113397,1.2499791496483144,1.24629893935393,1.2409540225856073,1.2367734490350861,1.2319758179056381,1.2271766104496884,1.2242806583789676,1.219900238738626,1.2164443674652556,1.2126549704153227,1.2096743347605603,1.2046095188995285,1.199813687691797,1.1976276188217772,1.1925094123725855,1.1899468841291143,1.185178474120155,1.180644285681087,1.1788334958067581,1.1761522847648769,1.171942653130954,1.1702420369604207,1.166279635459493,1.1625007109822867,1.1606250974279826,1.1598030890862372,1.1562030177387435,1.151596356739091,1.1501038317540824,1.1467759453836162,1.1446415609332692,1.1416602204085977,1.1411972519220859,1.139358979252382,1.1386311623269876,1.134901958991488,1.134075331027667,1.131881846428252,1.1292647764933932,1.126728425198916,1.1254772240986852,1.1241191434917817,1.123662515692898,1.121343499439228,1.1197125277421711,1.1187523020472157,1.1184743703171405,1.1177264053197082,1.115008522817658,1.1139161381744926,1.1141131819343753,1.1135075579078504,1.111133911078476,1.109138457526082,1.1083366715202456,1.1070317287717693,1.106135146879632,1.104338783264486,1.1036831887289993,1.1017562687653952,1.1009223067672496,1.1015571407156253,1.100034465787369,1.099310312676867,1.09811611411149,1.0966977673640943,1.096086546988945,1.0954145823232746,1.0942501333152406,1.093598702396618,1.0925146840908477,1.09198174637462,1.091755596863254,1.0907586527291664,1.0913692481314334],"yaxis":"y","type":"scatter"},{"hovertemplate":"eta=0.1\u003cbr\u003en_estimators=%{x}\u003cbr\u003ermse=%{y}\u003cextra\u003e\u003c\u002fextra\u003e","legendgroup":"0.1","line":{"color":"#00cc96","dash":"solid"},"marker":{"symbol":"circle"},"mode":"lines","name":"0.1","orientation":"v","showlegend":true,"x":[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72,73,74,75,76,77,78,79,80,81,82,83,84,85,86,87,88,89],"xaxis":"x","y":[1.3384248330848343,1.3062766563726962,1.2859413260510815,1.2695550421957031,1.2509385682430008,1.2333422254026318,1.2216642793467103,1.2029681972370445,1.185643901247218,1.176582204729027,1.1720358202224403,1.1590766588916355,1.1431592229159806,1.140370244933756,1.1290217530307123,1.1226345168408982,1.116239130287747,1.1150839150281422,1.1083947782523735,1.103858563478513,1.101394579388522,1.1008075168901232,1.09544996318346,1.0934793262984615,1.090322846426461,1.0882314286468464,1.0885633725391646,1.0854985626187905,1.0852093090169181,1.0830255175158947,1.0807891147763857,1.0814843843833788,1.0792028644921539,1.0772189538322035,1.0766232507577687,1.0751629910542728,1.0735129824809275,1.0728114856245472,1.071103301065236,1.070748115774036,1.0704927545612295,1.069221096774114,1.0681220694666296,1.0669109948933324,1.0652360697608874,1.0658745760639998,1.064173318772903,1.0643344896154772,1.0641195839260755,1.0642627019742985,1.0640105651319323,1.0628534807319467,1.0613947113878348,1.0611428643021155,1.0599727394212415,1.0614177849661215,1.0621550771427173,1.0613800115261036,1.0608794964827097,1.0610754254464212,1.0614196397071605,1.0596855425549485,1.0591249797191116,1.0584130036735284,1.0591483735811869,1.0598256244829185,1.0593284779829493,1.0597561094213943,1.0592549095831898,1.0587667251285375,1.058666703484498,1.058285082084183,1.058569244459543,1.0577331578729383,1.0564654954710853,1.057085581936932,1.0569678630572044,1.0572333692111862,1.0568038725573912,1.0572060753073387,1.057416133941628,1.0579692897498445,1.0579485351271967,1.0569541436706382,1.0559540464406427,1.0557554486519123,1.0579356093370311,1.0570328372521942,1.0559987236244268,1.0565616775770916],"yaxis":"y","type":"scatter"},{"hovertemplate":"eta=0.3\u003cbr\u003en_estimators=%{x}\u003cbr\u003ermse=%{y}\u003cextra\u003e\u003c\u002fextra\u003e","legendgroup":"0.3","line":{"color":"#ab63fa","dash":"solid"},"marker":{"symbol":"circle"},"mode":"lines","name":"0.3","orientation":"v","showlegend":true,"x":[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72,73,74,75,76,77,78,79,80,81,82,83,84,85,86,87,88,89],"xaxis":"x","y":[1.2859469342971275,1.2185091394600494,1.1715881008782087,1.126452203352672,1.1192783250709453,1.101462391470501,1.0844582694510574,1.0719238765555184,1.0682202515190102,1.0573847758588812,1.0540355575526514,1.0531511086879368,1.0552093825880458,1.0510820991495935,1.0492881144227724,1.0420324397414444,1.0420943511126541,1.0417272111275147,1.0406350302395442,1.036473896668563,1.033614554877372,1.0307584415220126,1.0315431277823386,1.03000164452374,1.0337361076539449,1.0335067391702892,1.0344861887803882,1.0347813916702029,1.033412768626885,1.0300956883773564,1.0303455352718176,1.0300478650525569,1.0287330226424765,1.026507599396691,1.0275110898017172,1.029074542338612,1.0281571673514038,1.0271902157033375,1.0263360645327413,1.025116756141469,1.023598300607321,1.0214339307943414,1.0205305740445665,1.020255730540292,1.0192535020740099,1.0172520148825566,1.0173324682506624,1.0218937211813461,1.0229937578308903,1.0226972037583626,1.0229880448729816,1.0235157928893444,1.030041458539732,1.0290135258679158,1.027022893935132,1.0279969860836262,1.0284404459506802,1.0281891894594717,1.0283544020200583,1.0289803330199905,1.0256139991774729,1.0280032632711544,1.0288177043490814,1.0287211634855915,1.0284579385850676,1.026373513333557,1.0266468872016183,1.0260256330358601,1.024987601907674,1.0250285175557035,1.0248899088337835,1.02626241321974,1.0260395233002042,1.0250549507248046,1.026172936224927,1.0243544239352391,1.026098349373481,1.0257131843342842,1.0279792139732058,1.0268367574460935,1.0271652846902075,1.0265214814164978,1.027800356882374,1.0299742309820623,1.0285310496299351,1.027394892627657,1.0277094422590116,1.0260891849486062,1.0270967668145,1.0271613107847275],"yaxis":"y","type":"scatter"},{"hovertemplate":"eta=1.0\u003cbr\u003en_estimators=%{x}\u003cbr\u003ermse=%{y}\u003cextra\u003e\u003c\u002fextra\u003e","legendgroup":"1.0","line":{"color":"#FFA15A","dash":"solid"},"marker":{"symbol":"circle"},"mode":"lines","name":"1.0","orientation":"v","showlegend":true,"x":[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72,73,74,75,76,77,78,79,80,81,82,83,84,85,86,87,88,89],"xaxis":"x","y":[1.21969395018607,1.15247963466775,1.130351549058408,1.1209386832478008,1.1573572455033545,1.1536662099699728,1.1500372105883117,1.1478472096975783,1.150431024165119,1.144239168133322,1.1515220128769046,1.1370420526614302,1.1388069987968659,1.1367447196360265,1.1343595314367552,1.122323118484939,1.1268515357518323,1.1659044540108423,1.1683945305923082,1.1695617099092246,1.1589941380328723,1.157875939032222,1.1515819401847371,1.1614809696805781,1.1530845076386793,1.1583166347492433,1.1572205638682755,1.1589829768140183,1.1709679123518175,1.166753377037803,1.1608596624024499,1.1664699705464883,1.1704291777021623,1.1715141599339416,1.1696671365205311,1.1736756520492262,1.1719970683776453,1.173937592226924,1.1745074342384323,1.1763887467083483,1.179133404121906,1.1837104539961796,1.192655006900831,1.1914027304153814,1.1909557216879265,1.188412483530304,1.1919153124070239,1.1852190030892,1.1935675510272914,1.2027427235555705,1.2050342714830111,1.2039169788211233,1.204495864964202,1.1977656345660654,1.1997790739450136,1.199898382433591,1.1969716761321796,1.197819849498616,1.207011656878723,1.2032255983312177,1.2077044702652326,1.2107933639978283,1.2048733500554758,1.2003597206021712,1.2069158851002912,1.2039093038023914,1.2087430866075333,1.2073108973494415,1.2098168516683543,1.209630337956038,1.2124477956758883,1.215076514264886,1.218905402969006,1.2175973161873106,1.2203095781054252,1.2206838743170294,1.2172368258479112,1.2121255860010838,1.2110269640804967,1.2090035481529622,1.2166045676832398,1.2141394378491743,1.2190283333472174,1.2203769080961269,1.228842907257931,1.2332286635106373,1.237645809491091,1.235839666286622,1.2427032917434817,1.2404843193972108],"yaxis":"y","type":"scatter"}],                        {"template":{"data":{"histogram2dcontour":[{"type":"histogram2dcontour","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"choropleth":[{"type":"choropleth","colorbar":{"outlinewidth":0,"ticks":""}}],"histogram2d":[{"type":"histogram2d","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"heatmap":[{"type":"heatmap","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"heatmapgl":[{"type":"heatmapgl","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"contourcarpet":[{"type":"contourcarpet","colorbar":{"outlinewidth":0,"ticks":""}}],"contour":[{"type":"contour","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"surface":[{"type":"surface","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"mesh3d":[{"type":"mesh3d","colorbar":{"outlinewidth":0,"ticks":""}}],"scatter":[{"fillpattern":{"fillmode":"overlay","size":10,"solidity":0.2},"type":"scatter"}],"parcoords":[{"type":"parcoords","line":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scatterpolargl":[{"type":"scatterpolargl","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"bar":[{"error_x":{"color":"#2a3f5f"},"error_y":{"color":"#2a3f5f"},"marker":{"line":{"color":"#E5ECF6","width":0.5},"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"bar"}],"scattergeo":[{"type":"scattergeo","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scatterpolar":[{"type":"scatterpolar","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"histogram":[{"marker":{"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"histogram"}],"scattergl":[{"type":"scattergl","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scatter3d":[{"type":"scatter3d","line":{"colorbar":{"outlinewidth":0,"ticks":""}},"marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scattermapbox":[{"type":"scattermapbox","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scatterternary":[{"type":"scatterternary","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scattercarpet":[{"type":"scattercarpet","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"carpet":[{"aaxis":{"endlinecolor":"#2a3f5f","gridcolor":"white","linecolor":"white","minorgridcolor":"white","startlinecolor":"#2a3f5f"},"baxis":{"endlinecolor":"#2a3f5f","gridcolor":"white","linecolor":"white","minorgridcolor":"white","startlinecolor":"#2a3f5f"},"type":"carpet"}],"table":[{"cells":{"fill":{"color":"#EBF0F8"},"line":{"color":"white"}},"header":{"fill":{"color":"#C8D4E3"},"line":{"color":"white"}},"type":"table"}],"barpolar":[{"marker":{"line":{"color":"#E5ECF6","width":0.5},"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"barpolar"}],"pie":[{"automargin":true,"type":"pie"}]},"layout":{"autotypenumbers":"strict","colorway":["#636efa","#EF553B","#00cc96","#ab63fa","#FFA15A","#19d3f3","#FF6692","#B6E880","#FF97FF","#FECB52"],"font":{"color":"#2a3f5f"},"hovermode":"closest","hoverlabel":{"align":"left"},"paper_bgcolor":"white","plot_bgcolor":"#E5ECF6","polar":{"bgcolor":"#E5ECF6","angularaxis":{"gridcolor":"white","linecolor":"white","ticks":""},"radialaxis":{"gridcolor":"white","linecolor":"white","ticks":""}},"ternary":{"bgcolor":"#E5ECF6","aaxis":{"gridcolor":"white","linecolor":"white","ticks":""},"baxis":{"gridcolor":"white","linecolor":"white","ticks":""},"caxis":{"gridcolor":"white","linecolor":"white","ticks":""}},"coloraxis":{"colorbar":{"outlinewidth":0,"ticks":""}},"colorscale":{"sequential":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"sequentialminus":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"diverging":[[0,"#8e0152"],[0.1,"#c51b7d"],[0.2,"#de77ae"],[0.3,"#f1b6da"],[0.4,"#fde0ef"],[0.5,"#f7f7f7"],[0.6,"#e6f5d0"],[0.7,"#b8e186"],[0.8,"#7fbc41"],[0.9,"#4d9221"],[1,"#276419"]]},"xaxis":{"gridcolor":"white","linecolor":"white","ticks":"","title":{"standoff":15},"zerolinecolor":"white","automargin":true,"zerolinewidth":2},"yaxis":{"gridcolor":"white","linecolor":"white","ticks":"","title":{"standoff":15},"zerolinecolor":"white","automargin":true,"zerolinewidth":2},"scene":{"xaxis":{"backgroundcolor":"#E5ECF6","gridcolor":"white","linecolor":"white","showbackground":true,"ticks":"","zerolinecolor":"white","gridwidth":2},"yaxis":{"backgroundcolor":"#E5ECF6","gridcolor":"white","linecolor":"white","showbackground":true,"ticks":"","zerolinecolor":"white","gridwidth":2},"zaxis":{"backgroundcolor":"#E5ECF6","gridcolor":"white","linecolor":"white","showbackground":true,"ticks":"","zerolinecolor":"white","gridwidth":2}},"shapedefaults":{"line":{"color":"#2a3f5f"}},"annotationdefaults":{"arrowcolor":"#2a3f5f","arrowhead":0,"arrowwidth":1},"geo":{"bgcolor":"white","landcolor":"#E5ECF6","subunitcolor":"white","showland":true,"showlakes":true,"lakecolor":"white"},"title":{"x":0.05},"mapbox":{"style":"light"}}},"xaxis":{"anchor":"y","domain":[0.0,1.0],"title":{"text":"n_estimators"}},"yaxis":{"anchor":"x","domain":[0.0,1.0],"title":{"text":"rmse"}},"legend":{"title":{"text":"eta"},"tracegroupgap":0},"margin":{"t":60}},                        {"responsive": true}                    )                };                            </script>        </div>

To prevent overfitting, we should select `eta` = 0.3.


```python
xgb_params = {
    'max_depth': 3,
    'n_estimators': 90,
    "eta": 0.3,
    'min_child_weight': 1,
    'objective': 'reg:squarederror',
    'seed': 1,
    'verbosity': 1,
}
xgb_model = xgb.XGBRegressor(**xgb_params, eval_metric="rmse")
xgb_model.fit(_transform(X_train_val), y_train_val, eval_set=[(_transform(X_train_val), y_train_val)])
results = xgb_model.evals_result()
scores = pd.Series(results[f"validation_0"]["rmse"])
```


```python
scores.plot(labels={"index": "n_estimators", "value": "rmse"})
```

In the same way as the linear model, this model fails to capture the very low or high ratings.


```python
pd.DataFrame(
    {
        "true": y_train_val,
        "prediction": np.round(xgb_model.predict(_transform(X_train_val)), decimals=0),
    }
).hist(histnorm="percent", barmode="group")
```

### Feature importances
We can get a bit more insight by evaluating the importance of the difference features.


```python
from sklearn.inspection import permutation_importance

importances = {}
for name, model in models.items():
    r = permutation_importance(model, _transform(X_train_val), y_train_val, n_repeats=10, random_state=0)
    importances[name] = pd.Series(dict(zip(dv.get_feature_names_out(), r.importances_mean)))

importances = pd.DataFrame(importances)
```

|                 feature        |  linear   |	xgb      |
|--------------------------------|-----------|-----------|
|price_per_100g	                 |  0.197381 |	0.244563 |
|flavours=fruity                 |	0.067031 |	0.078077 |
|region_of_origin=East Africa	 |  0.072613 |  0.052817 |
|roaster_country=Taiwan          |	0.057250 |  0.028345 |
|roaster=Other                   |	0.027719 |	0.050806 |
|roast=Light	                 |  0.047623 |	0.002267 |
|roaster=El Gran Cafe            |	0.020535 |	0.045360 |
|roaster=Kakalove Cafe           |  0.037606 |  0.035591 |
|roaster_country=United States   |	0.035916 | -0.002266 |
|roast=Medium-Light              |	0.029053 |	0.015307 |

We can see in both cases that the biggest influence is the price. This suggests that either:
- Price is genuinely an indicator of quality
- Price biases the reviewers

Other than the price, the region of origin plays a big influence. Surprisingly the flavour notes do not have that much influence apart from the fruitiness.  Whether a coffee is roasted by certain roasters does have a non-negligable impact on the rating.

```python
importances.loc[importances.max(axis=1).sort_values(ascending=False).index].head(10)
```

### Model selection
We can evaluate the losses on the test dataset, and see which model is most accurate.


```python
models = {"linear": linear_model, "xgb": xgb_model}

scores = pd.Series(dtype=float)
for name, model in models.items():
    y_pred = model.predict(_transform(X_test))
    scores[name] = mean_squared_error(y_test, y_pred, squared=False)

scores.plot.bar(labels={"index":"model","value":"mse"})
```

<div>                        <script type="text/javascript">window.PlotlyConfig = {MathJaxConfig: 'local'};</script>
        <script charset="utf-8" src="https://cdn.plot.ly/plotly-2.24.1.min.js"></script>                <div id="5f766b32-93d2-49cf-9fb4-03a94ab2cfc3" class="plotly-graph-div" style="height:100%; width:100%;"></div>            <script type="text/javascript">                                    window.PLOTLYENV=window.PLOTLYENV || {};                                    if (document.getElementById("5f766b32-93d2-49cf-9fb4-03a94ab2cfc3")) {                    Plotly.newPlot(                        "5f766b32-93d2-49cf-9fb4-03a94ab2cfc3",                        [{"alignmentgroup":"True","hovertemplate":"variable=0\u003cbr\u003eindex=%{x}\u003cbr\u003evalue=%{y}\u003cextra\u003e\u003c\u002fextra\u003e","legendgroup":"0","marker":{"color":"#636efa","pattern":{"shape":""}},"name":"0","offsetgroup":"0","orientation":"v","showlegend":true,"textposition":"auto","x":["linear","xgb"],"xaxis":"x","y":[1.2448641862630527,1.3122199436078394],"yaxis":"y","type":"bar"}],                        {"template":{"data":{"histogram2dcontour":[{"type":"histogram2dcontour","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"choropleth":[{"type":"choropleth","colorbar":{"outlinewidth":0,"ticks":""}}],"histogram2d":[{"type":"histogram2d","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"heatmap":[{"type":"heatmap","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"heatmapgl":[{"type":"heatmapgl","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"contourcarpet":[{"type":"contourcarpet","colorbar":{"outlinewidth":0,"ticks":""}}],"contour":[{"type":"contour","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"surface":[{"type":"surface","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"mesh3d":[{"type":"mesh3d","colorbar":{"outlinewidth":0,"ticks":""}}],"scatter":[{"fillpattern":{"fillmode":"overlay","size":10,"solidity":0.2},"type":"scatter"}],"parcoords":[{"type":"parcoords","line":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scatterpolargl":[{"type":"scatterpolargl","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"bar":[{"error_x":{"color":"#2a3f5f"},"error_y":{"color":"#2a3f5f"},"marker":{"line":{"color":"#E5ECF6","width":0.5},"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"bar"}],"scattergeo":[{"type":"scattergeo","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scatterpolar":[{"type":"scatterpolar","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"histogram":[{"marker":{"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"histogram"}],"scattergl":[{"type":"scattergl","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scatter3d":[{"type":"scatter3d","line":{"colorbar":{"outlinewidth":0,"ticks":""}},"marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scattermapbox":[{"type":"scattermapbox","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scatterternary":[{"type":"scatterternary","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scattercarpet":[{"type":"scattercarpet","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"carpet":[{"aaxis":{"endlinecolor":"#2a3f5f","gridcolor":"white","linecolor":"white","minorgridcolor":"white","startlinecolor":"#2a3f5f"},"baxis":{"endlinecolor":"#2a3f5f","gridcolor":"white","linecolor":"white","minorgridcolor":"white","startlinecolor":"#2a3f5f"},"type":"carpet"}],"table":[{"cells":{"fill":{"color":"#EBF0F8"},"line":{"color":"white"}},"header":{"fill":{"color":"#C8D4E3"},"line":{"color":"white"}},"type":"table"}],"barpolar":[{"marker":{"line":{"color":"#E5ECF6","width":0.5},"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"barpolar"}],"pie":[{"automargin":true,"type":"pie"}]},"layout":{"autotypenumbers":"strict","colorway":["#636efa","#EF553B","#00cc96","#ab63fa","#FFA15A","#19d3f3","#FF6692","#B6E880","#FF97FF","#FECB52"],"font":{"color":"#2a3f5f"},"hovermode":"closest","hoverlabel":{"align":"left"},"paper_bgcolor":"white","plot_bgcolor":"#E5ECF6","polar":{"bgcolor":"#E5ECF6","angularaxis":{"gridcolor":"white","linecolor":"white","ticks":""},"radialaxis":{"gridcolor":"white","linecolor":"white","ticks":""}},"ternary":{"bgcolor":"#E5ECF6","aaxis":{"gridcolor":"white","linecolor":"white","ticks":""},"baxis":{"gridcolor":"white","linecolor":"white","ticks":""},"caxis":{"gridcolor":"white","linecolor":"white","ticks":""}},"coloraxis":{"colorbar":{"outlinewidth":0,"ticks":""}},"colorscale":{"sequential":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"sequentialminus":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"diverging":[[0,"#8e0152"],[0.1,"#c51b7d"],[0.2,"#de77ae"],[0.3,"#f1b6da"],[0.4,"#fde0ef"],[0.5,"#f7f7f7"],[0.6,"#e6f5d0"],[0.7,"#b8e186"],[0.8,"#7fbc41"],[0.9,"#4d9221"],[1,"#276419"]]},"xaxis":{"gridcolor":"white","linecolor":"white","ticks":"","title":{"standoff":15},"zerolinecolor":"white","automargin":true,"zerolinewidth":2},"yaxis":{"gridcolor":"white","linecolor":"white","ticks":"","title":{"standoff":15},"zerolinecolor":"white","automargin":true,"zerolinewidth":2},"scene":{"xaxis":{"backgroundcolor":"#E5ECF6","gridcolor":"white","linecolor":"white","showbackground":true,"ticks":"","zerolinecolor":"white","gridwidth":2},"yaxis":{"backgroundcolor":"#E5ECF6","gridcolor":"white","linecolor":"white","showbackground":true,"ticks":"","zerolinecolor":"white","gridwidth":2},"zaxis":{"backgroundcolor":"#E5ECF6","gridcolor":"white","linecolor":"white","showbackground":true,"ticks":"","zerolinecolor":"white","gridwidth":2}},"shapedefaults":{"line":{"color":"#2a3f5f"}},"annotationdefaults":{"arrowcolor":"#2a3f5f","arrowhead":0,"arrowwidth":1},"geo":{"bgcolor":"white","landcolor":"#E5ECF6","subunitcolor":"white","showland":true,"showlakes":true,"lakecolor":"white"},"title":{"x":0.05},"mapbox":{"style":"light"}}},"xaxis":{"anchor":"y","domain":[0.0,1.0],"title":{"text":"model"}},"yaxis":{"anchor":"x","domain":[0.0,1.0],"title":{"text":"mse"}},"legend":{"title":{"text":"variable"},"tracegroupgap":0},"margin":{"t":60},"barmode":"relative"},                        {"responsive": true}                    )                };                            </script>        </div>

We can see that the two models display similar performance, and predict a similar distribution of ratings with shorter tails. This suggests that the model is not the reason for failing to predict the highest/lowest scores is more due to some other more systematic error such as:
- Lack of information in the features (eg perhaps we need more detailed information about the origin)
- System error in the reviews (eg different reviewers)

```python
pd.DataFrame(
    {"true": y_test} | {name: np.round(model.predict(_transform(X_test)), decimals=0) for name, model in models.items()}
).hist(histnorm="percent", barmode="group")
```

<div>                        <script type="text/javascript">window.PlotlyConfig = {MathJaxConfig: 'local'};</script>
        <script charset="utf-8" src="https://cdn.plot.ly/plotly-2.24.1.min.js"></script>                <div id="a869b2e9-e9ed-4f54-8a96-76e365e1a184" class="plotly-graph-div" style="height:100%; width:100%;"></div>            <script type="text/javascript">                                    window.PLOTLYENV=window.PLOTLYENV || {};                                    if (document.getElementById("a869b2e9-e9ed-4f54-8a96-76e365e1a184")) {                    Plotly.newPlot(                        "a869b2e9-e9ed-4f54-8a96-76e365e1a184",                        [{"alignmentgroup":"True","bingroup":"x","histnorm":"percent","hovertemplate":"variable=true\u003cbr\u003erating=%{x}\u003cbr\u003epercent=%{y}\u003cextra\u003e\u003c\u002fextra\u003e","legendgroup":"true","marker":{"color":"#636efa","pattern":{"shape":""}},"name":"true","offsetgroup":"true","orientation":"v","showlegend":true,"x":[93.0,93.0,96.0,93.0,92.0,93.0,94.0,95.0,92.0,93.0,93.0,94.0,93.0,90.0,93.0,93.0,93.0,96.0,94.0,93.0,94.0,90.0,94.0,94.0,95.0,95.0,93.0,93.0,93.0,93.0,94.0,91.0,93.0,93.0,96.0,93.0,92.0,94.0,92.0,94.0,94.0,94.0,94.0,92.0,92.0,94.0,92.0,95.0,93.0,96.0,95.0,94.0,94.0,92.0,91.0,95.0,93.0,94.0,91.0,92.0,92.0,93.0,92.0,94.0,93.0,92.0,94.0,90.0,95.0,92.0,95.0,95.0,92.0,92.0,93.0,94.0,92.0,93.0,93.0,92.0,94.0,93.0,93.0,96.0,93.0,92.0,92.0,95.0,94.0,96.0,94.0,86.0,94.0,94.0,97.0,94.0,91.0,93.0,94.0,91.0,94.0,92.0,95.0,93.0,96.0,94.0,95.0,93.0,94.0,92.0,94.0,95.0,92.0,91.0,95.0,91.0,93.0,94.0,94.0,94.0,93.0,94.0,91.0,96.0,94.0,93.0,95.0,95.0,94.0,95.0,96.0,94.0,94.0,92.0,91.0,95.0,93.0,93.0,94.0,92.0,90.0,91.0,93.0,95.0,94.0,90.0,93.0,93.0,92.0,94.0,94.0,93.0,87.0,93.0,94.0,93.0,94.0,94.0,92.0,95.0,93.0,93.0,92.0,93.0,92.0,93.0,93.0,93.0,95.0,94.0,92.0,94.0,95.0,91.0,94.0,94.0,92.0,93.0,90.0,90.0,93.0,95.0,96.0,92.0,92.0,93.0,92.0,95.0,93.0,96.0,92.0,90.0,96.0,94.0,94.0,94.0,94.0,91.0,95.0,92.0,94.0,95.0,95.0,94.0,94.0,96.0,94.0,93.0,93.0,93.0,95.0,93.0,93.0,93.0,93.0,92.0,94.0,94.0,90.0,90.0,94.0,92.0,92.0,94.0,89.0,93.0,94.0,94.0,92.0,94.0,95.0,92.0,94.0,94.0,93.0,95.0,94.0,93.0,95.0,92.0,94.0,95.0,94.0,96.0,92.0,95.0,92.0,93.0,92.0,87.0],"xaxis":"x","yaxis":"y","type":"histogram"},{"alignmentgroup":"True","bingroup":"x","histnorm":"percent","hovertemplate":"variable=linear\u003cbr\u003erating=%{x}\u003cbr\u003epercent=%{y}\u003cextra\u003e\u003c\u002fextra\u003e","legendgroup":"linear","marker":{"color":"#EF553B","pattern":{"shape":""}},"name":"linear","offsetgroup":"linear","orientation":"v","showlegend":true,"x":[93.0,93.0,94.0,93.0,92.0,93.0,95.0,95.0,93.0,93.0,94.0,93.0,92.0,93.0,93.0,94.0,93.0,94.0,94.0,93.0,93.0,92.0,93.0,95.0,93.0,94.0,93.0,93.0,93.0,94.0,92.0,92.0,94.0,93.0,94.0,92.0,93.0,93.0,93.0,94.0,92.0,94.0,94.0,93.0,94.0,95.0,92.0,95.0,93.0,96.0,94.0,95.0,93.0,92.0,93.0,94.0,93.0,92.0,93.0,93.0,92.0,93.0,93.0,93.0,94.0,93.0,95.0,92.0,92.0,93.0,93.0,94.0,93.0,92.0,94.0,92.0,93.0,92.0,95.0,92.0,93.0,94.0,93.0,95.0,93.0,94.0,94.0,95.0,94.0,94.0,93.0,90.0,94.0,93.0,95.0,95.0,91.0,93.0,94.0,92.0,94.0,93.0,94.0,93.0,95.0,94.0,95.0,93.0,94.0,93.0,94.0,95.0,92.0,92.0,94.0,92.0,93.0,93.0,92.0,94.0,93.0,93.0,92.0,94.0,93.0,93.0,94.0,93.0,94.0,93.0,94.0,95.0,94.0,92.0,93.0,92.0,93.0,93.0,92.0,93.0,92.0,91.0,93.0,94.0,95.0,91.0,94.0,93.0,92.0,94.0,94.0,93.0,92.0,94.0,93.0,93.0,94.0,93.0,93.0,94.0,94.0,93.0,93.0,92.0,93.0,92.0,93.0,92.0,93.0,93.0,93.0,93.0,94.0,93.0,92.0,94.0,92.0,94.0,93.0,93.0,95.0,93.0,95.0,93.0,95.0,92.0,93.0,96.0,92.0,95.0,92.0,93.0,94.0,93.0,94.0,94.0,94.0,92.0,94.0,93.0,93.0,95.0,94.0,93.0,93.0,94.0,94.0,93.0,94.0,93.0,93.0,93.0,93.0,93.0,93.0,93.0,93.0,93.0,92.0,93.0,94.0,93.0,95.0,94.0,91.0,94.0,93.0,94.0,94.0,95.0,94.0,94.0,94.0,94.0,94.0,93.0,93.0,92.0,95.0,94.0,93.0,95.0,92.0,94.0,94.0,94.0,93.0,93.0,93.0,91.0],"xaxis":"x","yaxis":"y","type":"histogram"},{"alignmentgroup":"True","bingroup":"x","histnorm":"percent","hovertemplate":"variable=xgb\u003cbr\u003erating=%{x}\u003cbr\u003epercent=%{y}\u003cextra\u003e\u003c\u002fextra\u003e","legendgroup":"xgb","marker":{"color":"#00cc96","pattern":{"shape":""}},"name":"xgb","offsetgroup":"xgb","orientation":"v","showlegend":true,"x":[93.0,93.0,94.0,93.0,91.0,92.0,95.0,95.0,94.0,93.0,94.0,92.0,93.0,93.0,93.0,94.0,93.0,94.0,94.0,94.0,94.0,92.0,93.0,94.0,94.0,94.0,93.0,92.0,92.0,94.0,93.0,92.0,94.0,93.0,94.0,93.0,92.0,92.0,93.0,94.0,93.0,94.0,94.0,93.0,92.0,95.0,93.0,94.0,93.0,95.0,94.0,95.0,93.0,92.0,92.0,94.0,93.0,93.0,92.0,92.0,92.0,93.0,93.0,94.0,94.0,93.0,95.0,93.0,92.0,93.0,93.0,95.0,93.0,93.0,93.0,92.0,93.0,93.0,93.0,92.0,92.0,94.0,93.0,95.0,94.0,94.0,94.0,94.0,94.0,95.0,93.0,91.0,94.0,93.0,95.0,94.0,91.0,93.0,95.0,93.0,94.0,93.0,94.0,92.0,95.0,94.0,95.0,94.0,93.0,93.0,94.0,95.0,93.0,93.0,94.0,92.0,93.0,93.0,92.0,94.0,93.0,92.0,92.0,94.0,93.0,93.0,95.0,93.0,94.0,92.0,94.0,95.0,94.0,93.0,93.0,93.0,93.0,93.0,92.0,93.0,93.0,91.0,92.0,94.0,95.0,91.0,94.0,93.0,92.0,94.0,94.0,93.0,93.0,94.0,94.0,92.0,94.0,93.0,93.0,94.0,95.0,93.0,94.0,92.0,92.0,93.0,94.0,92.0,93.0,93.0,93.0,93.0,94.0,92.0,91.0,94.0,91.0,94.0,93.0,93.0,94.0,92.0,95.0,94.0,94.0,93.0,93.0,95.0,93.0,94.0,92.0,94.0,95.0,94.0,94.0,94.0,94.0,92.0,94.0,92.0,94.0,94.0,94.0,93.0,92.0,95.0,94.0,93.0,94.0,93.0,94.0,94.0,93.0,93.0,93.0,93.0,94.0,94.0,92.0,93.0,94.0,93.0,94.0,94.0,92.0,94.0,93.0,93.0,94.0,94.0,94.0,94.0,94.0,94.0,94.0,93.0,93.0,93.0,94.0,94.0,93.0,94.0,92.0,95.0,93.0,94.0,93.0,93.0,93.0,91.0],"xaxis":"x","yaxis":"y","type":"histogram"}],                        {"template":{"data":{"histogram2dcontour":[{"type":"histogram2dcontour","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"choropleth":[{"type":"choropleth","colorbar":{"outlinewidth":0,"ticks":""}}],"histogram2d":[{"type":"histogram2d","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"heatmap":[{"type":"heatmap","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"heatmapgl":[{"type":"heatmapgl","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"contourcarpet":[{"type":"contourcarpet","colorbar":{"outlinewidth":0,"ticks":""}}],"contour":[{"type":"contour","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"surface":[{"type":"surface","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"mesh3d":[{"type":"mesh3d","colorbar":{"outlinewidth":0,"ticks":""}}],"scatter":[{"fillpattern":{"fillmode":"overlay","size":10,"solidity":0.2},"type":"scatter"}],"parcoords":[{"type":"parcoords","line":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scatterpolargl":[{"type":"scatterpolargl","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"bar":[{"error_x":{"color":"#2a3f5f"},"error_y":{"color":"#2a3f5f"},"marker":{"line":{"color":"#E5ECF6","width":0.5},"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"bar"}],"scattergeo":[{"type":"scattergeo","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scatterpolar":[{"type":"scatterpolar","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"histogram":[{"marker":{"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"histogram"}],"scattergl":[{"type":"scattergl","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scatter3d":[{"type":"scatter3d","line":{"colorbar":{"outlinewidth":0,"ticks":""}},"marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scattermapbox":[{"type":"scattermapbox","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scatterternary":[{"type":"scatterternary","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scattercarpet":[{"type":"scattercarpet","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"carpet":[{"aaxis":{"endlinecolor":"#2a3f5f","gridcolor":"white","linecolor":"white","minorgridcolor":"white","startlinecolor":"#2a3f5f"},"baxis":{"endlinecolor":"#2a3f5f","gridcolor":"white","linecolor":"white","minorgridcolor":"white","startlinecolor":"#2a3f5f"},"type":"carpet"}],"table":[{"cells":{"fill":{"color":"#EBF0F8"},"line":{"color":"white"}},"header":{"fill":{"color":"#C8D4E3"},"line":{"color":"white"}},"type":"table"}],"barpolar":[{"marker":{"line":{"color":"#E5ECF6","width":0.5},"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"barpolar"}],"pie":[{"automargin":true,"type":"pie"}]},"layout":{"autotypenumbers":"strict","colorway":["#636efa","#EF553B","#00cc96","#ab63fa","#FFA15A","#19d3f3","#FF6692","#B6E880","#FF97FF","#FECB52"],"font":{"color":"#2a3f5f"},"hovermode":"closest","hoverlabel":{"align":"left"},"paper_bgcolor":"white","plot_bgcolor":"#E5ECF6","polar":{"bgcolor":"#E5ECF6","angularaxis":{"gridcolor":"white","linecolor":"white","ticks":""},"radialaxis":{"gridcolor":"white","linecolor":"white","ticks":""}},"ternary":{"bgcolor":"#E5ECF6","aaxis":{"gridcolor":"white","linecolor":"white","ticks":""},"baxis":{"gridcolor":"white","linecolor":"white","ticks":""},"caxis":{"gridcolor":"white","linecolor":"white","ticks":""}},"coloraxis":{"colorbar":{"outlinewidth":0,"ticks":""}},"colorscale":{"sequential":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"sequentialminus":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"diverging":[[0,"#8e0152"],[0.1,"#c51b7d"],[0.2,"#de77ae"],[0.3,"#f1b6da"],[0.4,"#fde0ef"],[0.5,"#f7f7f7"],[0.6,"#e6f5d0"],[0.7,"#b8e186"],[0.8,"#7fbc41"],[0.9,"#4d9221"],[1,"#276419"]]},"xaxis":{"gridcolor":"white","linecolor":"white","ticks":"","title":{"standoff":15},"zerolinecolor":"white","automargin":true,"zerolinewidth":2},"yaxis":{"gridcolor":"white","linecolor":"white","ticks":"","title":{"standoff":15},"zerolinecolor":"white","automargin":true,"zerolinewidth":2},"scene":{"xaxis":{"backgroundcolor":"#E5ECF6","gridcolor":"white","linecolor":"white","showbackground":true,"ticks":"","zerolinecolor":"white","gridwidth":2},"yaxis":{"backgroundcolor":"#E5ECF6","gridcolor":"white","linecolor":"white","showbackground":true,"ticks":"","zerolinecolor":"white","gridwidth":2},"zaxis":{"backgroundcolor":"#E5ECF6","gridcolor":"white","linecolor":"white","showbackground":true,"ticks":"","zerolinecolor":"white","gridwidth":2}},"shapedefaults":{"line":{"color":"#2a3f5f"}},"annotationdefaults":{"arrowcolor":"#2a3f5f","arrowhead":0,"arrowwidth":1},"geo":{"bgcolor":"white","landcolor":"#E5ECF6","subunitcolor":"white","showland":true,"showlakes":true,"lakecolor":"white"},"title":{"x":0.05},"mapbox":{"style":"light"}}},"xaxis":{"anchor":"y","domain":[0.0,1.0],"title":{"text":"rating"}},"yaxis":{"anchor":"x","domain":[0.0,1.0],"title":{"text":"percent"}},"legend":{"title":{"text":"variable"},"tracegroupgap":0},"margin":{"t":60},"barmode":"group"},                        {"responsive": true}                    )                };                            </script>        </div>

Overall, the two models have very similar performance. Since the linear regression model is simpler (and has *slightly* better performance), this is the preferred model.


## Deployment
The chosen model was wrapped within a `flask` webserver, which was in turn wrapped within a Docker container and deployed to AWS lambda. This allows us to make updates the model, and deploy a new model without needing to update the dashboard discussed below. 

### Interactive dashboard
In order to be able to interact the model and predict ratings for arbitrary coffees, I created a Streamlit dashboard which you can access [here](https://coffee-rating-prediction.streamlit.app/). The dashboard generates the required features from the input data, and then calls the model server. Have a play and see how your favourite coffee fares!

![Streamlit app](images/streamlit_app.png)

## Conclusions
We have shown that it is possible to predict how highly rated a coffee would be on CoffeeReview.com based purelty on information about the coffee and a linear model. We have shown that the biggest influencers on rating are:
- Price
- Fruityness
- If a coffee is from East Africa

We showed that the model could predict the rating to quite a high degree of accuracy, but struggled to predict particularly low or highly rated coffees. However, overall it produced an unbiased estimate. We can now apply use this model to predict the ratings of new coffees! :coffee: